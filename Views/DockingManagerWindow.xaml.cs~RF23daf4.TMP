using ConfigGenerator.Helper;
using ConfigGenerator.Helpers;
using ConfigGenerator.Models;
using Microsoft.Win32;
using Syncfusion.SfSkinManager;
using Syncfusion.Windows.Tools;
using Syncfusion.Windows.Tools.Controls;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text.RegularExpressions;
using System.Web.Script.Serialization;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Forms.Integration;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using Logger = ConfigGenerator.Logging;
using WinForms = System.Windows.Forms;

namespace ConfigGenerator
{
    /// <summary>
    /// Interaction logic for Docking.xaml
    /// </summary>
    public partial class DockingManagerWindow : Window
    {

        #region Class Fields

        /// <summary>
        /// Class Fields
        /// </summary>

        private string m_strStoragePath = string.Format(@"{0}\ConfigGenerator.", Environment.CurrentDirectory);
        #endregion
        #region Fields
        private static string currentVisualStyle;
        private List<string> allNodes = new List<string>();
        private Dictionary<String, List<String>> txMessage = new Dictionary<string, List<string>>();
        private Dictionary<String, List<String>> rxMessage = new Dictionary<string, List<string>>();
        private Dictionary<String, String> rxReceptionTimeout = new Dictionary<string, string>();
        private Dictionary<String, String> rxmReceptionTimeout = null;
        private Dictionary<String, List<String>> txMessageWithFrameId = new Dictionary<string, List<string>>();
        private Dictionary<String, List<String>> rxMessageWithFrameId = new Dictionary<string, List<string>>();
        private Dictionary<String, String> messagesTxFrameIds = new Dictionary<string, string>();
        
        private Dictionary<String, String> messagesTxFrameIdsCanIf = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxFrameIds = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxFrameIdsCanIf = new Dictionary<string, string>();
        private Dictionary<String, String> messagesTxDLC = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxDLC = new Dictionary<string, string>();
        private Dictionary<String, String> messagesTxMethod = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxMethod = new Dictionary<string, string>();
        private Dictionary<String, String> messagesTxCycleTime = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxCycleTime = new Dictionary<string, string>();
        private Dictionary<String, String> messagesTxCounter = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxCounter = new Dictionary<string, string>();
        private Dictionary<String, List<String>> messagesTxSignal = new Dictionary<string, List<String>>();
        private Dictionary<String, List<String>> messagesRxSignal = new Dictionary<string, List<String>>();
        private Dictionary<String, List<String>> messagesIntitials = new Dictionary<string, List<String>>();
        private Dictionary<String, String> messagesTxInitialsConfig = new Dictionary<string, string>();
        private Dictionary<String, String> messagesExtended = new Dictionary<string, string>();
        private Dictionary<String, String> messagesTxScale = new Dictionary<string, string>();
        private Dictionary<String, String> messagesTxOffset = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxRange = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxScale = new Dictionary<string, string>();
        private Dictionary<String, String> messagesRxOffset = new Dictionary<string, string>();
        private Dictionary<String, String> rxReceptionTimeoutDefault = new Dictionary<string, string>();
        private Dictionary<String, String> rxReceptionTimeoutCallBack = new Dictionary<string, string>();
        private Dictionary<String, String> rxReceptionCallBackFunction = new Dictionary<string, string>();
        private List<String> listCanIf = new List<string>();
        private List<String> lstMailConfigParentsMailBox = new List<string>();
        private Grid DynamicGridNew;
        private int staRow = 0;
        private Dictionary<String,String> mailBoxCanif=new Dictionary<string, string>();
        private Dictionary<String, String> mailBoxMessage = new Dictionary<string, String>();
        private Dictionary<String, String> mailBoxFrameId = new Dictionary<string, String>();
        private Dictionary<String, String> mailBoxDLC = new Dictionary<string, String>();
        private Dictionary<String, String> mailBoxMaskValue = new Dictionary<string, String>();
        private Dictionary<String, String> mailBoxMessageRx = new Dictionary<string, String>();
        private Dictionary<String, String> mailBoxFrameIdRx = new Dictionary<string, String>();
        private Dictionary<String, String> mailBoxDLCRx = new Dictionary<string, String>();
        private Dictionary<String, String> mailBoxMaskValueRx = new Dictionary<string, String>();

        private Dictionary<String, List<String>> mailBoxMessageMore = new Dictionary<string, List<string>>();
        private Dictionary<String, List<String>> mailBoxFrameIdMore = new Dictionary<string, List<String>>();
        private Dictionary<String, List<String>> mailBoxDLCMore = new Dictionary<string, List<String>>();
        private Dictionary<String, List<String>> mailBoxMaskValueMore = new Dictionary<string, List<String>>();
        private Button btnAddMore;




        private string selectedNode = "";
        private string selectedTxMessage = "";
        private string selectedRxMessage = "";
        private string selectedSignal = "";
        private string selectedSignalRx = "";
        private string selectedType = "";
        private string fnamec = "";
        private bool isManual = false;
        private string selectedMailBox = "";
        private string selectMailBoxMessage = "";
        private string selectMailBoxFrameId = "";
        private string selectMailBoxDLC = "";
        private string selectMailBoxMaskValue = "";
        private string selectedMailBoxRx = "";
        private string selectMailBoxMessageRx = "";
        private string selectMailBoxFrameIdRx = "";
        private string selectMailBoxDLCRx = "";
        private string selectMailBoxMaskValueRx = "";
        private string selectedMailCanIf = "";
        private bool isChanged = true;
        private string selectBackFunction = "";
        private string selectCallBack = "";
        private string selectTimeout = "";
        int buffertx=-1;

        #endregion

        #region Properties
        /// <summary>
        /// Gets or sets the current visual style.
        /// </summary>
        /// <value></value>
        /// <remarks></remarks>
        public string CurrentVisualStyle
        {
            get
            {
                return currentVisualStyle;
            }
            set
            {
                currentVisualStyle = value;
                OnVisualStyleChanged();
            }
        }
        #endregion

        #region Constructor
        /// <summary>
        /// Constructor for DockingManager.
        /// </summary>
        public DockingManagerWindow()
        {

            InitializeComponent();
            DockingManager.ActiveWindow = Can;
            InitWindowsFormsHost();
            SubscribeForEvents();
            this.Loaded += OnLoaded;
            listCanIf.Add("CANIF_RxBasicCANMailbox");
            listCanIf.Add("CANIF_RxFullCANMailbox");
            listCanIf.Add("CANIF_TxBasicCANMailbox");
            listCanIf.Add("CANIF_TxFullCANMailbox");
            listCanIf.Add("CANIF_UnusedCANMailbox");

            Logger.Log.Instance.Debug("Validating NLog");
            Logger.Log.Instance.Info("Info Validating NLog");

            try
            {

                DockingManagerModelHelper.Configuration = DockingManagerModelHelper.LoadARXML(false);
                DockingManagerModelHelper.ProjectName = DockingManagerModelHelper.Configuration.ARPACKAGES[0].ELEMENTS.ECUCMODULECONFIGURATIONVALUES.DEFINITIONREF.Value;
                DockingManagerModelHelper.ModuleName = DockingManagerModelHelper.Configuration.ARPACKAGES[0].SHORTNAME;

                PopulateWorkspaceExplorer();
                if (File.Exists(DockingManagerModelHelper.TargetInputFolderPath + "\\Updated_DB.DBC"))
                {
                    CreateDynamicWPFGridForModuleStaticCan("Updated_DB.DBC");
                    
                }
                CreateDynamicWPFGridForModule();
                DoCanIf();



            }
            catch (Exception ex)
            {
                Logger.Log.Instance.Error("Exception encountered with message: " + ex.Message);
                throw ex;
            }
        }
        #endregion

        #region "Dynamic Loading of Controls"
        private void PopulateWorkspaceExplorer()
        {
            String WorkspaceName = DockingManagerModelHelper.Configuration.ARPACKAGES[0].ELEMENTS.ECUCMODULECONFIGURATIONVALUES.DEFINITIONREF.Value.ToString().Trim('/').Split('/')[0];

            if (String.IsNullOrEmpty(WorkspaceName))
            {
                // We dont even the have the root node. Some thing wrong with the ARXML
                Logger.Log.Instance.Error("ARXML does not have even a single ARPACKAGE");
                MessageBox.Show("ARXML does not have even a single ARPACKAGE. Check the input ARXML");
                return;
            }

            // Let create the Tree which is just a holder for all the items and sub items
            TreeViewAdv wsTreeView = new TreeViewAdv();
            wsTreeView.SortingField = "Header";
            wsTreeView.Sorting = SortDirection.Ascending;
            wsTreeView.IsVirtualizing = true;
            wsTreeView.VirtualizationMode = Syncfusion.Windows.Tools.VirtualizationMode.Normal;
            wsTreeView.AnimationType = AnimationType.Fade;

            wsTreeView.SelectedItemChanged += wsTreeView_SelectedItemChanged;

            // Lets set the Workspace name
            TreeViewItemAdv tviWorkspace = new TreeViewItemAdv() { Header = WorkspaceName.ToString() };
            tviWorkspace.ExpandedImageSource = new BitmapImage(new Uri("/../Images/Folder_Expanded.png", UriKind.Relative));
            tviWorkspace.CollapsedImageSource = new BitmapImage(new Uri("/../Images/Folder_Collapsed.png", UriKind.Relative));
            tviWorkspace.IsExpanded = true;

            foreach (var ArPkg in DockingManagerModelHelper.Configuration.ARPACKAGES)
            {
                string modulename = ArPkg.SHORTNAME.ToString();
                TreeViewItemAdv tviModule = new TreeViewItemAdv() { Header = modulename };
                tviModule.Name = modulename;
                tviModule.LeftImageSource = new BitmapImage(new Uri("/../Images/" + modulename + "_MainModule_18px.png", UriKind.Relative));

                tviWorkspace.Items.Add(tviModule);
                Logger.Log.Instance.Info(String.Format("Added {0} module to the workspace view", modulename));
            }

            wsTreeView.Items.Add(tviWorkspace);

            WorkspacesExplorer.Content = wsTreeView;
        }

        private void CreateDynamicWPFGridForModule()
        {
            string modulename = DockingManagerModelHelper.ModuleName;

            var currentPackage = DockingManagerModelHelper.Configuration.ARPACKAGES.Where(x => String.Equals(x.SHORTNAME.ToString().ToLower(), modulename.ToLower())).FirstOrDefault();
            bool isParentAdded = false;

            if (modulename == DockingManagerModelHelper.ProjectName)
            {
                // User just clicked on the Project name. Ignore it
                return;
            }

            if (currentPackage == null)
            {
                MessageBox.Show(modulename + " DOES NOT exist  in the input ARXML file", "Error - Module not found");
                return;
            }

            // Clear any existing contents. This will help when we change modules
            SpForDynamicGrid.Children.Clear();

            // Create the Grid
            Grid DynamicGrid = new Grid();
            DynamicGrid.Width = 930;
            DynamicGrid.HorizontalAlignment = HorizontalAlignment.Left;
            DynamicGrid.VerticalAlignment = VerticalAlignment.Top;
            DynamicGrid.ShowGridLines = false;
            DynamicGrid.Name = modulename;

            // Create Columns
            ColumnDefinition gridCol1 = new ColumnDefinition();
            ColumnDefinition gridCol2 = new ColumnDefinition();
            ColumnDefinition gridCol3 = new ColumnDefinition();
            DynamicGrid.ColumnDefinitions.Add(gridCol1);
            DynamicGrid.ColumnDefinitions.Add(gridCol2);
            DynamicGrid.ColumnDefinitions.Add(gridCol3);

            int startrow = 0;
            int col = 0;
            List<string> lstMailConfigParents = new List<string>();


            for (int j = 0; j < currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS.Length; j++)
            {
                var currentConfigParamGrandParent = currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS[j];
                //TODO: Need to refine below code to accept only filtered object.
                for (int k = 0; k < currentConfigParamGrandParent.SUBCONTAINERS.Length; k++)
                {
                    List<string> lstSupportedValues = new List<string>();
                    string strControlType = string.Empty;
                    var currentConfigParamParent = currentConfigParamGrandParent.SUBCONTAINERS[k];

                    var areChildControlsEnabled = (currentConfigParamParent.PARAMETERVALUES == null) ? true : (currentConfigParamParent.PARAMETERVALUES.VALUE.Value.ToLower().Equals("enable") ? true : false);
                    var ChildControlsEnabledName = currentConfigParamParent.PARAMETERVALUES != null ? currentConfigParamParent.PARAMETERVALUES.DEFINITIONREF.name : "";
                    var ChildControlsEnabledText = currentConfigParamParent.PARAMETERVALUES != null ? currentConfigParamParent.PARAMETERVALUES.DEFINITIONREF.Value : "";
                    bool isEnableDisableCheckBoxAdded = false;

                    // foreach (var currentConfigParamChild in currentConfigParamParent.SUBCONTAINERS)
                    for (int i = 0; i < currentConfigParamParent.SUBCONTAINERS.Length; i++)
                    {
                        var currentConfigParamChild = currentConfigParamParent.SUBCONTAINERS[i];
                        var currentConfigParamName = currentConfigParamChild.PARAMETERVALUES.DEFINITIONREF.Value;
                        var currentConfigParamValue = currentConfigParamChild.PARAMETERVALUES.VALUE.Value;
                        var currentConfigParamID = currentConfigParamChild.PARAMETERVALUES.DEFINITIONREF.name;

                        // Everytime let's starts a new row from column index 0 
                        col = 0;

                        if (!isParentAdded && currentConfigParamGrandParent.SUBCONTAINERS.Length > 1)
                        {
                            // Populate mailbox list
                            lstMailConfigParents = currentConfigParamGrandParent.SUBCONTAINERS.Select(x => x.SHORTNAME).ToList();

                            var currSelectedMailBox = SpForDynamicGrid.Children
                                                        .OfType<ComboBox>()
                                                        .Where(cb => cb.Name == currentConfigParamGrandParent.SHORTNAME + "_Val")
                                                        .FirstOrDefault();

                            RowDefinition gridRowMailbox = new RowDefinition();
                            gridRowMailbox.Height = new GridLength(45);
                            DynamicGrid.RowDefinitions.Add(gridRowMailbox);

                            TextBlock lblMailBox = new TextBlock();
                            lblMailBox.Text = currentConfigParamGrandParent.SHORTNAME;
                            lblMailBox.Name = currentConfigParamGrandParent.SHORTNAME + "_LbL";
                            lblMailBox.FontFamily = new FontFamily("Calibri");
                            lblMailBox.FontSize = 14;
                            lblMailBox.VerticalAlignment = VerticalAlignment.Center;
                            lblMailBox.TextWrapping = TextWrapping.Wrap;
                            lblMailBox.ToolTip = currentConfigParamGrandParent.BRIEF.Trim();
                            Grid.SetRow(lblMailBox, startrow + i);
                            Grid.SetColumn(lblMailBox, col);
                            col++;
                            DynamicGrid.Children.Add(lblMailBox);

                            ComboBox drpDwnMailBox = new ComboBox();
                            drpDwnMailBox.Name = currentConfigParamGrandParent.SHORTNAME + "_Val";
                            drpDwnMailBox.FontSize = 12;
                            drpDwnMailBox.FontWeight = FontWeights.Bold;
                            drpDwnMailBox.Height = 30;
                            drpDwnMailBox.Background = Brushes.White;
                            drpDwnMailBox.IsSynchronizedWithCurrentItem = true;
                            drpDwnMailBox.SelectedIndex = currSelectedMailBox == null ? 0 : currSelectedMailBox.SelectedIndex;
                            drpDwnMailBox.SelectionChanged += drpDwnMailBox_SelectionChanged;
                            Grid.SetRow(drpDwnMailBox, startrow + i);
                            Grid.SetColumn(drpDwnMailBox, col);
                            col++;
                            drpDwnMailBox.ItemsSource = lstMailConfigParents;
                            if (lstMailConfigParents != null && lstMailConfigParents.Count > 0)
                            {
                                selectedMailBox = lstMailConfigParents[0];
                            }

                            DynamicGrid.Children.Add(drpDwnMailBox);

                            isParentAdded = true;
                        }


                        if (!isEnableDisableCheckBoxAdded)
                        {
                            RowDefinition gridRowCheckBox = new RowDefinition();
                            gridRowCheckBox.Height = new GridLength(45);
                            DynamicGrid.RowDefinitions.Add(gridRowCheckBox);
                            col = 0;
                            TextBlock lblChekBoxText = new TextBlock();
                            lblChekBoxText.Text = ChildControlsEnabledName;
                            lblChekBoxText.Name = ChildControlsEnabledName + "_Val";
                            lblChekBoxText.FontFamily = new FontFamily("Calibri");
                            lblChekBoxText.FontSize = 14;
                            lblChekBoxText.VerticalAlignment = VerticalAlignment.Center;
                            lblChekBoxText.TextWrapping = TextWrapping.Wrap;
                            lblChekBoxText.ToolTip = currentConfigParamGrandParent.BRIEF.Trim();

                            Grid.SetRow(lblChekBoxText, startrow + i + 1);
                            Grid.SetColumn(lblChekBoxText, col);
                            col++;
                            DynamicGrid.Children.Add(lblChekBoxText);

                            // Add the Checkbox to enable of disable this MailboxCtrl
                            CheckBox chkBoxEnableDisable = new CheckBox();
                            chkBoxEnableDisable.IsChecked = (currentConfigParamParent.PARAMETERVALUES == null) ? true : (currentConfigParamParent.PARAMETERVALUES.VALUE.Value.ToLower().Equals("enable") ? true : false);
                            chkBoxEnableDisable.FontSize = 12;
                            chkBoxEnableDisable.FontWeight = FontWeights.Bold;
                            chkBoxEnableDisable.Height = 15;
                            chkBoxEnableDisable.Margin = new Thickness(5, 0, 0, 0);
                            chkBoxEnableDisable.Name = currentConfigParamGrandParent.SHORTNAME + "_Val";
                            chkBoxEnableDisable.Background = Brushes.White;
                            chkBoxEnableDisable.Click += MailboxCtrl_Clicked;
                            Grid.SetRow(chkBoxEnableDisable, startrow + i + 1);
                            Grid.SetColumn(chkBoxEnableDisable, col);

                            Grid.SetColumn(chkBoxEnableDisable, col);
                            col++;

                            DynamicGrid.Children.Add(chkBoxEnableDisable);
                            isEnableDisableCheckBoxAdded = true;

                        }

                        RowDefinition gridRow = new RowDefinition();
                        gridRow.Height = new GridLength(45);
                        DynamicGrid.RowDefinitions.Add(gridRow);

                        TextBlock lbl = new TextBlock();

                        // Everytime let's starts a new row from column index 0 
                        col = 0;

                        if (currentConfigParamChild.PARAMETERVALUES.SUPPORTEDVALUES.SUPPORTEDVALUE == null || currentConfigParamChild.PARAMETERVALUES.SUPPORTEDVALUES.SUPPORTEDVALUE.Length == 1)
                        {
                            strControlType = "Textbox";
                        }
                        else if (currentConfigParamChild.PARAMETERVALUES.SUPPORTEDVALUES.SUPPORTEDVALUE.Length > 1)
                        {
                            lstSupportedValues = currentConfigParamChild.PARAMETERVALUES.SUPPORTEDVALUES.SUPPORTEDVALUE.ToList();
                            if (lstSupportedValues.Count > 0 && lstSupportedValues[0].Equals("Enable", StringComparison.OrdinalIgnoreCase))
                            {
                                strControlType = "Checkbox";
                            }
                            else
                            {
                                strControlType = "Combobox";
                            }
                        }

                        lbl.Name = currentConfigParamID;
                        lbl.Text = currentConfigParamName;
                        lbl.FontFamily = new FontFamily("Calibri");
                        lbl.FontSize = 14;
                        lbl.VerticalAlignment = VerticalAlignment.Center;
                        lbl.TextWrapping = TextWrapping.Wrap;
                        lbl.ToolTip = currentConfigParamChild.BRIEF.Trim();
                        if (isParentAdded)
                        {
                            Grid.SetRow(lbl, startrow + i + 2);
                        }
                        else
                        {
                            Grid.SetRow(lbl, startrow + i);
                        }
                        Grid.SetColumn(lbl, col);
                        col++;
                        DynamicGrid.Children.Add(lbl);

                        switch (strControlType)
                        {
                            case "Combobox":
                                ComboBox drpDwn = new ComboBox();
                                drpDwn.FontSize = 12;
                                drpDwn.FontWeight = FontWeights.Bold;
                                drpDwn.Height = 30;
                                drpDwn.Background = Brushes.White;
                                drpDwn.IsEnabled = areChildControlsEnabled;
                                drpDwn.Name = currentConfigParamID + "_Val";
                                drpDwn.IsSynchronizedWithCurrentItem = true;
                                if (isParentAdded)
                                {
                                    Grid.SetRow(drpDwn, startrow + i + 2);
                                }
                                else
                                {
                                    Grid.SetRow(drpDwn, startrow + i);
                                }
                                Grid.SetColumn(drpDwn, col);
                                col++;
                                drpDwn.ItemsSource = lstSupportedValues;
                                drpDwn.SelectedValue = currentConfigParamValue;

                                // Whenever CAN_DRIVER_MAILBOXx_INTERRUPT_CTRL(x=1…64)  checkbox is disabled,
                                // the child [INTERRUPT_PRIORITY] configurations should be greyed out so that user cannot select any values
                                if (currentConfigParamChild.PARAMETERVALUES.DEFINITIONREF.name.Contains("INTERRUPT_PRIORITY") &&
                                    currentConfigParamParent.SUBCONTAINERS[i - 1].PARAMETERVALUES.DEFINITIONREF.name.Contains("INTERRUPT_CTRL") &&
                                    currentConfigParamParent.SUBCONTAINERS[i - 1].PARAMETERVALUES.VALUE.Value.ToLower().Equals("disable"))
                                {
                                    drpDwn.IsEnabled = false;
                                }

                                DynamicGrid.Children.Add(drpDwn);
                                break;
                            case "Textbox":
                                TextBox txtBox = new TextBox();
                                txtBox.Text = currentConfigParamValue;
                                txtBox.FontSize = 12;
                                txtBox.FontWeight = FontWeights.Bold;
                                txtBox.Height = 30;
                                txtBox.Background = Brushes.White;
                                txtBox.IsEnabled = areChildControlsEnabled;
                                txtBox.Name = currentConfigParamID + "_Val";
                                txtBox.LostFocus += TxtBox_LostFocus;
                                if (isParentAdded)
                                {
                                    Grid.SetRow(txtBox, startrow + i + 2);
                                }
                                else
                                {
                                    Grid.SetRow(txtBox, startrow + i);
                                }
                                Grid.SetColumn(txtBox, col);
                                col++;
                                DynamicGrid.Children.Add(txtBox);
                                break;
                            case "Checkbox":
                                CheckBox chkBox = new CheckBox();
                                chkBox.IsChecked = currentConfigParamValue.ToString().Equals("ENABLE", StringComparison.OrdinalIgnoreCase) ? true : false;
                                chkBox.FontSize = 12;
                                chkBox.FontWeight = FontWeights.Bold;
                                chkBox.Height = 15;
                                chkBox.Background = Brushes.White;
                                chkBox.IsEnabled = areChildControlsEnabled;
                                chkBox.Name = currentConfigParamID + "_Val";
                                if (currentConfigParamID.Contains("INTERRUPT_CTRL"))
                                    chkBox.Click += ChkBox_Click;
                                if (isParentAdded)
                                {
                                    Grid.SetRow(chkBox, startrow + i + 2);
                                }
                                else
                                {
                                    Grid.SetRow(chkBox, startrow + i);
                                }

                                Grid.SetColumn(chkBox, col);
                                col++;
                                DynamicGrid.Children.Add(chkBox);
                                break;
                            default:
                                break;
                        }
                    }

                    startrow += currentConfigParamParent.SUBCONTAINERS.Length;
                    if (isParentAdded)
                        break;

                    // Add a splitter for each set of config values

                    //Separator sep = new Separator();
                    //sep.Background = Brushes.Red;
                    //sep.Height = 5;
                    //sep.Width = 150;
                    //Grid.SetRow(sep, startrow);
                    //DynamicGrid.Children.Add(sep);

                    startrow++;
                }
            }
            lstMailConfigParentsMailBox = lstMailConfigParents;
            staRow = startrow;
          //  DynamicGridNew = DynamicGrid;
           // DoCanIf();




            // Display grid into a Window
            SpForDynamicGrid.Children.Add(DynamicGrid);
        }

        private void DoCanIf()
        {
            // Clear any existing contents. This will help when we change modules
            SpForDynamicGridIf.Children.Clear();
            mailBoxCanif.Clear();
            buffertx = 0;

            mailBoxMessage.Clear();
            mailBoxFrameId.Clear();
            mailBoxDLC.Clear();
            mailBoxMaskValue.Clear();

            mailBoxMessageRx.Clear();
            mailBoxFrameIdRx.Clear();
            mailBoxDLCRx.Clear();
            mailBoxMaskValueRx.Clear();

            mailBoxMessageMore.Clear();
            mailBoxFrameIdMore.Clear();
            mailBoxDLCMore.Clear();
            mailBoxMaskValueMore.Clear();

            // Create the Grid
            Grid DynamicGrid = new Grid();
            DynamicGrid.Width = 930;
            DynamicGrid.HorizontalAlignment = HorizontalAlignment.Left;
            DynamicGrid.VerticalAlignment = VerticalAlignment.Top;
            DynamicGrid.ShowGridLines = false;
            DynamicGrid.Name = "CanIF";
            // Create Columns
            ColumnDefinition gridCol1 = new ColumnDefinition();
            ColumnDefinition gridCol2 = new ColumnDefinition();
            ColumnDefinition gridCol3 = new ColumnDefinition();


            DynamicGrid.ColumnDefinitions.Add(gridCol1);
            DynamicGrid.ColumnDefinitions.Add(gridCol2);
            DynamicGrid.ColumnDefinitions.Add(gridCol3);

            RowDefinition gridRowMailBox = new RowDefinition();
            gridRowMailBox.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowMailBox);
            TextBlock lblMailBox = new TextBlock();
            lblMailBox.Text = "Mail Box";
            lblMailBox.Name = "Mail_BOX" + "_LbL";
            lblMailBox.FontFamily = new FontFamily("Calibri");
            lblMailBox.FontSize = 14;
            lblMailBox.VerticalAlignment = VerticalAlignment.Center;
            lblMailBox.TextWrapping = TextWrapping.Wrap;
            lblMailBox.ToolTip = "Mail Box";
            Grid.SetRow(lblMailBox, 0 );
            Grid.SetColumn(lblMailBox, 0);
           
            DynamicGrid.Children.Add(lblMailBox);

            ComboBox drpDwnMailBox = new ComboBox();
            drpDwnMailBox.Name = "Mail_BOX" + "_Val";
            drpDwnMailBox.FontSize = 12;
            drpDwnMailBox.FontWeight = FontWeights.Bold;
            drpDwnMailBox.Height = 30;
            drpDwnMailBox.Background = Brushes.White;
            drpDwnMailBox.IsSynchronizedWithCurrentItem = true;
            drpDwnMailBox.SelectedIndex = 0;
            
            Grid.SetRow(drpDwnMailBox, 0 );
            Grid.SetColumn(drpDwnMailBox, 1);
           
            drpDwnMailBox.ItemsSource = lstMailConfigParentsMailBox;
           


            DynamicGrid.Children.Add(drpDwnMailBox);
            staRow++;

            RowDefinition gridRowCanIfMailbox = new RowDefinition();
            gridRowCanIfMailbox.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowCanIfMailbox);

            TextBlock lblCanIfMailBox = new TextBlock();
            lblCanIfMailBox.Text = "CAN IF Mail Box";
            lblCanIfMailBox.Name = "CAN_IF_Mail_Box" + "_LbL";
            lblCanIfMailBox.FontFamily = new FontFamily("Calibri");
            lblCanIfMailBox.FontSize = 14;
            lblCanIfMailBox.VerticalAlignment = VerticalAlignment.Center;
            lblCanIfMailBox.TextWrapping = TextWrapping.Wrap;
            lblCanIfMailBox.ToolTip = "CAN If Mail BOX";
            Grid.SetRow(lblCanIfMailBox, 1);
            Grid.SetColumn(lblCanIfMailBox, 0);

            DynamicGrid.Children.Add(lblCanIfMailBox);
            
            ComboBox drpDwnMailCanIfBox = new ComboBox();
            drpDwnMailCanIfBox.Name = "MailCanIFMail" + "_Val";
            drpDwnMailCanIfBox.FontSize = 12;
            drpDwnMailCanIfBox.FontWeight = FontWeights.Bold;
            drpDwnMailCanIfBox.Height = 30;
            drpDwnMailCanIfBox.Background = Brushes.White;
            drpDwnMailCanIfBox.IsSynchronizedWithCurrentItem = true;

            drpDwnMailCanIfBox.ItemsSource = listCanIf;
           
                drpDwnMailCanIfBox.SelectedIndex = 0;
                selectedMailCanIf = (string)drpDwnMailCanIfBox.SelectedItem;


            
            drpDwnMailCanIfBox.SelectionChanged += drpDwnMailCanIfBox_SelectionChanged;
            Grid.SetRow(drpDwnMailCanIfBox, 1);
            Grid.SetColumn(drpDwnMailCanIfBox, 1);

            DynamicGrid.Children.Add(drpDwnMailCanIfBox);
            DynamicGridNew = DynamicGrid;
            Button btnAddMoreButton = new Button();
            btnAddMoreButton.IsEnabled = false;
            btnAddMoreButton.Width = 70;
            btnAddMoreButton.Content = "Add More";
            btnAddMoreButton.Name = "btnAddMoreButton" + "_Val";
            btnAddMoreButton.FontSize = 12;
            btnAddMoreButton.FontWeight = FontWeights.Bold;
            btnAddMoreButton.Height = 30;
            btnAddMoreButton.Click += btnAddMoreButton_Clicked;
            Grid.SetRow(btnAddMoreButton, 1);
            Grid.SetColumn(btnAddMoreButton, 2);

            DynamicGrid.Children.Add(btnAddMoreButton);
            btnAddMore= btnAddMoreButton;
           
            


          

            RowDefinition gridRowMailTXFrameIdbox = new RowDefinition();
            gridRowMailTXFrameIdbox.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowMailTXFrameIdbox);

            TextBlock lblTxFrameIdBox = new TextBlock();
            lblTxFrameIdBox.Text = "TX Message FrameId";
            lblTxFrameIdBox.Name = "TX_MESSAGES" + "_LbL";
            lblTxFrameIdBox.FontFamily = new FontFamily("Calibri");
            lblTxFrameIdBox.FontSize = 14;
            lblTxFrameIdBox.VerticalAlignment = VerticalAlignment.Center;
            lblTxFrameIdBox.TextWrapping = TextWrapping.Wrap;
            lblTxFrameIdBox.ToolTip = "TX Message Frame Id";
            Grid.SetRow(lblTxFrameIdBox, 2);
            Grid.SetColumn(lblTxFrameIdBox, 0);

            DynamicGrid.Children.Add(lblTxFrameIdBox);
            if(fnamec!=null&&!fnamec.Trim().Equals(""))
            {
                ComboBox drpDwnMailTxFrameIdBox = new ComboBox();
                drpDwnMailTxFrameIdBox.Name = "MailTxSFrame" + "_Val";
                drpDwnMailTxFrameIdBox.FontSize = 12;
                drpDwnMailTxFrameIdBox.FontWeight = FontWeights.Bold;
                drpDwnMailTxFrameIdBox.Height = 30;
                drpDwnMailTxFrameIdBox.Background = Brushes.White;
                drpDwnMailTxFrameIdBox.IsSynchronizedWithCurrentItem = true;
                List<String> onlyTxFrame = new List<string>();
                foreach (KeyValuePair<string, string> kvp in messagesTxFrameIds)
                {
                    onlyTxFrame.Add(kvp.Value);
                }
                drpDwnMailTxFrameIdBox.ItemsSource = onlyTxFrame;

                drpDwnMailTxFrameIdBox.SelectedIndex = 0;
                selectMailBoxFrameId = onlyTxFrame[0];
                drpDwnMailTxFrameIdBox.SelectionChanged += drpDwnMailTxFrameIdBox_SelectionChanged;
                Grid.SetRow(drpDwnMailTxFrameIdBox, 2);
                Grid.SetColumn(drpDwnMailTxFrameIdBox, 1);


                DynamicGrid.Children.Add(drpDwnMailTxFrameIdBox);

              
            }
            else
            {
                TextBox txtBoxTXS = new TextBox();
                txtBoxTXS.Text = "";
                txtBoxTXS.FontSize = 12;
                txtBoxTXS.FontWeight = FontWeights.Bold;
                txtBoxTXS.Height = 30;
                txtBoxTXS.Background = Brushes.White;
                txtBoxTXS.TextChanged += txtBoxTXS_TextChanged;
                txtBoxTXS.Name = "MailTxS" + "_Val";
                txtBoxTXS.IsEnabled = true;
                Grid.SetRow(txtBoxTXS, 2);
                Grid.SetColumn(txtBoxTXS, 1);
                DynamicGrid.Children.Add(txtBoxTXS);
            }

            RowDefinition gridRowMailTXbox = new RowDefinition();
            gridRowMailTXbox.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowMailTXbox);
            TextBlock lblTxBox = new TextBlock();
            lblTxBox.Text = "TX Message";
            lblTxBox.Name = "TX_MESSAGES" + "_LbL";
            lblTxBox.FontFamily = new FontFamily("Calibri");
            lblTxBox.FontSize = 14;
            lblTxBox.VerticalAlignment = VerticalAlignment.Center;
            lblTxBox.TextWrapping = TextWrapping.Wrap;
            lblTxBox.ToolTip = "TX Message";
            Grid.SetRow(lblTxBox, 3);
            Grid.SetColumn(lblTxBox, 0);

            DynamicGrid.Children.Add(lblTxBox);
            List<String> onlyTx = new List<string>();
            if (fnamec != null && !fnamec.Trim().Equals(""))
            {
                ComboBox drpDwnMailTxBox = new ComboBox();
                drpDwnMailTxBox.Name = "MailTxS" + "_Val";
                drpDwnMailTxBox.FontSize = 12;
                drpDwnMailTxBox.FontWeight = FontWeights.Bold;
                drpDwnMailTxBox.Height = 30;
                drpDwnMailTxBox.Background = Brushes.White;
                drpDwnMailTxBox.IsSynchronizedWithCurrentItem = true;
               
                foreach (KeyValuePair<string, string> kvp in messagesTxFrameIds)
                {
                    onlyTx.Add(kvp.Key);
                }
                drpDwnMailTxBox.ItemsSource = onlyTx;
                drpDwnMailTxBox.SelectedIndex = 0;
                selectMailBoxMessage = onlyTx[0];
                drpDwnMailTxBox.SelectionChanged += drpDwnMailTxBox_SelectionChanged;
                Grid.SetRow(drpDwnMailTxBox, 3);
                Grid.SetColumn(drpDwnMailTxBox, 1);

                DynamicGrid.Children.Add(drpDwnMailTxBox);
            }
            else {
                TextBox txtBoxTXSM = new TextBox();
                txtBoxTXSM.Text = "";
                txtBoxTXSM.FontSize = 12;
                txtBoxTXSM.FontWeight = FontWeights.Bold;
                txtBoxTXSM.Height = 30;
                txtBoxTXSM.Background = Brushes.White;
                txtBoxTXSM.TextChanged += txtBoxTXSM_TextChanged;
                txtBoxTXSM.Name = "MailTxSM" + "_Val";
                txtBoxTXSM.IsEnabled = true;
                Grid.SetRow(txtBoxTXSM, 3);
                Grid.SetColumn(txtBoxTXSM, 1);
                DynamicGrid.Children.Add(txtBoxTXSM);
            }

           
            
            RowDefinition gridRowDLCTX = new RowDefinition();
            gridRowDLCTX.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowDLCTX);
            TextBlock lblDLCTX = new TextBlock();
            lblDLCTX.Text = "TX DLC";
            lblDLCTX.Name = "LBL_DLC_Value" + "_LbL";
            lblDLCTX.FontFamily = new FontFamily("Calibri");
            lblDLCTX.FontSize = 14;
            lblDLCTX.VerticalAlignment = VerticalAlignment.Center;
            lblDLCTX.TextWrapping = TextWrapping.Wrap;
            lblDLCTX.ToolTip = "TX DLC";
            Grid.SetRow(lblDLCTX,4);
            Grid.SetColumn(lblDLCTX, 0);

            DynamicGrid.Children.Add(lblDLCTX);



            TextBox txtBoxDLC = new TextBox();
            if(onlyTx!=null&& onlyTx.Count>0)
            {
                txtBoxDLC.Text = messagesTxDLC[onlyTx[0]];
                txtBoxDLC.IsEnabled = false;
            }
            else
            {
                txtBoxDLC.Text = "";
                txtBoxDLC.IsEnabled = true;
            }
          
            txtBoxDLC.FontSize = 12;
            txtBoxDLC.FontWeight = FontWeights.Bold;
            txtBoxDLC.Height = 30;
            txtBoxDLC.Background = Brushes.White;
            txtBoxDLC.TextChanged += txtBoxDLC_TextChanged;
            txtBoxDLC.Name = "txtMask" + "_Val";
            
            Grid.SetRow(txtBoxDLC, 4);
            Grid.SetColumn(txtBoxDLC, 1);
            DynamicGrid.Children.Add(txtBoxDLC);


            
            RowDefinition gridRowMaskValue = new RowDefinition();
            gridRowMaskValue.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowMaskValue);
            TextBlock lblMaskValueBox = new TextBlock();
            lblMaskValueBox.Text = "Mask Value";
            lblMaskValueBox.Name = "Mask_Value" + "_LbL";
            lblMaskValueBox.FontFamily = new FontFamily("Calibri");
            lblMaskValueBox.FontSize = 14;
            lblMaskValueBox.VerticalAlignment = VerticalAlignment.Center;
            lblMaskValueBox.TextWrapping = TextWrapping.Wrap;
            lblMaskValueBox.ToolTip = "Mask Value";

            Grid.SetRow(lblMaskValueBox, 5);
            Grid.SetColumn(lblMaskValueBox, 0);

            DynamicGrid.Children.Add(lblMaskValueBox);



            TextBox txtBoxMaskValue = new TextBox();
            txtBoxMaskValue.Text = "0";
            txtBoxMaskValue.FontSize = 12;
            txtBoxMaskValue.FontWeight = FontWeights.Bold;
            txtBoxMaskValue.Height = 30;
            txtBoxMaskValue.Background = Brushes.White;
            txtBoxMaskValue.TextChanged += txtBoxMaskValue_TextChanged;
            
            txtBoxMaskValue.Name = "txtMask" + "_Val";
            txtBoxMaskValue.IsEnabled = true;
            Grid.SetRow(txtBoxMaskValue, 5);
            Grid.SetColumn(txtBoxMaskValue, 1);
            DynamicGrid.Children.Add(txtBoxMaskValue);

            //rx



            RowDefinition gridRowMailRXFrameIdbox = new RowDefinition();
            gridRowMailRXFrameIdbox.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowMailRXFrameIdbox);

            TextBlock lblRxFrameIdBox = new TextBlock();
            lblRxFrameIdBox.Text = "RX Message FrameId";
            lblRxFrameIdBox.Name = "RX_MESSAGES" + "_LbL";
            lblRxFrameIdBox.FontFamily = new FontFamily("Calibri");
            lblRxFrameIdBox.FontSize = 14;
            lblRxFrameIdBox.VerticalAlignment = VerticalAlignment.Center;
            lblRxFrameIdBox.TextWrapping = TextWrapping.Wrap;
            lblRxFrameIdBox.ToolTip = "RX Message Frame Id";
            Grid.SetRow(lblRxFrameIdBox, 6);
            Grid.SetColumn(lblRxFrameIdBox, 0);

            DynamicGrid.Children.Add(lblRxFrameIdBox);
            if (fnamec != null && !fnamec.Trim().Equals(""))
            {
                ComboBox drpDwnMailRxFrameIdBox = new ComboBox();
                drpDwnMailRxFrameIdBox.Name = "MailRxSFrame" + "_Val";
                drpDwnMailRxFrameIdBox.FontSize = 12;
                drpDwnMailRxFrameIdBox.FontWeight = FontWeights.Bold;
                drpDwnMailRxFrameIdBox.Height = 30;
                drpDwnMailRxFrameIdBox.Background = Brushes.White;
                drpDwnMailRxFrameIdBox.IsSynchronizedWithCurrentItem = true;
                List<String> onlyRxFrame = new List<string>();
                foreach (KeyValuePair<string, string> kvp in messagesRxFrameIds)
                {
                    onlyRxFrame.Add(kvp.Value);
                }
                drpDwnMailRxFrameIdBox.ItemsSource = onlyRxFrame;

                drpDwnMailRxFrameIdBox.SelectedIndex = 0;
                selectMailBoxFrameIdRx = onlyRxFrame[0];
                drpDwnMailRxFrameIdBox.SelectionChanged += drpDwnMailRxFrameIdBox_SelectionChanged;
                Grid.SetRow(drpDwnMailRxFrameIdBox, 6);
                Grid.SetColumn(drpDwnMailRxFrameIdBox, 1);


                DynamicGrid.Children.Add(drpDwnMailRxFrameIdBox);


            }
            else
            {
                TextBox txtBoxRXS = new TextBox();
                txtBoxRXS.Text = "";
                txtBoxRXS.FontSize = 12;
                txtBoxRXS.FontWeight = FontWeights.Bold;
                txtBoxRXS.Height = 30;
                txtBoxRXS.Background = Brushes.White;
                txtBoxRXS.TextChanged += txtBoxRXS_TextChanged;
                txtBoxRXS.Name = "MailRxS" + "_Val";
                txtBoxRXS.IsEnabled = true;
                Grid.SetRow(txtBoxRXS, 2);
                Grid.SetColumn(txtBoxRXS, 1);
                DynamicGrid.Children.Add(txtBoxRXS);
            }

            RowDefinition gridRowMailRXbox = new RowDefinition();
            gridRowMailRXbox.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowMailRXbox);
            TextBlock lblRxBox = new TextBlock();
            lblRxBox.Text = "RX Message";
            lblRxBox.Name = "RX_MESSAGES" + "_LbL";
            lblRxBox.FontFamily = new FontFamily("Calibri");
            lblRxBox.FontSize = 14;
            lblRxBox.VerticalAlignment = VerticalAlignment.Center;
            lblRxBox.TextWrapping = TextWrapping.Wrap;
            lblRxBox.ToolTip = "RX Message";
            Grid.SetRow(lblRxBox, 7);
            Grid.SetColumn(lblRxBox, 0);

            DynamicGrid.Children.Add(lblRxBox);
            List<String> onlyRx = new List<string>();
            if (fnamec != null && !fnamec.Trim().Equals(""))
            {
                ComboBox drpDwnMailRxBox = new ComboBox();
                drpDwnMailRxBox.Name = "MailRxS" + "_Val";
                drpDwnMailRxBox.FontSize = 12;
                drpDwnMailRxBox.FontWeight = FontWeights.Bold;
                drpDwnMailRxBox.Height = 30;
                drpDwnMailRxBox.Background = Brushes.White;
                drpDwnMailRxBox.IsSynchronizedWithCurrentItem = true;

                foreach (KeyValuePair<string, string> kvp in messagesRxFrameIds)
                {
                    onlyRx.Add(kvp.Key);
                }
                drpDwnMailRxBox.ItemsSource = onlyRx;
                drpDwnMailRxBox.SelectedIndex = 0;
                selectMailBoxMessageRx = onlyRx[0];
                drpDwnMailRxBox.SelectionChanged += drpDwnMailRxBox_SelectionChanged;
                Grid.SetRow(drpDwnMailRxBox, 7);
                Grid.SetColumn(drpDwnMailRxBox, 1);

                DynamicGrid.Children.Add(drpDwnMailRxBox);
            }
            else
            {
                TextBox txtBoxRXSM = new TextBox();
                txtBoxRXSM.Text = "";
                txtBoxRXSM.FontSize = 12;
                txtBoxRXSM.FontWeight = FontWeights.Bold;
                txtBoxRXSM.Height = 30;
                txtBoxRXSM.Background = Brushes.White;
                txtBoxRXSM.TextChanged += txtBoxRXSM_TextChanged;
                txtBoxRXSM.Name = "MailTxSM" + "_Val";
                txtBoxRXSM.IsEnabled = true;
                Grid.SetRow(txtBoxRXSM, 7);
                Grid.SetColumn(txtBoxRXSM, 1);
                DynamicGrid.Children.Add(txtBoxRXSM);
            }



            RowDefinition gridRowDLCRX = new RowDefinition();
            gridRowDLCRX.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowDLCRX);
            TextBlock lblDLCRX = new TextBlock();
            lblDLCRX.Text = "RX DLC";
            lblDLCRX.Name = "LBL_DLC_Value_RX" + "_LbL";
            lblDLCRX.FontFamily = new FontFamily("Calibri");
            lblDLCRX.FontSize = 14;
            lblDLCRX.VerticalAlignment = VerticalAlignment.Center;
            lblDLCRX.TextWrapping = TextWrapping.Wrap;
            lblDLCRX.ToolTip = "RX DLC";
            Grid.SetRow(lblDLCRX, 8);
            Grid.SetColumn(lblDLCRX, 0);

            DynamicGrid.Children.Add(lblDLCRX);



            TextBox txtBoxDLCRx = new TextBox();
            if (onlyRx != null && onlyRx.Count > 0)
            {
                txtBoxDLCRx.Text = messagesRxDLC.ContainsKey(onlyRx[0])? messagesRxDLC[onlyRx[0]]:(0+"");
                txtBoxDLCRx.IsEnabled = false;
            }
            else
            {
                txtBoxDLCRx.Text = "";
                txtBoxDLCRx.IsEnabled = true;
            }

            txtBoxDLCRx.FontSize = 12;
            txtBoxDLCRx.FontWeight = FontWeights.Bold;
            txtBoxDLCRx.Height = 30;
            txtBoxDLCRx.Background = Brushes.White;
            txtBoxDLCRx.TextChanged += txtBoxDLCRx_TextChanged;
            txtBoxDLCRx.Name = "txtMask" + "_Val";

            Grid.SetRow(txtBoxDLCRx, 8);
            Grid.SetColumn(txtBoxDLCRx, 1);
            DynamicGrid.Children.Add(txtBoxDLCRx);



            RowDefinition gridRowMaskValueRx = new RowDefinition();
            gridRowMaskValueRx.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowMaskValueRx);
            TextBlock lblMaskValueBoxRx = new TextBlock();
            lblMaskValueBoxRx.Text = "RX Mask Value";
            lblMaskValueBoxRx.Name = "RX_Mask_Value" + "_LbL";
            lblMaskValueBoxRx.FontFamily = new FontFamily("Calibri");
            lblMaskValueBoxRx.FontSize = 14;
            lblMaskValueBoxRx.VerticalAlignment = VerticalAlignment.Center;
            lblMaskValueBoxRx.TextWrapping = TextWrapping.Wrap;
            lblMaskValueBoxRx.ToolTip = "RX Mask Value";
            Grid.SetRow(lblMaskValueBoxRx, 9);
            Grid.SetColumn(lblMaskValueBoxRx, 0);

            DynamicGrid.Children.Add(lblMaskValueBoxRx);



            TextBox txtBoxMaskValueRX = new TextBox();
            txtBoxMaskValueRX.Text = "0";
            txtBoxMaskValueRX.FontSize = 12;
            txtBoxMaskValueRX.FontWeight = FontWeights.Bold;
            txtBoxMaskValueRX.Height = 30;
            txtBoxMaskValueRX.Background = Brushes.White;
            txtBoxMaskValueRX.TextChanged += txtBoxMaskValueRX_TextChanged;
            txtBoxMaskValueRX.Name = "txtMask" + "_Val";
            txtBoxMaskValueRX.IsEnabled = true;
            Grid.SetRow(txtBoxMaskValueRX, 9);
            Grid.SetColumn(txtBoxMaskValueRX, 1);
            DynamicGrid.Children.Add(txtBoxMaskValueRX);


            Button btnAddSubmit = new Button();
            btnAddSubmit.IsEnabled = true;
            btnAddSubmit.Width = 70;
            btnAddSubmit.Content = "Submit";
            btnAddSubmit.Name = "btnAddSubmit" + "_Val";
            btnAddSubmit.FontSize = 12;
            btnAddSubmit.FontWeight = FontWeights.Bold;
            btnAddSubmit.Height = 30;
            btnAddSubmit.Click += btnAddSubmit_Clicked;
            Grid.SetRow(btnAddSubmit, 9);
            Grid.SetColumn(btnAddSubmit, 2);
            DynamicGrid.Children.Add(btnAddSubmit);



            RowDefinition gridRowMoreListRxFrameId = new RowDefinition();
            gridRowMoreListRxFrameId.Height = new GridLength(100);
            DynamicGrid.RowDefinitions.Add(gridRowMoreListRxFrameId);

            var panelTemplateTxFrameid = new ItemsPanelTemplate();
            var stackPanelTxFrameId = new FrameworkElementFactory(typeof(StackPanel));
            stackPanelTxFrameId.SetValue(StackPanel.OrientationProperty, Orientation.Vertical);
            panelTemplateTxFrameid.VisualTree = stackPanelTxFrameId;

            ListBox listBoxTxFrameId = new ListBox();
            listBoxTxFrameId.ItemsPanel = panelTemplateTxFrameid;

            listBoxTxFrameId.SetValue(Grid.RowProperty, 0);
            listBoxTxFrameId.SetValue(Grid.ColumnProperty, 0);
            listBoxTxFrameId.FontFamily = new FontFamily("Verdana");
            listBoxTxFrameId.FontSize = 12;
           
            listBoxTxFrameId.FontWeight = FontWeights.Bold;
            listBoxTxFrameId.Background = Brushes.White;
            Grid.SetRow(listBoxTxFrameId, 10);
            Grid.SetColumn(listBoxTxFrameId, 0);
            
            listBoxTxFrameId.SelectionChanged += listBoxTxFrameId_SelectionChanged;
            DynamicGrid.Children.Add(listBoxTxFrameId);


            var panelTemplateTxMessage = new ItemsPanelTemplate();
            var stackPanelTxMessage = new FrameworkElementFactory(typeof(StackPanel));
            stackPanelTxMessage.SetValue(StackPanel.OrientationProperty, Orientation.Vertical);
            panelTemplateTxMessage.VisualTree = stackPanelTxMessage;

            ListBox listBoxRxMessage = new ListBox();
            listBoxRxMessage.ItemsPanel = panelTemplateTxMessage;

            listBoxRxMessage.SelectionChanged += listBoxTx_SelectionChanged;
            listBoxRxMessage.SetValue(Grid.RowProperty, 0);
            listBoxRxMessage.SetValue(Grid.ColumnProperty, 0);
            Grid.SetRow(listBoxRxMessage, 10);
            Grid.SetColumn(listBoxRxMessage, 1);
            DynamicGrid.Children.Add(listBoxRxMessage);



            Button btnRemoveSubmit = new Button();
            btnRemoveSubmit.IsEnabled = true;
            btnRemoveSubmit.Width = 70;
            btnRemoveSubmit.Content = "Remove";
            btnRemoveSubmit.Name = "btnRemoveSubmit" + "_Val";
            btnRemoveSubmit.FontSize = 12;
            btnRemoveSubmit.FontWeight = FontWeights.Bold;
            btnRemoveSubmit.Height = 30;
            btnRemoveSubmit.Click += btnRemoveSubmit_Clicked;
            Grid.SetRow(btnRemoveSubmit,10);
            Grid.SetColumn(btnRemoveSubmit, 2);
            DynamicGrid.Children.Add(btnRemoveSubmit);


            SpForDynamicGridIf.Children.Add(DynamicGrid);
            drpDwnMailBox.SelectionChanged += drpDwnMailBoxs_SelectionChanged;

        }


        private void CreateDynamicWPFGridForModuleStaticCan(String fileName)
        {
            fnamec = fileName.Substring(0, fileName.LastIndexOf("."));
            ConfigGenerator.Models.DockingManagerModelHelper.GenerateCantoolsConfigurationsTxt(fileName);
            string modulename = "StaticCanGrid";


            // Clear any existing contents. This will help when we change modules
            SpForDynamicGridStaticCan.Children.Clear();

            // Create the Grid
            Grid DynamicGrid = new Grid();
            DynamicGrid.Width = 1500;
            DynamicGrid.HorizontalAlignment = HorizontalAlignment.Left;
            DynamicGrid.VerticalAlignment = VerticalAlignment.Top;
            DynamicGrid.ShowGridLines = false;
            DynamicGrid.Name = modulename;

            // Create Columns
            ColumnDefinition gridCol1 = new ColumnDefinition();
            ColumnDefinition gridCol2 = new ColumnDefinition();
            ColumnDefinition gridCol3 = new ColumnDefinition();


            DynamicGrid.ColumnDefinitions.Add(gridCol1);
            DynamicGrid.ColumnDefinitions.Add(gridCol2);
            DynamicGrid.ColumnDefinitions.Add(gridCol3);

            allNodes.Clear();
            txMessage.Clear();
            rxMessage.Clear();
            txMessageWithFrameId.Clear();
            rxMessageWithFrameId.Clear();
            messagesTxFrameIds.Clear();
            messagesTxFrameIdsCanIf.Clear();
            messagesRxFrameIds.Clear();
            messagesRxFrameIdsCanIf.Clear();
            messagesTxDLC.Clear();
            messagesTxMethod.Clear();
            messagesRxMethod.Clear();
            messagesTxCycleTime.Clear();
            messagesTxCounter.Clear();
            messagesTxInitialsConfig.Clear();
            messagesTxScale.Clear();
            messagesTxOffset.Clear();
            messagesTxSignal.Clear();
            messagesIntitials.Clear();
            rxReceptionTimeout.Clear();

            messagesRxDLC.Clear();
            messagesRxMethod.Clear();
            messagesRxMethod.Clear();
            messagesRxCycleTime.Clear();
            messagesRxCounter.Clear();
            messagesRxRange.Clear();
            messagesRxScale.Clear();
            messagesRxOffset.Clear();
            messagesRxSignal.Clear();

            messagesExtended.Clear();
            messagesIntitials.Clear();

            selectedRxMessage = "";
            selectedTxMessage = "";
            selectedNode = "";
            isManual = false;



            List<string> lstNetWorkNodes = new List<string>();
            string[] alllines = File.ReadAllLines(DockingManagerModelHelper.TargetOutputFolderPath + "\\" + fileName + ".txt");
            // string[] alllines = File.ReadAllLines(DockingManagerModelHelper.TargetOutputFolderPath + "\\" +"innn" + ".txt");

            JavaScriptSerializer json_serializer = new JavaScriptSerializer();


            Object[] objArray = (Object[])json_serializer.DeserializeObject(alllines[0]);
            foreach (object o in objArray)
            {
                allNodes.Add(o.ToString());
            }
            Dictionary<String, Object> tx = new Dictionary<string, object>();
            Object rx = new Object();
            Dictionary<String, Object> frameIdsTx = new Dictionary<string, object>();
            Dictionary<String, Object> frameIdsRx = new Dictionary<string, object>();
            Dictionary<String, Object> MethodTx = new Dictionary<string, object>();
            Dictionary<String, Object> MethodRx = new Dictionary<string, object>();
            Dictionary<String, Object> dlcTx = new Dictionary<string, object>();
            Dictionary<String, Object> dlcRx = new Dictionary<string, object>();
            Dictionary<String, Object> ctimeTx = new Dictionary<string, object>();
            Dictionary<String, Object> ctimeRx = new Dictionary<string, object>();
            Dictionary<String, Object> extend = new Dictionary<string, object>();
            Dictionary<String, Object> signalTx = new Dictionary<string, object>();
            Dictionary<String, Object> signalRx = new Dictionary<string, object>();
            Dictionary<String, Object> signalMsgInti = new Dictionary<string, object>();
            try
            {
                String ext = alllines[12].Replace(":", ":\'").Replace(",", "\',").Replace("}", "\'}");
                extend = (Dictionary<String, Object>)json_serializer.DeserializeObject(ext);

            }
            catch (Exception e)
            {

            }
            try
            {
                signalMsgInti = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[11]);

            }
            catch (Exception e)
            {
                String ini = alllines[11].Replace(", None",",0");
                signalMsgInti = (Dictionary<String, Object>)json_serializer.DeserializeObject(ini);

            }
            try
            {
                signalTx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[9]);

            }
            catch (Exception e)
            {

            }
            try
            {
                signalRx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[9]);

            }
            catch (Exception e)
            {

            }

            try
            {
                ctimeTx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[8]);

            }
            catch (Exception e)
            {

            }
            try
            {
                ctimeRx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[13]);

            }
            catch (Exception e)
            {

            }
            try
            {
                dlcTx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[4]);

            }
            catch (Exception e)
            {

            }
            try
            {
                dlcRx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[5]);

            }
            catch (Exception e)
            {

            }
            try
            {
                tx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[1]);

            }
            catch (Exception e)
            {

            }
            try
            {
                rx = (Object)json_serializer.DeserializeObject(alllines[2]);

            }
            catch (Exception e)
            {

            }
            try
            {
                frameIdsTx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[3]);

            }
            catch (Exception e)
            {

            }
            try
            {
                frameIdsRx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[10]);


            }
            catch (Exception e)
            {

            }
            try
            {
                MethodTx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[6]);

            }
            catch (Exception e)
            {

            }
            try
            {
                MethodRx = (Dictionary<String, Object>)json_serializer.DeserializeObject(alllines[7]);

            }
            catch (Exception e)
            {

            }

            foreach (KeyValuePair<String, Object> sig in signalTx)
            {

                Object[] objs = (Object[])sig.Value;
                List<String> listSignal = new List<string>();
                foreach (Object obj in objs)
                {
                    listSignal.Add(obj.ToString().Trim());
                    messagesTxInitialsConfig.Add(obj.ToString().Trim(), "0");
                    messagesTxScale.Add(obj.ToString().Trim(), "0");
                    messagesTxOffset.Add(obj.ToString().Trim(), "0");
                }
                messagesTxSignal.Add(sig.Key.Trim(), listSignal);

            }


            foreach (KeyValuePair<String, Object> sig in signalRx)
            {

                Object[] objs = (Object[])sig.Value;
                List<String> listSignal = new List<string>();
                foreach (Object obj in objs)
                {
                    listSignal.Add(obj.ToString().Trim());
                    messagesRxRange.Add(obj.ToString().Trim(), "0");
                    messagesRxScale.Add(obj.ToString().Trim(), "0");
                    messagesRxOffset.Add(obj.ToString().Trim(), "0");
                }
                messagesRxSignal.Add(sig.Key.Trim(), listSignal);

            }


            foreach (KeyValuePair<String, Object> sig in signalMsgInti)
            {

                Object[] objs = (Object[])sig.Value;
                List<String> listSignalInt = new List<string>();
                foreach (Object obj in objs)
                {
                    listSignalInt.Add(obj.ToString().Trim());
                    
                }
                messagesIntitials.Add(sig.Key.Trim(), listSignalInt);

            }



            foreach (KeyValuePair<String, Object> ctime in ctimeTx)
            {


                messagesTxCycleTime.Add(ctime.Key, ctime.Value.ToString().Trim());


            }
            foreach (KeyValuePair<String, Object> ctime in ctimeRx)
            {


                messagesRxCycleTime.Add(ctime.Key, ctime.Value.ToString().Trim());


            }

            foreach (KeyValuePair<String, Object> ext in extend)
            {


                messagesExtended.Add(ext.Key.Trim(), ext.Value.ToString().Trim());


            }

            foreach (KeyValuePair<String, Object> fid in frameIdsTx)
            {


                messagesTxFrameIds.Add(fid.Key, fid.Value.ToString().Trim());
                messagesTxFrameIdsCanIf.Add(fid.Key, fid.Value.ToString().Trim());


            }
            foreach (KeyValuePair<String, Object> fid in frameIdsRx)
            {


                messagesRxFrameIds.Add(fid.Key.Trim(), fid.Value.ToString().Trim());
                messagesRxFrameIdsCanIf.Add(fid.Key.Trim(), fid.Value.ToString().Trim());


            }
            foreach (KeyValuePair<String, Object> dlc in dlcTx)
            {


                messagesTxDLC.Add(dlc.Key, dlc.Value.ToString().Trim());


            }
            foreach (KeyValuePair<String, Object> dlc in dlcRx)
            {


                messagesRxDLC.Add(dlc.Key, dlc.Value.ToString().Trim());


            }
          
            foreach (KeyValuePair<String, Object> mthd in MethodTx)
            {
                string txm = mthd.Value.ToString().Trim();

                if (txm.Equals("Combined(Event/Periodic)"))
                {
                    txm = "Combined";

                }

                messagesTxMethod.Add(mthd.Key.Trim(), txm);


            }
            foreach (KeyValuePair<String, Object> mthd in MethodRx)
            {
                string rxm = mthd.Value.ToString().Trim();

                if (rxm.Equals("Combined(Event/Periodic)"))
                {
                    rxm = "Combined";

                }

                messagesRxMethod.Add(mthd.Key.Trim(), rxm);


            }
            foreach (KeyValuePair<String, Object> t in tx)
            {

                Object[] objs = (Object[])t.Value;
                List<string> listTxMessage = new List<string>();
                List<string> listTxMessageWithFameId = new List<string>();
                foreach (object obj in objs)
                {
                    String svalue = "";
                    messagesTxFrameIds.TryGetValue(obj.ToString(), out svalue);

                    listTxMessageWithFameId.Add(obj.ToString() + "(" + svalue + ")");
                    listTxMessage.Add(obj.ToString());
                }
                txMessageWithFrameId.Add(t.Key, listTxMessageWithFameId);
                txMessage.Add(t.Key, listTxMessage);


            }


            if (rx != null)
            {


                Object[] objs = (Object[])rx;

                if (objs != null && objs.Length > 0)
                {
                    foreach (object ob in objs)
                    {
                        Object[] obNodeValues = (Object[])ob;
                        string rxValue = obNodeValues[0].ToString();
                        Object[] nodes = (Object[])obNodeValues[1];
                        foreach (Object nodeObject in nodes)
                        {
                            String node = (String)nodeObject;
                            if (rxMessage.ContainsKey(node))
                            {
                                List<String> rxm = new List<string>();
                                List<String> rxmFrmeId = new List<string>();

                                rxMessage.TryGetValue(node, out rxm);
                                rxMessageWithFrameId.TryGetValue(node, out rxmFrmeId);


                                if (!rxm.Contains(rxValue))
                                {
                                    rxm.Add(rxValue);
                                    String frmaeid = "";
                                    messagesRxFrameIds.TryGetValue(rxValue, out frmaeid);
                                    rxmFrmeId.Add(rxValue + "(" + frmaeid + ")");

                                }
                            }
                            else
                            {
                                List<String> rxm = new List<string>();
                                List<String> rxmFrmeId = new List<string>();


                                rxm.Add(rxValue);
                                String frmaeid = "";
                                messagesRxFrameIds.TryGetValue(rxValue, out frmaeid);
                                rxmFrmeId.Add(rxValue + "(" + frmaeid + ")");
                                rxMessage.Add(node, rxm);
                                rxMessageWithFrameId.Add(node, rxmFrmeId);
                            }
                        }
                    }


                }



            }










            RowDefinition gridRowNetWork = new RowDefinition();
            gridRowNetWork.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowNetWork);

            TextBlock lblNetworkNode = new TextBlock();
            lblNetworkNode.Text = "NetWork Nodes";
            lblNetworkNode.Name = "NetWork_Nodes" + "_LbL";
            lblNetworkNode.FontFamily = new FontFamily("Calibri");
            lblNetworkNode.FontSize = 14;
            lblNetworkNode.VerticalAlignment = VerticalAlignment.Center;
            lblNetworkNode.TextWrapping = TextWrapping.Wrap;
            lblNetworkNode.ToolTip = "NetWork Nodes".Trim();
            Grid.SetRow(lblNetworkNode, 0);
            Grid.SetColumn(lblNetworkNode, 0);

            DynamicGrid.Children.Add(lblNetworkNode);


            ComboBox drpDwnNetworkBox = new ComboBox();
            drpDwnNetworkBox.Name = "ComboNetworkNode" + "_Val";
            drpDwnNetworkBox.FontSize = 12;
            drpDwnNetworkBox.FontWeight = FontWeights.Bold;
            drpDwnNetworkBox.Height = 30;
            drpDwnNetworkBox.Background = Brushes.White;
            drpDwnNetworkBox.IsSynchronizedWithCurrentItem = true;
            drpDwnNetworkBox.SelectedIndex = 0;
            drpDwnNetworkBox.ItemsSource = allNodes.ToList();
            drpDwnNetworkBox.SelectionChanged += drpDwnNetworkBox_SelectionChanged;

            Grid.SetRow(drpDwnNetworkBox, 0);
            Grid.SetColumn(drpDwnNetworkBox, 1);
            selectedNode = allNodes[0];





            DynamicGrid.Children.Add(drpDwnNetworkBox);








            RowDefinition gridRowNetWorkNode = new RowDefinition();
            gridRowNetWorkNode.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowNetWorkNode);


            TextBlock lblTxNetworkNode = new TextBlock();
            lblTxNetworkNode.Text = "Tx Messages";
            lblTxNetworkNode.Name = "Tx_Messages" + "_LbL";
            lblTxNetworkNode.FontFamily = new FontFamily("Calibri");
            lblTxNetworkNode.FontSize = 14;
            lblTxNetworkNode.VerticalAlignment = VerticalAlignment.Center;
            lblTxNetworkNode.TextWrapping = TextWrapping.Wrap;
            lblTxNetworkNode.ToolTip = "Tx Messages".Trim();
            Grid.SetRow(lblTxNetworkNode, 1);
            Grid.SetColumn(lblTxNetworkNode, 0);

            DynamicGrid.Children.Add(lblTxNetworkNode);


            ComboBox drpDwnTxNetworkBox = new ComboBox();
            drpDwnTxNetworkBox.Name = "ComboNetworkNodeTx" + "_Val";
            drpDwnTxNetworkBox.FontSize = 12;
            drpDwnTxNetworkBox.FontWeight = FontWeights.Bold;
            drpDwnTxNetworkBox.Height = 30;
            drpDwnTxNetworkBox.Background = Brushes.White;
            drpDwnTxNetworkBox.IsSynchronizedWithCurrentItem = true;
            drpDwnTxNetworkBox.SelectedIndex = 0;
            //   drpDwnTxNetworkBox.SelectionChanged += drpDwnTxNetworkBox_SelectionChanged;
            Grid.SetRow(drpDwnTxNetworkBox, 1);

            Grid.SetColumn(drpDwnTxNetworkBox, 1);



            List<String> lvaluesTx = new List<String>();
            txMessageWithFrameId.TryGetValue(allNodes[0], out lvaluesTx);
            if (lvaluesTx != null)
            {
                drpDwnTxNetworkBox.ItemsSource = lvaluesTx.ToList();
                drpDwnTxNetworkBox.SelectionChanged += drpDwnTxNetworkBox_SelectionChanged;

            }
            else
            {
                lvaluesTx = new List<String>();
                drpDwnTxNetworkBox.ItemsSource = lvaluesTx.ToList();
            }



            DynamicGrid.Children.Add(drpDwnTxNetworkBox);

           


            RowDefinition gridRowSignal = new RowDefinition();
            gridRowSignal.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowSignal);

            TextBlock lblSignal = new TextBlock();
            lblSignal.Text = "TX Signals";
            lblSignal.Name = "Signal" + "_LbL";
            lblSignal.FontFamily = new FontFamily("Calibri");
            lblSignal.FontSize = 14;
            lblSignal.VerticalAlignment = VerticalAlignment.Center;
            lblSignal.TextWrapping = TextWrapping.Wrap;
            lblSignal.ToolTip = "Signal".Trim();
            Grid.SetRow(lblSignal, 2);
            Grid.SetColumn(lblSignal, 0);

            DynamicGrid.Children.Add(lblSignal);


            ComboBox drpDwnSignal = new ComboBox();
            drpDwnSignal.Name = "ComboSignal" + "_Val";
            drpDwnSignal.FontSize = 12;
            drpDwnSignal.FontWeight = FontWeights.Bold;
            drpDwnSignal.Height = 30;
            drpDwnSignal.Background = Brushes.White;
            drpDwnSignal.IsSynchronizedWithCurrentItem = true;
            drpDwnSignal.SelectedIndex = 0;
            // drpDwnTxNetworkBox.SelectionChanged += drpDwnMailBox_SelectionChanged;
            Grid.SetRow(drpDwnSignal, 2);

            Grid.SetColumn(drpDwnSignal, 1);


            if (lvaluesTx != null && lvaluesTx.Count > 0)
            {
                List<String> lvaluesSignal = new List<String>();
                messagesTxSignal.TryGetValue(lvaluesTx[0].Substring(0, lvaluesTx[0].IndexOf("(")), out lvaluesSignal);
                if (lvaluesSignal != null && lvaluesSignal.Count > 0)
                {
                    selectedSignal = lvaluesSignal[0];
                    drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                    drpDwnSignal.SelectionChanged += drpDwnSignal_SelectionChanged;
                }
                else
                {
                    lvaluesSignal = new List<String>();
                    drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                    selectedSignal = "";
                }


            }
            else
            {
                List<String> lvaluesSignal = new List<String>();
                drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                selectedSignal = "";
            }


            DynamicGrid.Children.Add(drpDwnSignal);

           


            RowDefinition gridIntital = new RowDefinition();
            gridIntital.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridIntital);


            TextBlock lblInitial = new TextBlock();
            lblInitial.Text = "Initial Value";
            lblInitial.Name = "Range" + "_LbL";
            lblInitial.FontFamily = new FontFamily("Calibri");
            lblInitial.FontSize = 14;
            lblInitial.VerticalAlignment = VerticalAlignment.Center;
            lblInitial.TextWrapping = TextWrapping.Wrap;
            lblInitial.ToolTip = "Range".Trim();
            Grid.SetRow(lblInitial, 3);
            Grid.SetColumn(lblInitial, 0);

            DynamicGrid.Children.Add(lblInitial);


            TextBox txtBoxInitial = new TextBox();
            txtBoxInitial.Text = "0";
            txtBoxInitial.FontSize = 12;
            txtBoxInitial.FontWeight = FontWeights.Bold;
            txtBoxInitial.Height = 30;
            txtBoxInitial.Background = Brushes.White;
            txtBoxInitial.TextChanged += txtBoxInitial_TextChanged;
            txtBoxInitial.Name = "txtInitial" + "_Val";
            txtBoxInitial.IsEnabled = isManual;

                        
            Grid.SetRow(txtBoxInitial, 3);
            Grid.SetColumn(txtBoxInitial, 1);

            DynamicGrid.Children.Add(txtBoxInitial);



            RowDefinition gridRowCheckBox = new RowDefinition();
            gridRowCheckBox.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowCheckBox);

            TextBlock lblChekBoxText = new TextBlock();
            lblChekBoxText.Text = "Manual configuration";
            lblChekBoxText.Name = "Manual_configuration" + "_Val";
            lblChekBoxText.FontFamily = new FontFamily("Calibri");
            lblChekBoxText.FontSize = 14;
            lblChekBoxText.VerticalAlignment = VerticalAlignment.Center;
            lblChekBoxText.TextWrapping = TextWrapping.Wrap;
            lblChekBoxText.ToolTip = "Manual configuration";

            Grid.SetRow(lblChekBoxText, 4);
            Grid.SetColumn(lblChekBoxText, 0);

            DynamicGrid.Children.Add(lblChekBoxText);

            // Add the Checkbox to enable of disable Manual configuration
            CheckBox chkBoxEnableDisableManualConfiguration = new CheckBox();
            chkBoxEnableDisableManualConfiguration.IsChecked = false;
            chkBoxEnableDisableManualConfiguration.FontSize = 12;
            chkBoxEnableDisableManualConfiguration.FontWeight = FontWeights.Bold;
            chkBoxEnableDisableManualConfiguration.Height = 15;
            chkBoxEnableDisableManualConfiguration.Margin = new Thickness(5, 0, 0, 0);
            chkBoxEnableDisableManualConfiguration.Name = "chkBoxEnableDisableManualConfiguration" + "_Val";
            chkBoxEnableDisableManualConfiguration.Background = Brushes.White;
            chkBoxEnableDisableManualConfiguration.Click += chkBoxEnableDisableManualConfiguration_Clicked;
            Grid.SetRow(chkBoxEnableDisableManualConfiguration, 4);
            Grid.SetColumn(chkBoxEnableDisableManualConfiguration, 1);

            DynamicGrid.Children.Add(chkBoxEnableDisableManualConfiguration);


            // Display grid into a Window
            SpForDynamicGridStaticCan.Children.Add(DynamicGrid);


            RowDefinition gridRowtXNetWorkNode = new RowDefinition();
            gridRowtXNetWorkNode.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowtXNetWorkNode);

            TextBlock lblRxNetworkNode = new TextBlock();
            lblRxNetworkNode.Text = "Rx Messages";
            lblRxNetworkNode.Name = "Rx_Messages" + "_LbL";
            lblRxNetworkNode.FontFamily = new FontFamily("Calibri");
            lblRxNetworkNode.FontSize = 14;
            lblRxNetworkNode.VerticalAlignment = VerticalAlignment.Center;
            lblRxNetworkNode.TextWrapping = TextWrapping.Wrap;
            lblRxNetworkNode.ToolTip = "Rx Messages".Trim();
            Grid.SetRow(lblRxNetworkNode, 5);
            Grid.SetColumn(lblRxNetworkNode, 0);

            DynamicGrid.Children.Add(lblRxNetworkNode);


            ComboBox drpDwnRxNetworkBox = new ComboBox();
            drpDwnRxNetworkBox.Name = "ComboNetworkNodeRx" + "_Val";
            drpDwnRxNetworkBox.FontSize = 12;
            drpDwnRxNetworkBox.FontWeight = FontWeights.Bold;
            drpDwnRxNetworkBox.Height = 30;
            drpDwnRxNetworkBox.Background = Brushes.White;
            drpDwnRxNetworkBox.IsSynchronizedWithCurrentItem = true;
            drpDwnRxNetworkBox.SelectedIndex = 0;

            Grid.SetRow(drpDwnRxNetworkBox, 5);

            Grid.SetColumn(drpDwnRxNetworkBox, 1);



            List<String> lvaluesRx = new List<String>();
            rxMessageWithFrameId.TryGetValue(allNodes[0], out lvaluesRx);
            if (lvaluesRx != null)
            {
                drpDwnRxNetworkBox.ItemsSource = (lvaluesRx).ToList();
                drpDwnRxNetworkBox.SelectionChanged += drpDwnRxNetworkBox_SelectionChanged;
            }
            else
            {
                lvaluesRx = new List<String>();
                drpDwnRxNetworkBox.ItemsSource = (lvaluesRx).ToList();
            }


            DynamicGrid.Children.Add(drpDwnRxNetworkBox);


            if (lvaluesRx != null && lvaluesRx.Count > 0)
            {
                selectedRxMessage = lvaluesRx[0].Substring(0, lvaluesRx[0].IndexOf("("));
            }
            else
            {
                selectedRxMessage = "";
            }





            RowDefinition gridRowReceptionTime = new RowDefinition();
            gridRowReceptionTime.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowReceptionTime);


            TextBlock lblReceptionTime = new TextBlock();
            lblReceptionTime.Text = "Reception Time out";
            lblReceptionTime.Name = "ReceptionTime" + "_LbL";
            lblReceptionTime.FontFamily = new FontFamily("Calibri");
            lblReceptionTime.FontSize = 14;
            lblReceptionTime.VerticalAlignment = VerticalAlignment.Center;
            lblReceptionTime.TextWrapping = TextWrapping.Wrap;
            lblReceptionTime.ToolTip = "Reception Time".Trim();
            Grid.SetRow(lblReceptionTime, 6);
            Grid.SetColumn(lblReceptionTime, 0);

            DynamicGrid.Children.Add(lblReceptionTime);


            TextBox txtBoxReceptionTime = new TextBox();
            txtBoxReceptionTime.Text = "0";
            txtBoxReceptionTime.FontSize = 12;
            txtBoxReceptionTime.FontWeight = FontWeights.Bold;
            txtBoxReceptionTime.Height = 30;
            txtBoxReceptionTime.Background = Brushes.White;
            txtBoxReceptionTime.TextChanged += txtBoxReceptionTime_TextChanged;
            txtBoxReceptionTime.Name = "txtReceptionTime" + "_Val";
            txtBoxReceptionTime.IsEnabled = true;
            Grid.SetRow(txtBoxReceptionTime, 6);
            Grid.SetColumn(txtBoxReceptionTime, 1);

            DynamicGrid.Children.Add(txtBoxReceptionTime);



            RowDefinition gridRowSignalRx = new RowDefinition();
            gridRowSignalRx.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowSignalRx);

            TextBlock lblSignalRx = new TextBlock();
            lblSignalRx.Text = "RX Signals";
            lblSignalRx.Name = "Signal" + "_LbL";
            lblSignalRx.FontFamily = new FontFamily("Calibri");
            lblSignalRx.FontSize = 14;
            lblSignalRx.VerticalAlignment = VerticalAlignment.Center;
            lblSignalRx.TextWrapping = TextWrapping.Wrap;
            lblSignalRx.ToolTip = "RX Signal".Trim();
            Grid.SetRow(lblSignalRx, 7);
            Grid.SetColumn(lblSignalRx, 0);

            DynamicGrid.Children.Add(lblSignalRx);


            ComboBox drpDwnSignalRx = new ComboBox();
            drpDwnSignalRx.Name = "ComboSignalRx" + "_Val";
            drpDwnSignalRx.FontSize = 12;
            drpDwnSignalRx.FontWeight = FontWeights.Bold;
            drpDwnSignalRx.Height = 30;
            drpDwnSignalRx.Background = Brushes.White;
            drpDwnSignalRx.IsSynchronizedWithCurrentItem = true;
            drpDwnSignalRx.SelectedIndex = 0;
            // drpDwnTxNetworkBox.SelectionChanged += drpDwnMailBox_SelectionChanged;
            Grid.SetRow(drpDwnSignalRx, 7);

            Grid.SetColumn(drpDwnSignalRx, 1);


            if (lvaluesRx != null && lvaluesRx.Count > 0)
            {
                List<String> lvaluesSignalRx = new List<String>();
                messagesRxSignal.TryGetValue(lvaluesRx[0].Substring(0, lvaluesRx[0].IndexOf("(")), out lvaluesSignalRx);
                if (lvaluesSignalRx != null && lvaluesSignalRx.Count > 0)
                {
                    selectedSignalRx = lvaluesSignalRx[0];
                    drpDwnSignalRx.ItemsSource = (lvaluesSignalRx).ToList();
                    drpDwnSignalRx.SelectionChanged += drpDwnSignalRx_SelectionChanged;
                }
                else
                {
                    lvaluesSignalRx = new List<String>();
                    drpDwnSignalRx.ItemsSource = (lvaluesSignalRx).ToList();
                    selectedSignalRx = "";
                }


            }
            else
            {
                List<String> lvaluesSignalRx = new List<String>();
                drpDwnSignal.ItemsSource = (lvaluesSignalRx).ToList();
                selectedSignalRx = "";
            }


            DynamicGrid.Children.Add(drpDwnSignalRx);


            RowDefinition gridRowRxCallbackFunction = new RowDefinition();
            gridRowReceptionTime.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowRxCallbackFunction);


            TextBlock lblRxCallbackFunction = new TextBlock();
            lblRxCallbackFunction.Text = "RX Call Back Function";
            lblRxCallbackFunction.Name = "RX_Call_Back_Function" + "_LbL";
            lblRxCallbackFunction.FontFamily = new FontFamily("Calibri");
            lblRxCallbackFunction.FontSize = 14;
            lblRxCallbackFunction.VerticalAlignment = VerticalAlignment.Center;
            lblRxCallbackFunction.TextWrapping = TextWrapping.Wrap;
            lblRxCallbackFunction.ToolTip = "RX Call Back Function".Trim();
            Grid.SetRow(lblRxCallbackFunction, 8);
            Grid.SetColumn(lblRxCallbackFunction, 0);

            DynamicGrid.Children.Add(lblRxCallbackFunction);


            TextBox txtBoxRxCallbackFunction = new TextBox();
            txtBoxRxCallbackFunction.Text = "0";
            txtBoxRxCallbackFunction.FontSize = 12;
            txtBoxRxCallbackFunction.FontWeight = FontWeights.Bold;
            txtBoxRxCallbackFunction.Height = 30;
            txtBoxRxCallbackFunction.Background = Brushes.White;
            txtBoxRxCallbackFunction.TextChanged += txtBoxRxCallbackFunction_TextChanged;
            txtBoxRxCallbackFunction.Name = "txtCallBack" + "_Val";
            txtBoxRxCallbackFunction.IsEnabled = true;
            Grid.SetRow(txtBoxRxCallbackFunction, 8);
            Grid.SetColumn(txtBoxRxCallbackFunction, 1);

            DynamicGrid.Children.Add(txtBoxRxCallbackFunction);






            RowDefinition gridRowRxCallbackFunctionout = new RowDefinition();
            gridRowRxCallbackFunctionout.Height = new GridLength(45);
            DynamicGrid.RowDefinitions.Add(gridRowRxCallbackFunctionout);


            TextBlock lblRxCallbackFunctionOut = new TextBlock();
            lblRxCallbackFunctionOut.Text = "RX Call Back Function Time Out";
            lblRxCallbackFunctionOut.Name = "RX_Call_Back_Function_time_out" + "_LbL";
            lblRxCallbackFunctionOut.FontFamily = new FontFamily("Calibri");
            lblRxCallbackFunctionOut.FontSize = 14;
            lblRxCallbackFunctionOut.VerticalAlignment = VerticalAlignment.Center;
            lblRxCallbackFunctionOut.TextWrapping = TextWrapping.Wrap;
            lblRxCallbackFunctionOut.ToolTip = "RX Call Back Function Time Out".Trim();
            Grid.SetRow(lblRxCallbackFunctionOut, 9);
            Grid.SetColumn(lblRxCallbackFunctionOut, 0);

            DynamicGrid.Children.Add(lblRxCallbackFunctionOut);


            TextBox txtBoxRxCallbackFunctionOut = new TextBox();
            txtBoxRxCallbackFunctionOut.Text = "0";
            txtBoxRxCallbackFunctionOut.FontSize = 12;
            txtBoxRxCallbackFunctionOut.FontWeight = FontWeights.Bold;
            txtBoxRxCallbackFunctionOut.Height = 30;
            txtBoxRxCallbackFunctionOut.Background = Brushes.White;
            txtBoxRxCallbackFunctionOut.TextChanged += txtBoxRxCallbackFunctionOut_TextChanged;
            txtBoxRxCallbackFunctionOut.Name = "txtReceptionTimeout" + "_Val";
            txtBoxRxCallbackFunctionOut.IsEnabled = true;
            Grid.SetRow(txtBoxRxCallbackFunctionOut, 9);
            Grid.SetColumn(txtBoxRxCallbackFunctionOut, 1);

            DynamicGrid.Children.Add(txtBoxRxCallbackFunctionOut);



            try
            {
                File.Delete(DockingManagerModelHelper.TargetOutputFolderPath + "\\" + fileName + ".txt");
            }
            catch (Exception e) { }

        }

        private void ChkBox_Click(object sender, RoutedEventArgs e)
        {
            var cb = sender as CheckBox;
            var grd = SpForDynamicGrid.Children.OfType<Grid>().FirstOrDefault();

            if (grd != null)
            {
                var currSelectedMailBox = grd.Children
                                            .OfType<ComboBox>()
                                            .Where(cbx => cbx.Name == "CAN_DRIVER_MAILBOX_INTERRUPT_PRIORITY_Val")
                                            .FirstOrDefault();
                var c4 = currSelectedMailBox as System.Windows.Controls.ComboBox;
                c4.IsEnabled = (bool)cb.IsChecked;
            }

        }
        private void chkBoxEnableDisableManualConfiguration_Clicked(object sender, RoutedEventArgs e)
        {
            var cb = sender as CheckBox;
            isManual = (bool)cb.IsChecked;
            var textBoxRange = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
                    
            textBoxRange.IsEnabled = isManual;
          
        }

        private void MailboxCtrl_Clicked(object sender, RoutedEventArgs e)
        {
            var cb = sender as CheckBox;

            var grd = SpForDynamicGrid.Children.OfType<Grid>().FirstOrDefault();

            if (grd != null)
            {
                var currSelectedMailBox = grd.Children
                                            .OfType<ComboBox>()
                                            .Where(cbx => cbx.Name == cb.Name.ToString())
                                            .FirstOrDefault();
                if (currSelectedMailBox != null)
                {
                    var currSelectedMailBoxCB = grd.Children
                                                .OfType<CheckBox>()
                                                .Where(cbx => cbx.Name == currSelectedMailBox.Name.ToString())
                                                .FirstOrDefault();

                    if (currSelectedMailBoxCB != null)
                    {
                        var a1 = DockingManagerModelHelper.Configuration.ARPACKAGES.Where(a => a.SHORTNAME == DockingManagerModelHelper.ModuleName).FirstOrDefault();
                        var a2 = a1.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS.Where(b => b.SUBCONTAINERS.Length > 1).FirstOrDefault();
                        var currentConfigParamChild = a2.SUBCONTAINERS.Where(c => c.SHORTNAME.Equals(currSelectedMailBox.SelectedValue.ToString(), StringComparison.OrdinalIgnoreCase)).FirstOrDefault();

                        // Update the user input value back to the object
                        currentConfigParamChild.PARAMETERVALUES.VALUE.Value = (bool)cb.IsChecked ? "ENABLE" : "DISABLE";

                        //Below loop will is used to change enable/disable the child controls.
                        foreach (var child in grd.Children)
                        {
                            switch (child.GetType().Name.ToLower())
                            {
                                case "textbox":
                                    var c2 = child as System.Windows.Controls.TextBox;
                                    string str = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c2.Name.Substring(0, c2.Name.IndexOf("_Val")), StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.name).FirstOrDefault();
                                    if (c2.Name.Equals(str + "_Val", StringComparison.OrdinalIgnoreCase))
                                    {
                                        c2.IsEnabled = (bool)cb.IsChecked;
                                    }
                                    break;
                                case "checkbox":
                                    var c3 = child as System.Windows.Controls.CheckBox;
                                    string strCB = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c3.Name.Substring(0, c3.Name.IndexOf("_Val")), StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.name).FirstOrDefault();
                                    if (c3.Name.Equals(strCB + "_Val", StringComparison.OrdinalIgnoreCase))
                                    {
                                        c3.IsEnabled = (bool)cb.IsChecked;
                                    }
                                    break;
                                case "combobox":
                                    var c4 = child as System.Windows.Controls.ComboBox;
                                    string strCmb = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c4.Name.Substring(0, c4.Name.IndexOf("_Val")), StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.name).FirstOrDefault();
                                    if (c4.Name.Equals(strCmb + "_Val", StringComparison.OrdinalIgnoreCase))
                                    {
                                        c4.IsEnabled = (bool)cb.IsChecked;
                                    }
                                    break;
                            }
                        }
                    }
                }
            }
        }

        private void TxtBox_LostFocus(object sender, RoutedEventArgs e)
        {
            var tb = sender as TextBox;

            var tempParamName = tb.Name.Remove(tb.Name.Length - 4);

            var obj = RetrieveConfigParamObject(tempParamName);

            string MinimumValue = obj.PARAMETERVALUES.SUPPORTEDVALUES.MinValue.ToString();
            string MaximumValue = obj.PARAMETERVALUES.SUPPORTEDVALUES.MaxValue.ToString();

            uint userInput;
            bool parseSuccess = uint.TryParse(tb.Text, System.Globalization.NumberStyles.HexNumber, null, out userInput);

            uint minvalue;
            parseSuccess = uint.TryParse(obj.PARAMETERVALUES.SUPPORTEDVALUES.MinValue.ToString(), System.Globalization.NumberStyles.HexNumber, null, out minvalue);

            uint maxvalue;
            parseSuccess = uint.TryParse(obj.PARAMETERVALUES.SUPPORTEDVALUES.MaxValue.ToString(), System.Globalization.NumberStyles.HexNumber, null, out maxvalue);

            if ((userInput < minvalue) || (userInput > maxvalue))
            {
                // Validation failed, Throw erro msg and take the focus back to the textbox
                MessageBox.Show(String.Format("Entered value of {0} should be between {1} and {2}, both values included", obj.PARAMETERVALUES.DEFINITIONREF.name, MinimumValue, MaximumValue));
                tb.Text = obj.PARAMETERVALUES.VALUE.Value.ToString();
            }
        }
        
        private void listBoxTxFrameId_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var lb = (sender as ListBox);
            string selectedListBoxLxFrameId = (string)lb.SelectedItem;
            if (selectedListBoxLxFrameId != null && !selectedListBoxLxFrameId.Trim().Equals(""))
            {
                var listBoxFrame = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ListBox>().ToList()[1];
                listBoxFrame.SelectedIndex = lb.SelectedIndex;
            }
        }

        private void listBoxTx_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var lb = (sender as ListBox);
            string selectedListBoxTx = (string)lb.SelectedItem;
            if (selectedListBoxTx != null && !selectedListBoxTx.Trim().Equals(""))
            {
                var listBoxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ListBox>().ToList()[0];
                listBoxFrameId.SelectedIndex = lb.SelectedIndex;
            }
        }

        private void drpDwnMailRxBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var dd = (sender as ComboBox);
            string selectedMailRx = (string)dd.SelectedItem;
            if (selectedMailRx != null && !selectedMailRx.Trim().Equals(""))
            {
                selectMailBoxMessageRx = selectedMailRx;
                var drMailRxFrameIdBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[4];
                drMailRxFrameIdBox.SelectedIndex = dd.SelectedIndex;
                selectMailBoxFrameIdRx = (string)dd.SelectedItem;
                var txtBocxDlcRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[2];
                if (messagesRxDLC.ContainsKey(selectedMailRx))
                {
                    txtBocxDlcRx.Text = messagesTxDLC[selectedMailRx];
                }


            }



        }
        private void drpDwnMailTxBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
                var dd = (sender as ComboBox);
                string selectedMailTx = (string)dd.SelectedItem;
                if(selectedMailTx!=null&& !selectedMailTx.Trim().Equals(""))
                {
                    selectMailBoxMessage = selectedMailTx;
                    var drMailTxFrameIdBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
                    drMailTxFrameIdBox.SelectedIndex = dd.SelectedIndex;
                    selectMailBoxFrameId = (string)dd.SelectedItem;
                    var txtBocxDlc = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
                    if(messagesTxDLC.ContainsKey(selectedMailTx))
                    {
                        txtBocxDlc.Text = messagesTxDLC[selectedMailTx];
                    }

                   
                }
              
            

        }
        
            private void drpDwnMailRxFrameIdBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {

            var dd = (sender as ComboBox);
            string selectedMailrxFrameId = (string)dd.SelectedItem;
            if (selectedMailrxFrameId != null)
            {
                selectMailBoxFrameIdRx = selectedMailrxFrameId;
                var drMailRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[5];
                drMailRx.SelectedIndex = dd.SelectedIndex;
                var txtBocxDlcRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[2];
                txtBocxDlcRx.Text = messagesRxDLC.ContainsKey((string)drMailRx.SelectedItem)? messagesRxDLC[(string)drMailRx.SelectedItem]:"0";
            }



        }
        private void drpDwnMailTxFrameIdBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
           
                var dd = (sender as ComboBox);
                string selectedMailTxFrameId = (string)dd.SelectedItem;
                if(selectedMailTxFrameId!=null)
                {
                    selectMailBoxFrameId = selectedMailTxFrameId;
                    var drMailTx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[3];
                    drMailTx.SelectedIndex = dd.SelectedIndex;
                    var txtBocxDlc = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
                    txtBocxDlc.Text = messagesTxDLC[(string)drMailTx.SelectedItem];
                }
               
            

        }
        private void drpDwnMailCanIfBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var dd = (sender as ComboBox);
             selectedMailCanIf = (string)dd.SelectedItem;
            if (btnAddMore != null)
            {

                btnAddMore.IsEnabled = false;

            }



        }
        private void drpDwnTxRx_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {

            var dd = (sender as ComboBox);
            selectedType = (string)dd.SelectedItem;
        }
        private void drpDwnRxNetworkBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var textReceptionTimeout = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[1];
            var drpRxSignal = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[4];
            var textRxCallBackFunction = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[2];
            var textReceptionTimeoutCallBack = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[3];
            textReceptionTimeout.Text = "";
            var dd = (sender as ComboBox);
            string sItem = (string)dd.SelectedItem;
            if (sItem != null && !sItem.Equals(""))
            {
                selectedRxMessage = sItem.Substring(0, sItem.IndexOf("("));
                if (rxReceptionTimeout.ContainsKey(selectedRxMessage))
                {
                    textReceptionTimeout.Text = rxReceptionTimeout[selectedRxMessage];
                }

                List<String> lvaluesSignalRx = new List<String>();
                messagesRxSignal.TryGetValue(selectedRxMessage, out lvaluesSignalRx);
                if (lvaluesSignalRx != null && lvaluesSignalRx.Count > 0)
                {
                    selectedSignalRx = lvaluesSignalRx[0];
                    drpRxSignal.ItemsSource = (lvaluesSignalRx).ToList();

                    if (rxReceptionCallBackFunction.ContainsKey(selectedSignalRx))
                    {
                        textRxCallBackFunction.Text = rxReceptionCallBackFunction[selectedSignalRx];
                    }
                    else
                    {
                        textRxCallBackFunction.Text = "";
                    }

                    if (rxReceptionTimeoutCallBack.ContainsKey(selectedSignalRx))
                    {
                        textReceptionTimeoutCallBack.Text = rxReceptionTimeoutCallBack[selectedSignalRx];
                    }
                    else
                    {
                        textReceptionTimeoutCallBack.Text = "";
                    }


                }
                else
                {

                    lvaluesSignalRx = new List<String>();
                    drpRxSignal.ItemsSource = (lvaluesSignalRx).ToList();
                    selectedSignalRx = "";
                    textRxCallBackFunction.Text = "";
                    textReceptionTimeoutCallBack.Text = "";


                }
            }
                else
            {
                selectedRxMessage = "";
                selectedSignalRx = "";
               
            }
        }
        private void drpDwnTxNetworkBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var dd = (sender as ComboBox);
            string sItem = (string)dd.SelectedItem;
            if (sItem != null && !sItem.Equals(""))
            {
                selectedTxMessage = sItem.Substring(0, sItem.IndexOf("("));
            }
            else
            {
                selectedTxMessage = "";
            }
            var drpDwnSignal = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
            var textBoxInitialValue = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
           

            if (selectedTxMessage != null && !selectedTxMessage.Equals(""))
            {
                List<String> lvaluesSignal = new List<String>();
                messagesTxSignal.TryGetValue(selectedTxMessage, out lvaluesSignal);
                if (lvaluesSignal != null && lvaluesSignal.Count > 0)
                {
                    selectedSignal = lvaluesSignal[0];
                    drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                 
                    try
                    {
                        textBoxInitialValue.Text = messagesTxInitialsConfig.ContainsKey(selectedSignal) ? messagesTxInitialsConfig[selectedSignal] : (messagesIntitials.ContainsKey(selectedSignal) ? messagesIntitials[selectedTxMessage][messagesIntitials[selectedTxMessage].IndexOf(selectedSignal) + 1] : "0");
                    }
                    catch (Exception ee)
                    {
                        textBoxInitialValue.Text = "";

                    }


                }
                else
                {
                    selectedTxMessage = "";
                    lvaluesSignal = new List<String>();
                    drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                    selectedSignal = "";
                    textBoxInitialValue.Text = "";
                  
                }

            }
            else
            {
                selectedTxMessage = "";
                List<String> lvaluesSignal = new List<String>();
                drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                selectedSignal = "";
                textBoxInitialValue.Text = "";
              
            }

        }
        
              private void txtBoxRXS_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;

            if (txValue != null && !txValue.Trim().Equals(""))
            {
                selectMailBoxMessageRx = txValue;

            }
        }
        private void txtBoxTXS_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;

            if (txValue != null && !txValue.Trim().Equals(""))
            {
                selectMailBoxMessage = txValue;
                
            }
        }
        
            private void txtBoxRXSM_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;

            if (txValue != null && !txValue.Trim().Equals(""))
            {
                selectMailBoxFrameIdRx = txValue;

            }
        }

        private void txtBoxTXSM_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;

            if (txValue != null && !txValue.Trim().Equals(""))
            {
                selectMailBoxFrameId = txValue;
               
            }
        }
        

             private void txtBoxDLCRx_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;

            if (txValue != null && !txValue.Trim().Equals(""))
            {
                selectMailBoxDLCRx = txValue;

            }
        }
        private void txtBoxDLC_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;

            if (txValue != null && !txValue.Trim().Equals(""))
            {
                selectMailBoxDLC = txValue;
                
            }
        }
        
             private void txtBoxMaskValueRX_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;

            if (txValue != null && !txValue.Trim().Equals(""))
            {
              
                
                    selectMailBoxMaskValueRx = txValue;
               
               

            }
        }

        private void txtBoxMaskValue_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;
           
            if (txValue!=null&&!txValue.Trim().Equals(""))
            {
                selectMailBoxMaskValue = txValue;
                   
            }
        }
        private void txtBoxInitial_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;
            if (selectedSignal != null && !selectedSignal.Equals("") && txValue != null && !txValue.Trim().Equals(""))
            {
                messagesTxInitialsConfig[selectedSignal] = txValue;
            }



        }
        private void txtBoxScale_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;
            if (selectedSignal != null && !selectedSignal.Equals("") && txValue != null && !txValue.Trim().Equals(""))
            {
                messagesTxScale[selectedSignal] = txValue;
            }



        }
        
              private void txtBoxRxCallbackFunctionOut_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;
            var drpRxSignal = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[4];
            selectedSignalRx = (string)drpRxSignal.SelectedItem;
            if (selectedSignalRx != null)
            {
                rxReceptionTimeoutCallBack[selectedSignalRx] = txValue;
            }
        }
        private void txtBoxRxCallbackFunction_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;
            if(txValue!=null &&!txValue.Trim().Equals(""))
            {
                var drpRxSignal = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[4];
                selectedSignalRx = (string)drpRxSignal.SelectedItem;
                if(selectedSignalRx!=null)
                {
                    rxReceptionCallBackFunction[selectedSignalRx] = txValue;
                }

               
            }
        }

            private void txtBoxReceptionTime_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;
            if (selectedRxMessage != null && !selectedRxMessage.Equals("") && txValue != null && !txValue.Trim().Equals(""))
            {
                if (rxReceptionTimeout.ContainsKey(selectedRxMessage))
                {
                    rxReceptionTimeout[selectedRxMessage] = txValue;
                }
                else
                {
                    rxReceptionTimeout.Add(selectedRxMessage, txValue);
                }
            }

        }

        private void txtBoxOffset_TextChanged(object sender, EventArgs e)
        {
            var tx = (sender as TextBox);
            string txValue = tx.Text;
            if (selectedSignal != null && !selectedSignal.Equals("") && txValue != null && !txValue.Trim().Equals(""))
            {
                messagesTxOffset[selectedSignal] = txValue;
            }



        }
        


        private void drpDwnSignalRx_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var dd = (sender as ComboBox);
            string sItem = (string)dd.SelectedItem;
            selectedSignal = sItem;
            var textBoxCallBackFunction = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[2];
            var textBoxCallBackTimeout= SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[3];
            if (selectedSignal != null && !selectedSignal.Trim().Equals(""))
            {
               
                textBoxCallBackFunction.Text = rxReceptionCallBackFunction.ContainsKey(selectedSignal)? rxReceptionCallBackFunction[selectedSignal] : "";
                textBoxCallBackTimeout.Text = rxReceptionTimeoutCallBack.ContainsKey(selectedSignal) ? rxReceptionTimeoutCallBack[selectedSignal] : "";

            }
            else
            {
                textBoxCallBackFunction.Text = "";
                textBoxCallBackTimeout.Text = "";
            }

        }


        private void drpDwnSignal_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var dd = (sender as ComboBox);
            string sItem = (string)dd.SelectedItem;
            selectedSignal = sItem;
            if (selectedSignal != null && !selectedSignal.Trim().Equals(""))
            {
                var textBoxInitialValue = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
                try
                {
                    textBoxInitialValue.Text = messagesTxInitialsConfig.ContainsKey(selectedSignal) ? messagesTxInitialsConfig[selectedSignal] : (messagesIntitials.ContainsKey(selectedSignal) ? messagesIntitials[selectedTxMessage][messagesIntitials[selectedTxMessage].IndexOf(selectedSignal) + 1] : "0");
                }
                catch (Exception ee)
                {
                    textBoxInitialValue.Text = "";

                }

            }

        }


        private void drpDwnNetworkBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            var dd = (sender as ComboBox);
            string sItem = (string)dd.SelectedItem;
            if (sItem != null && !sItem.Trim().Equals(""))
            {
                var grd = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[1];
                var grdR = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[3];
                var drpDwnSignal = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
                var drpDwnSignalRx = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[4];
                var textBoxInitialValue = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
               
                var textBoxReceptionTime = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[1];
                var textBoxCallBackFunction = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[2];
                var textBoxReceptionTimeCallBack = SpForDynamicGridStaticCan.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[3];
                List<String> lvaluesTx = new List<String>();
                List<String> lvaluesRx = new List<String>();





                selectedNode = sItem;
                txMessageWithFrameId.TryGetValue(sItem, out lvaluesTx);
                if (lvaluesTx != null && lvaluesTx.Count > 0)
                {
                    grd.ItemsSource = (lvaluesTx).ToList();
                    List<String> lvaluesSignal = new List<String>();
                    messagesTxSignal.TryGetValue(lvaluesTx[0].Substring(0, lvaluesTx[0].IndexOf("(")), out lvaluesSignal);
                    if (lvaluesSignal != null && lvaluesSignal.Count > 0)
                    {
                        selectedSignal = lvaluesSignal[0];
                        selectedTxMessage = lvaluesTx[0].Substring(0, lvaluesTx[0].IndexOf("("));
                        drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                       try
                        {
                            textBoxInitialValue.Text = messagesTxInitialsConfig.ContainsKey(selectedSignal) ? messagesTxInitialsConfig[selectedSignal] : (messagesIntitials.ContainsKey(selectedSignal) ? messagesIntitials[selectedTxMessage][ messagesIntitials[selectedTxMessage].IndexOf(selectedSignal) + 1] : "0");
                        }
                        catch(Exception ee)
                        {
                            textBoxInitialValue.Text = "";

                        }
                      
                    }
                    else
                    {
                        selectedTxMessage = "";
                        lvaluesSignal = new List<String>();
                        drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                        selectedSignal = "";
                        textBoxInitialValue.Text = "0";
                       
                    }
                }
                else
                {
                    lvaluesTx = new List<String>();
                    grd.ItemsSource = (lvaluesTx).ToList();
                    List<String> lvaluesSignal = new List<String>();
                    drpDwnSignal.ItemsSource = (lvaluesSignal).ToList();
                    selectedSignal = "";
                    textBoxInitialValue.Text = "";
                   
                }




                textBoxReceptionTime.Text = "";
                rxMessageWithFrameId.TryGetValue(sItem, out lvaluesRx);
                if (lvaluesRx != null && lvaluesRx.Count > 0)
                {
                    grdR.ItemsSource = (lvaluesRx).ToList();
                    selectedRxMessage = lvaluesRx[0].Substring(0, lvaluesRx[0].IndexOf("("));
                    if (rxReceptionTimeout.ContainsKey(selectedRxMessage))
                    {
                        textBoxReceptionTime.Text = rxReceptionTimeout[selectedRxMessage];
                    }

                }
                else
                {
                    lvaluesRx = new List<String>();
                    grdR.ItemsSource = (lvaluesRx).ToList();

                }
            }



        }
        private void drpDwnMailBoxs_SelectionChanged(object sender, SelectionChangedEventArgs e)
        {
            try
            {
                var dd = (sender as ComboBox);
                var sItem = dd.SelectedItem;
                selectedMailBox = (string)sItem;
                if (fnamec != null && !fnamec.Trim().Equals(""))
                {
                    var drMailCanIf = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[1];
                    drMailCanIf.SelectedIndex = 0;
                    var drMailTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
                    var drMailTx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[3];
                    var drMailRxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[4];
                    var drMailRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[5];

                    List<String> onlyTx = new List<string>();
                    List<String> onlyTxAlloted = new List<string>();
                    List<String> onlyTxFame = new List<string>();
                    List<String> onlyTxFameAlloted = new List<string>();
                    List<String> onlyRx = new List<string>();
                    List<String> onlyRxAlloted = new List<string>();
                    List<String> onlyRxFame = new List<string>();
                    List<String> onlyRxFameAlloted = new List<string>();
                    foreach (KeyValuePair<string, string> kvp in mailBoxMessage)
                    {
                        onlyTxAlloted.Add(kvp.Value);

                    }
                    foreach (KeyValuePair<string, string> kvp in mailBoxMessageRx)
                    {
                        onlyRxAlloted.Add(kvp.Value);

                    }
                    foreach (KeyValuePair<string, List<String>> kvp in mailBoxMessageMore)
                    {
                        List<String> ls = kvp.Value;
                        if (ls != null)
                        {
                            foreach (String s in ls)
                            {
                                onlyTxAlloted.Add(s);
                            }
                        }

                    }
                   foreach(String mes in onlyTxAlloted)
                    {
                        messagesTxFrameIdsCanIf.Remove(mes);
                    }
                    foreach (String mes in onlyRxAlloted)
                    {
                        messagesRxFrameIdsCanIf.Remove(mes);
                    }
                    foreach (KeyValuePair<string, string> kvp in messagesTxFrameIdsCanIf)
                    {
                            onlyTx.Add(kvp.Key);
                                              
                            onlyTxFame.Add(kvp.Value);
                        

                    }
                    foreach (KeyValuePair<string, string> kvp in messagesRxFrameIdsCanIf)
                    {
                        onlyRx.Add(kvp.Key);

                        onlyRxFame.Add(kvp.Value);


                    }
                    drMailTxFrameId.ItemsSource = onlyTxFame;
                    drMailTx.ItemsSource = onlyTx;
                    if (onlyTx.Count > 0)
                    {
                        drMailTxFrameId.SelectedIndex = 0;
                        selectMailBoxFrameId = onlyTxFame[0];
                        drMailTx.SelectedIndex = 0;
                        selectMailBoxMessage= onlyTx[0];
                    }

                    drMailRxFrameId.ItemsSource = onlyRxFame;
                    drMailRx.ItemsSource = onlyRx;
                    if (onlyRx.Count > 0)
                    {
                        drMailRxFrameId.SelectedIndex = 0;
                        selectMailBoxFrameIdRx = onlyRxFame[0];
                        drMailRx.SelectedIndex = 0;
                        selectMailBoxMessageRx = onlyRx[0];
                    }



                }





            }
            catch (Exception ex)
            {
                
            }
           


        }

            private void drpDwnMailBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
            {
            var dd = (sender as ComboBox);
            var sItem = dd.SelectedItem;
            selectedMailBox =(string) sItem;
            var grd = SpForDynamicGrid.Children.OfType<Grid>().FirstOrDefault();

            if (grd != null)
            {
                GetUpdatedValuesForConfigGeneration();
                var currSelectedMailBox = grd.Children
                                            .OfType<ComboBox>()
                                            .Where(cb => cb.Name == dd.Name.ToString())
                                            .FirstOrDefault();

                var a1 = DockingManagerModelHelper.Configuration.ARPACKAGES.Where(a => a.SHORTNAME == DockingManagerModelHelper.ModuleName).FirstOrDefault();
                var a2 = a1.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS.Where(b => b.SUBCONTAINERS.Length > 1).FirstOrDefault();
                var currentConfigParamChild = a2.SUBCONTAINERS.Where(c => c.SHORTNAME.Equals(currSelectedMailBox.SelectedValue.ToString(), StringComparison.OrdinalIgnoreCase)).FirstOrDefault();

                string strEnableControls = a2.SUBCONTAINERS.Where(c => c.SHORTNAME.Equals(currSelectedMailBox.SelectedValue.ToString(), StringComparison.OrdinalIgnoreCase)).Select(c => c.PARAMETERVALUES.VALUE.Value).FirstOrDefault();

                // Enable/Disable the checkbox for the parent MailBox
                var tlist = grd.Children.OfType<CheckBox>().ToList();
                var currSelectedMailBoxCB = grd.Children
                                            .OfType<CheckBox>()
                                            .Where(cb => cb.Name == currSelectedMailBox.Name.ToString())
                                            .FirstOrDefault();
                if (currSelectedMailBoxCB != null)
                {
                    if (strEnableControls.Equals("ENABLE", StringComparison.OrdinalIgnoreCase))
                        currSelectedMailBoxCB.IsChecked = true;
                    else
                        currSelectedMailBoxCB.IsChecked = false;
                }

                for (int i = 0; i < currentConfigParamChild.SUBCONTAINERS.Length; i++)
                {
                    var currentConfigParamName = currentConfigParamChild.SUBCONTAINERS[i].PARAMETERVALUES.DEFINITIONREF.Value;
                    var currentConfigParamValue = currentConfigParamChild.SUBCONTAINERS[i].PARAMETERVALUES.VALUE.Value;
                }

                if (currSelectedMailBox == null)
                {
                    // This config property was not rendered before. Choose the 1st item as default
                }
                else
                {
                    //Below loop will is used to change the values of the controls based on the dropdown selection.
                    foreach (var child in grd.Children)
                    {
                        switch (child.GetType().Name.ToLower())
                        {
                            case "textblock":
                                var c1 = child as System.Windows.Controls.TextBlock;
                                if (c1.Name.Equals(currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c1.Name, StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.name).FirstOrDefault(), StringComparison.OrdinalIgnoreCase))
                                    c1.Text = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c1.Name, StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.Value).FirstOrDefault();
                                break;
                            case "textbox":
                                var c2 = child as System.Windows.Controls.TextBox;
                                string str = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c2.Name.Substring(0, c2.Name.IndexOf("_Val")), StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.name).FirstOrDefault();
                                if (c2.Name.Equals(str + "_Val", StringComparison.OrdinalIgnoreCase))
                                {
                                    c2.Text = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(str, StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.VALUE.Value).FirstOrDefault();
                                    if (strEnableControls.Equals("ENABLE", StringComparison.OrdinalIgnoreCase))
                                        c2.IsEnabled = true;
                                    else
                                        c2.IsEnabled = false;
                                }

                                break;
                            case "checkbox":
                                var c3 = child as System.Windows.Controls.CheckBox;
                                string strCB = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c3.Name.Substring(0, c3.Name.IndexOf("_Val")), StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.name).FirstOrDefault();
                                if (c3.Name.Equals(strCB + "_Val", StringComparison.OrdinalIgnoreCase))
                                {
                                    c3.IsChecked = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(strCB, StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.VALUE.Value).FirstOrDefault().ToString().Equals("ENABLE") ? true : false;
                                    if (strEnableControls.Equals("ENABLE", StringComparison.OrdinalIgnoreCase))
                                        c3.IsEnabled = true;
                                    else
                                        c3.IsEnabled = false;
                                }
                                break;
                            case "combobox":
                                var c4 = child as System.Windows.Controls.ComboBox;
                                string strCmb = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(c4.Name.Substring(0, c4.Name.IndexOf("_Val")), StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.DEFINITIONREF.name).FirstOrDefault();
                                if (c4.Name.Equals(strCmb + "_Val", StringComparison.OrdinalIgnoreCase))
                                {
                                    c4.SelectedValue = currentConfigParamChild.SUBCONTAINERS.Where(a => a.PARAMETERVALUES.DEFINITIONREF.name.Equals(strCmb, StringComparison.OrdinalIgnoreCase)).Select(a => a.PARAMETERVALUES.VALUE.Value).FirstOrDefault();
                                    if (strEnableControls.Equals("ENABLE", StringComparison.OrdinalIgnoreCase))
                                        c4.IsEnabled = true;
                                    else
                                        c4.IsEnabled = false;
                                }
                                break;
                        }
                    }
                }
               // DoCanIf();
            }
            DockingManagerModelHelper.SelectedMailBox = sItem.ToString();

        }

        /// <summary>
        /// To get the full path of the TreeViewItemAdv
        /// </summary>
        public string GetFullPath(TreeViewItemAdv node)
        {
            if (node == null)
                throw new ArgumentNullException();

            var result = Convert.ToString(node.Header);

            for (var i = GetParentItem(node); i != null; i = GetParentItem(i))
                result = i.Header + "\\" + result;

            return result;
        }

        /// <summary>
        /// To get the parent of the item
        /// </summary>
        static TreeViewItemAdv GetParentItem(TreeViewItemAdv item)
        {
            for (var i = VisualTreeHelper.GetParent(item); i != null; i = VisualTreeHelper.GetParent(i))
                if (i is TreeViewItemAdv)
                    return (TreeViewItemAdv)i;

            return null;
        }

        #endregion

        #region Implementation
        /// <summary>
        /// Called when [loaded].
        /// </summary>
        /// <param name="sender">The sender.</param>
        /// <param name="e">The <see cref="RoutedEventArgs"/> instance containing the event data.</param>
        private void OnLoaded(object sender, RoutedEventArgs e)
        {
            CurrentVisualStyle = "Metro";
        }

        /// <summary>
        /// On Visual Style Changed.
        /// </summary>
        /// <remarks></remarks>
        private void OnVisualStyleChanged()
        {
            VisualStyles visualStyle = VisualStyles.Default;
            Enum.TryParse(CurrentVisualStyle, out visualStyle);
            if (visualStyle != VisualStyles.Default)
            {
                SfSkinManager.ApplyStylesOnApplication = true;
                SfSkinManager.SetVisualStyle(this, visualStyle);
                SfSkinManager.ApplyStylesOnApplication = false;
            }
        }

        /// <summary>
        /// Menu item click 
        /// </summary>
        /// <param name="item"></param>
        private void OnMenuItemClick(MenuItem item)
        {
            MenuItem parent = item.Parent as MenuItem;
            foreach (MenuItem menuItem in parent.Items)
            {
                menuItem.IsChecked = false;
            }
            item.IsChecked = true;
        }

        /// <summary>
        /// Set the active window
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
		private void OnActivateWindow(object sender, RoutedEventArgs e)
        {
            string name = (sender as MenuItem).Tag as string;
            DockingManager.ActivateWindow(name);
        }

        /// <summary>
        /// Initialize the windows forms host
        /// </summary>
        private void InitWindowsFormsHost()
        {
            if (DockingManager.UseInteropCompatibilityMode)
            {
                WindowsFormsHost host = new WindowsFormsHost();
                WinForms.Button btn = new WinForms.Button();
                btn.Text = "Winows Forms Button";
                host.Child = btn;
                // FindResults.Content = host;
                WindowsFormsHost.EnableWindowsFormsInterop();
            }
        }

        /// <summary>
        /// Ckear the events
        /// </summary>
        private void OnClear(object sender, EventArgs args)
        {
            Log.Text = "";
        }

        /// <summary>
        /// Events
        /// </summary>
        private void SubscribeForEvents()
        {
            //Subscribe the AutoHideAnimationStart property changed event
            DockingManager.AutoHideAnimationStart += new RoutedEventHandler(OnEventRaising);

            //Subscribe the AutoHideAnimationStop property changed event
            DockingManager.AutoHideAnimationStop += new RoutedEventHandler(OnEventRaising);

            //Subscribe the WindowActivated property changed event
            DockingManager.WindowActivated += new RoutedEventHandler(OnEventRaising);

            //Subscribe the WindowDeactivated property changed event
            DockingManager.WindowDeactivated += new RoutedEventHandler(OnEventRaising);

            //Subscribe the WindowDragStart property changed event
            DockingManager.WindowDragStart += new RoutedEventHandler(OnEventRaising);

            //Subscribe the WindowDragEnd property changed event
            DockingManager.WindowDragEnd += new RoutedEventHandler(OnEventRaising);

            //Subscribe the ActiveWindow property changed event
            DockingManager.ActiveWindowChanged += new PropertyChangedCallback(OnPropertyChanged);
        }

        #endregion

        #region Events
        /// <summary>
        /// Routed event raising
        /// </summary>
        private void OnEventRaising(object sender, RoutedEventArgs e)
        {
            FrameworkElement element = e.OriginalSource as FrameworkElement;
            string name = element != null ? element.Name : string.Empty;
            Log.TextWrapping = TextWrapping.Wrap;
            Log.Text = Log.Text + e.RoutedEvent.Name + " : " + name + "\n";
            Scroll.ScrollToBottom();

        }

        /// <summary>
        /// Property changed event raising
        /// </summary>
		private void OnPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            string name = e.NewValue != null ? (e.NewValue as FrameworkElement).Name : string.Empty;
            Log.TextWrapping = TextWrapping.Wrap;
            Log.Text = Log.Text + e.Property.Name + " : " + name + "\n";
            Scroll.ScrollToBottom();
        }

        #endregion

        bool m_layoutflag = true;
        private void DockingManager_LayoutUpdated(object sender, EventArgs e)
        {
            if (m_layoutflag)
            {
                // SfSkinManager.SetVisualStyle(this, VisualStyles.Metro);
                m_layoutflag = false;
            }
        }

        /// <summary>
        /// Handles the CloseAllTabs event of the DockingManager control.
        /// </summary>
        /// <param name="sender">The source of the event.</param>
        /// <param name="e">The <see cref="Syncfusion.Windows.Tools.Controls.CloseTabEventArgs"/> instance containing the event data.</param>
        private void DockingManager_CloseAllTabs(object sender, CloseTabEventArgs e)
        {
            string closingtabs = "";
            MessageBoxResult result = MessageBox.Show("Do you want to close the tabs? ", "Closing Tabs", MessageBoxButton.YesNo);
            if (result == MessageBoxResult.Yes)
            {
                for (int i = 0; i < e.ClosingTabItems.Count; i++)
                {
                    TabItemExt tabitem = e.ClosingTabItems[i] as TabItemExt;
                    if (tabitem.Content != null && (tabitem.Content as ContentPresenter) != null)
                    {
                        ContentPresenter presenter = tabitem.Content as ContentPresenter;
                        if (presenter != null && presenter.Content != null)
                        {
                            closingtabs = closingtabs + "\n\t" + DockingManager.GetHeader(presenter.Content as DependencyObject);
                        }
                    }
                }
                Log.TextWrapping = TextWrapping.Wrap;
                Log.Text = Log.Text + "Closed Tabs" + " : " + closingtabs + "\n";
                Scroll.ScrollToBottom();
            }
            else if (result == MessageBoxResult.No)
            {
                e.Cancel = true;
            }
        }

        /// <summary>
        /// Handles the CloseOtherTabs event of the DockingManager control.
        /// </summary>
        /// <param name="sender">The source of the event.</param>
        /// <param name="e">The <see cref="Syncfusion.Windows.Tools.Controls.CloseTabEventArgs"/> instance containing the event data.</param>
        private void DockingManager_CloseOtherTabs(object sender, CloseTabEventArgs e)
        {
            string closingtabs = "";
            MessageBoxResult result = MessageBox.Show("Do you want to close the tabs? ", "Closing Tabs", MessageBoxButton.YesNo);
            if (result == MessageBoxResult.Yes)
            {
                for (int i = 0; i < e.ClosingTabItems.Count; i++)
                {
                    TabItemExt tabitem = e.ClosingTabItems[i] as TabItemExt;
                    if (tabitem.Content != null && (tabitem.Content as ContentPresenter) != null)
                    {
                        ContentPresenter presenter = tabitem.Content as ContentPresenter;
                        if (presenter != null && presenter.Content != null)
                        {
                            closingtabs = closingtabs + "\n\t" + DockingManager.GetHeader(presenter.Content as DependencyObject);
                        }
                    }
                }
                Log.TextWrapping = TextWrapping.Wrap;
                Log.Text = Log.Text + "Closed Tabs" + " : " + closingtabs + "\n";
                Scroll.ScrollToBottom();
            }
            else if (result == MessageBoxResult.No)
            {
                e.Cancel = true;
            }
        }

        private void DockingManager_IsSelectedDocument(FrameworkElement sender, IsSelectedChangedEventArgs e)
        {
            if (DockingManager.DocContainer != null && SfSkinManager.GetVisualStyle(this) != SfSkinManager.GetVisualStyle(DockingManager.DocContainer as DependencyObject))
            {
                SfSkinManager.SetVisualStyle(DockingManager.DocContainer as DependencyObject, SfSkinManager.GetVisualStyle(this));
            }
        }

        
         private void btnRemoveSubmit_Clicked(object sender, RoutedEventArgs e)
        {
            if (fnamec != null && !fnamec.Equals(""))
            {

                var drTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
                var drTxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[3];
                var listBoxTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ListBox>().ToList()[0];
                var listBoxTxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ListBox>().ToList()[1];
                string revomeTxFrameid = (string)listBoxTxFrameId.SelectedItem;
                string revomeTx = (string)listBoxTxMessage.SelectedItem;
                if(revomeTx!=null&&!revomeTx.Trim().Equals("")&&revomeTxFrameid!=null&&!revomeTxFrameid.Trim().Equals(""))
                {
                    List<string> listItemsTxFrameId =( List<string>) drTxFrameId.ItemsSource;
                    List<string> listItemsTx = (List<string>)drTxMessage.ItemsSource;
                    listItemsTxFrameId.Add(revomeTxFrameid);
                    listItemsTx.Add(revomeTx);
                    drTxFrameId.ItemsSource = listItemsTxFrameId;
                    drTxMessage.ItemsSource= listItemsTx;
                    listBoxTxFrameId.Items.Remove(revomeTxFrameid);
                    listBoxTxMessage.Items.Remove(revomeTx);






                }
            }
        }
                private void btnAddSubmit_Clicked(object sender, RoutedEventArgs e)
        {
            if(fnamec!=null&&!fnamec.Equals(""))
            {

                var drMailBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[0];
                var drCanIfMailBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[1];
                var drTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
                var drTxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[3];
                var txtDLC = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
                var txtMask = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[1];
                var drRxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[4];
                var drRxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[5];
                var txtDLCRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[2];
                var txtMaskRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[3];
                string mailbox = (string)drMailBox.SelectedItem;
                string canifMailBox= (string)drCanIfMailBox.SelectedItem;
                string txFrameid= (string)drTxFrameId.SelectedItem;
                string txMessage = (string)drTxMessage.SelectedItem;
                string txDLC = txtDLC.Text;
                string txMask = txtMask.Text;
                string rxFrameid = (string)drRxFrameId.SelectedItem;
                string rxMessage = (string)drRxMessage.SelectedItem;
                string txDLCRx = txtDLCRx.Text;
                string txMaskRx = txtMaskRx.Text;
                bool isHexa = System.Text.RegularExpressions.Regex.IsMatch(txMaskRx, @"\A\b(0[xX][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F])+\b\Z");
                if (!isHexa)
                {
                    MessageBox.Show("provide  values in hexa decimal format");
                    return;
                }
                if (rxFrameid != null && !rxFrameid.Trim().Equals("") && rxMessage != null && !rxMessage.Trim().Equals("") && txDLCRx != null && !txDLCRx.Trim().Equals("") && txMaskRx != null && !txMaskRx.Trim().Equals("") && txMask != null&&!txMask.Trim().Equals("")&& txDLC != null && !txDLC.Trim().Equals("") && txMessage != null && !txMessage.Trim().Equals("") && txFrameid != null && !txFrameid.Trim().Equals("") && canifMailBox!=null&&!canifMailBox.Trim().Equals("") && mailbox != null && !mailbox.Trim().Equals(""))
                {
                    mailBoxCanif[mailbox] = canifMailBox;
                    mailBoxFrameId[mailbox] = txFrameid;
                    mailBoxMessage[mailbox] = txMessage;
                    mailBoxDLC[mailbox] = txDLC;
                    mailBoxMaskValue[mailbox] = txMask;

                    mailBoxFrameIdRx[mailbox] = rxFrameid;
                    mailBoxMessageRx[mailbox] = rxMessage;
                    mailBoxDLCRx[mailbox] = txDLCRx;
                    mailBoxMaskValueRx[mailbox] = txMaskRx;


                }
                

            }
            else
            {
                var drMailBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[0];
                var drCanIfMailBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[1];
                var txtTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
                var txtTxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[1];
                var txtDLC = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[2];
                var txtMask = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[3];

                var txtRxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[4];
                var txtRxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[5];
                var txtDLCRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[6];
                var txtMaskRx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[7];
                string mailbox = (string)drMailBox.SelectedItem;
                string canifMailBox = (string)drCanIfMailBox.SelectedItem;
                string txFrameid = txtTxFrameId.Text; ;
                string txMessage = txtTxMessage.Text ;
                string txDLC = txtDLC.Text;
                string txMask = txtMask.Text;
                string rxFrameid = txtRxFrameId.Text; ;
                string rxMessage = txtRxMessage.Text;
                string txDLCRx = txtDLCRx.Text;
                string txMaskRx = txtMaskRx.Text;
                if (txMaskRx != null && !txMaskRx.Trim().Equals("") && txDLCRx != null && !txDLCRx.Trim().Equals("") && rxMessage != null && !rxMessage.Trim().Equals("") && rxFrameid != null && !rxFrameid.Trim().Equals("") && txMask != null && !txMask.Trim().Equals("") && txDLC != null && !txDLC.Trim().Equals("") && txMessage != null && !txMessage.Trim().Equals("") && txFrameid != null && !txFrameid.Trim().Equals("") && canifMailBox != null && !canifMailBox.Trim().Equals("") && mailbox != null && !mailbox.Trim().Equals(""))
                {
                    mailBoxCanif[mailbox] = canifMailBox;
                    mailBoxFrameId[mailbox] = txFrameid;
                    mailBoxMessage[mailbox] = txMessage;
                    mailBoxDLC[mailbox] = txDLC;
                    mailBoxMaskValue[mailbox] = txMask;

                    mailBoxFrameIdRx[mailbox] = rxFrameid;
                    mailBoxMessageRx[mailbox] = rxMessage;
                    mailBoxDLCRx[mailbox] = txDLCRx;
                    mailBoxMaskValueRx[mailbox] = txMaskRx;


                }

            }
            if (selectedMailCanIf != null && !selectedMailCanIf.Trim().Equals(""))
            {


                if (selectedMailCanIf.Equals("CANIF_TxBasicCANMailbox"))
                {
                    if (btnAddMore != null)
                    {
                        btnAddMore.IsEnabled = true;
                    }
                }
                else
                {
                    if (btnAddMore != null)
                    {

                        btnAddMore.IsEnabled = false;

                    }
                }
            }
            MessageBox.Show("Successfully Submited");
        }
   
            private void btnAddMoreButton_Clicked(object sender, RoutedEventArgs e)
        {
            if(selectedMailCanIf != null && selectedMailCanIf.Equals("CANIF_TxBasicCANMailbox"))
            {
                if (fnamec != null && !fnamec.Trim().Equals(""))
                {

                    var drMailBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[0];
                    var drCanIfMailBox = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[1];
                    var drTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
                    var drTxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[3];
                    var txtDLC = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[0];
                    var txtMask = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<TextBox>().ToList()[1];
                    var listBoxTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ListBox>().ToList()[0];
                    var listBoxTxMessage = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ListBox>().ToList()[1];
                    string mailbox = (string)drMailBox.SelectedItem;
                    string canifMailBox = (string)drCanIfMailBox.SelectedItem;
                    string txFrameid = (string)drTxFrameId.SelectedItem;
                    string txMessage = (string)drTxMessage.SelectedItem;
                    string txDLC = txtDLC.Text;
                    string txMask = txtMask.Text;
                  
                    if (txMask != null && !txMask.Trim().Equals("") && txDLC != null && !txDLC.Trim().Equals("") && txMessage != null && !txMessage.Trim().Equals("") && txFrameid != null && !txFrameid.Trim().Equals("") && canifMailBox != null && !canifMailBox.Trim().Equals("") && mailbox != null && !mailbox.Trim().Equals(""))
                    {
                        if(mailBoxMessage.ContainsKey(mailbox))
                        {
                            if(mailBoxMessageMore.ContainsKey(mailbox))
                            {
                                List<string> lstMessage = mailBoxMessageMore[mailbox];
                               
                                lstMessage.Add(txMessage);
                                mailBoxMessageMore[mailbox] = lstMessage;
                                List<string> lstFameId = mailBoxFrameIdMore[mailbox];
                                lstFameId.Add(txFrameid);
                                mailBoxFrameIdMore[mailbox] = lstFameId;
                                List<string> lstDLC = mailBoxDLCMore[mailbox];
                                lstDLC.Add(txDLC);
                                mailBoxDLCMore[mailbox] = lstDLC;
                                List<string> lstMaskValue = mailBoxMaskValueMore[mailbox];
                                lstMaskValue.Add(txMask);
                                mailBoxMaskValueMore[mailbox] = lstMaskValue;

                            }
                            else
                            {
                                if (!mailBoxMessage[mailbox].Equals((txMessage)))
                                {
                                    List<string> lstMessage = new List<string>();
                                    lstMessage.Add(txMessage);
                                    mailBoxMessageMore[mailbox] = lstMessage;
                                    List<string> lstFameId = new List<string>();
                                    lstFameId.Add(txFrameid);
                                    mailBoxFrameIdMore[mailbox] = lstFameId;
                                    List<string> lstDLC = new List<string>();
                                    lstDLC.Add(txDLC);
                                    mailBoxDLCMore[mailbox] = lstDLC;
                                    List<string> lstMaskValue = new List<string>();
                                    lstMaskValue.Add(txMask);
                                    mailBoxMaskValueMore[mailbox] = lstMaskValue;
                                }
                                
                            }

                        }
                        else
                        {
                            mailBoxCanif[mailbox] = canifMailBox;
                            mailBoxFrameId[mailbox] = txFrameid;
                            mailBoxMessage[mailbox] = txMessage;
                            mailBoxDLC[mailbox] = txDLC;
                            mailBoxMaskValue[mailbox] = txMask;
                        }
                       


                    }

                  
                       
                        var drMailTxFrameId = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[2];
                        var drMailTx = SpForDynamicGridIf.Children.OfType<Grid>().ToList()[0].Children.OfType<ComboBox>().ToList()[3];

                        List<String> onlyTx = new List<string>();
                        List<String> onlyTxAlloted = new List<string>();
                        List<String> onlyTxFame = new List<string>();
                        List<String> onlyTxFameAlloted = new List<string>();
                        foreach (KeyValuePair<string, string> kvp in mailBoxMessage)
                        {
                            onlyTxAlloted.Add(kvp.Value);

                        }
                        foreach (KeyValuePair<string, List<String>> kvp in mailBoxMessageMore)
                        {
                            List<String> ls = kvp.Value;
                            if (ls != null)
                            {
                                foreach (String s in ls)
                                {
                                    onlyTxAlloted.Add(s);
                                }
                            }

                        }
                    listBoxTxFrameId.Items.Clear();
                    listBoxTxMessage.Items.Clear();
                    foreach (String mes in onlyTxAlloted)
                        {
                       
                            if(messagesTxFrameIds.ContainsKey(mes))
                            {
                                listBoxTxFrameId.Items.Add(messagesTxFrameIds[mes]);
                                listBoxTxMessage.Items.Add(mes);
                             }
                           
                        
                         
                         messagesTxFrameIdsCanIf.Remove(mes);
                          
                        }
                        foreach (KeyValuePair<string, string> kvp in messagesTxFrameIdsCanIf)
                        {
                            onlyTx.Add(kvp.Key);

                            onlyTxFame.Add(kvp.Value);


                        }
                        drMailTxFrameId.ItemsSource = onlyTxFame;
                        drMailTx.ItemsSource = onlyTx;
                        if (onlyTx.Count > 0)
                        {
                            drMailTxFrameId.SelectedIndex = 0;
                            selectMailBoxFrameId = onlyTxFame[0];
                            drMailTx.SelectedIndex = 0;
                            selectMailBoxMessage = onlyTx[0];
                        }




                    }
                }


            MessageBox.Show("Successfully Submited");
           


        }
            private void OpenBtn_Click(object sender, RoutedEventArgs e)
        {
            OpenFileDialog openFileDialog = new OpenFileDialog();
            Serializer ser = new Serializer();
            string stringFile = string.Empty;
            string FileExt = string.Empty;
            string DirPath = string.Empty;

            if (Directory.GetCurrentDirectory().Contains("bin"))
            {
                DirPath = Directory.GetCurrentDirectory().Substring(0, Directory.GetCurrentDirectory().IndexOf("\\bin"));
            }
            else
            {
                DirPath = Directory.GetCurrentDirectory();
            }

            if (openFileDialog.ShowDialog() == true)
            {
                stringFile = File.ReadAllText(openFileDialog.FileName);
                FileExt = Path.GetExtension(openFileDialog.FileName);
            }
            if (FileExt.Equals(".arxml", StringComparison.OrdinalIgnoreCase))
            {
                try
                {
                    DockingManagerModelHelper.Configuration = ser.Deserialize<AUTOSAR>(stringFile);
                    DockingManagerModelHelper.ProjectName = DockingManagerModelHelper.Configuration.ARPACKAGES[0].ELEMENTS.ECUCMODULECONFIGURATIONVALUES.DEFINITIONREF.Value;
                    File.WriteAllText(DockingManagerModelHelper.TargetInputFolderPath + "\\DefaultConfig.arxml", stringFile);
                    PopulateWorkspaceExplorer();
                    CreateDynamicWPFGridForModule();

                    MessageBox.Show(openFileDialog.FileName + " Loaded Successfully.");
                }
                catch (Exception)
                {
                    MessageBox.Show("Invalid ARXML format....Please select an ARXML file with defined format.");
                }
            }
            else if (FileExt.Equals(".dbc", StringComparison.OrdinalIgnoreCase))
            {
                File.WriteAllText(DockingManagerModelHelper.TargetInputFolderPath + "\\Sample_DB.dbc", stringFile);
                MessageBox.Show(openFileDialog.FileName + " Loaded Successfully.");
            }
            else if (FileExt.Equals(".h", StringComparison.OrdinalIgnoreCase))
            {
                File.WriteAllText(DockingManagerModelHelper.TargetInputFolderPath + "\\CAN_Driver_cfg.h", stringFile);
                MessageBox.Show(openFileDialog.FileName + " Loaded Successfully.");
            }
            else
            {
                MessageBox.Show("Only files having extension .ARXML, .DBC and .h files can be opened.");
            }
        }

        private void GenerateCanMgrBtn_Click(object sender, RoutedEventArgs e)
        {
            String Message = "Output Files Generated and Saved Successfully at following path : " + DockingManagerModelHelper.TargetOutputFolderPath;
            if (isManual)
            {
                rxmReceptionTimeout = rxReceptionTimeout;
            }
            else
            {
                rxmReceptionTimeout = rxReceptionTimeoutDefault;
            }
            genHeaderFile();
            genCFile(fnamec);
            MessageBox.Show(Message);


        }
        private void genCFile(String fname)
        {
            using (StreamWriter outputFile = new StreamWriter(Path.Combine(DockingManagerModelHelper.TargetOutputFolderPath, "CanMgr_cfg.c")))
            {
                outputFile.WriteLine("/*");
                outputFile.WriteLine("* CanMgr_cfg.c");
                outputFile.WriteLine("*");
                outputFile.WriteLine("*  Created on:" + DateTime.Now.ToString("d-M-yyyy"));
                outputFile.WriteLine("*      Author: " + Environment.MachineName);
                outputFile.WriteLine("*/");
                outputFile.WriteLine("");
                outputFile.WriteLine("#include \"CanMgr_cfg.h\"");
                outputFile.WriteLine("#include \"CanMgr.h\"");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define EINVAL 22");
                outputFile.WriteLine("");
                outputFile.WriteLine("");

                List<String> txMsg = null;
                if (txMessage.ContainsKey(selectedNode))
                {
                    txMsg = txMessage[selectedNode];
                }
                int txMsgCount = 0;
                if (txMsg != null && txMsg.Count > 0)
                {
                    foreach (String msg in txMsg)
                    {
                        txMsgCount++;
                        outputFile.WriteLine("/**");
                        outputFile.WriteLine("* Signals in message " + msg + ".");
                        outputFile.WriteLine("*");
                        outputFile.WriteLine("* All signal values are as on the CAN bus.");
                        outputFile.WriteLine("*/");
                        outputFile.WriteLine("");
                        outputFile.WriteLine("");
                        outputFile.WriteLine("typedef struct {");
                        if (messagesTxSignal.ContainsKey(msg))
                        {
                            List<String> signalsTx = messagesTxSignal[msg];
                            if (signalsTx != null && signalsTx.Count > 0)
                            {
                                foreach (string sig in signalsTx)
                                {
                                    outputFile.WriteLine("uint8_t " + SplitCamelCase(sig).ToLower() + ";");
                                }


                            }

                        }
                        outputFile.WriteLine("}" + fname + "_" + msg + "_t" + ";");
                        outputFile.WriteLine("");

                        outputFile.WriteLine(fname + "_" + msg + "_t   " + msg + ";");
                        outputFile.WriteLine("");

                    }

                    outputFile.WriteLine();
                    outputFile.WriteLine("uint8_t Init_data_value[CANMGR_MAX_NO_OF_TX_MSGS][8];");
                    outputFile.WriteLine();
                    outputFile.WriteLine();
                    outputFile.WriteLine();
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    foreach (String msg in txMsg)
                    {
                        if (messagesIntitials.ContainsKey(msg))
                        {
                            List<String> lsIntitials = messagesIntitials[msg];
                            string inti = "{";
                            if (lsIntitials != null && lsIntitials.Count > 1)
                            {
                                inti += messagesTxInitialsConfig.ContainsKey(lsIntitials[0]) ? messagesTxInitialsConfig[lsIntitials[0]] : lsIntitials[1];
                                for (int index = 3; index < lsIntitials.Count; index += 2)
                                {
                                    inti += "," + (messagesTxInitialsConfig.ContainsKey(lsIntitials[index]) ? messagesTxInitialsConfig[lsIntitials[index]] : lsIntitials[1]);
                                }
                            }
                            inti += "};";
                            outputFile.WriteLine("const " + fnamec + "_" + msg + "_t default_" + msg + " =" + inti);
                        }

                    }

                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("uint8_t Init_data_value[CANMGR_MAX_NO_OF_TX_MSGS][8];");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("void CanMgr_cfgInit(void)");
                    outputFile.WriteLine("{");
                    int i = 0;
                    int j = 0;
                    if (txMsg != null && txMsg.Count > 0)
                    {
                        foreach (String msg in txMsg)
                        {

                            outputFile.WriteLine(fname + "_" + msg + "_pack(&Init_data_value[" + msg + "][" + i + "], &" + msg + ", " + msg + "_LENGTH);");


                            i++;



                        }
                    }

                    outputFile.WriteLine("}");
                    outputFile.WriteLine();

                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                }
                outputFile.WriteLine("Rx_Dispatcher_t Rx_Dispatcher[MAX_RX_SIGNALS] = {");

                List<String> rxMsg = null;
                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {

                        int msgIndex = 0;

                        foreach (String msg in rxMsg)
                        {
                            if (messagesRxSignal.ContainsKey(msg))
                            {
                                List<String> rxSignal = messagesRxSignal[msg];
                                foreach (String rs in rxSignal)
                                {
                                    if(msgIndex==0)
                                    {
                                        outputFile.Write("       {"+msgIndex +",&CanMgr_Read"+SplitCamelCase(rs ).ToLower()+ "}");
                                    }
                                    else
                                    {
                                        outputFile.Write(",");
                                        outputFile.WriteLine();
                                        outputFile.Write("       {" + msgIndex +",&CanMgr_Read" + rs + "}");
                                    }
                                }
                                msgIndex++;
                            }
                        }
                    }
                }
                outputFile.WriteLine();
                    outputFile.WriteLine("};");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                outputFile.WriteLine("Rx_SignalIndication_t RxCbk_SignalIndication_Table[MAX_RX_SIGNALS] ={");

              
                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {

                        int msgIndex = 0;

                        foreach (String msg in rxMsg)
                        {
                            if (messagesRxSignal.ContainsKey(msg))
                            {
                                List<String> rxSignal = messagesRxSignal[msg];
                                foreach (String rs in rxSignal)
                                {
                                    if (msgIndex == 0)
                                    {
                                        outputFile.Write("       { CANMGR_"+SplitCamelCase(rs).ToUpper()+"_RXCBK }");
                                    }
                                    else
                                    {
                                        outputFile.Write(",");
                                        outputFile.WriteLine();
                                        outputFile.Write("       { CANMGR_" + SplitCamelCase(rs).ToUpper() + "_RXCBK }");
                                    }
                                }
                               
                            }
                        }
                    }
                }
                outputFile.WriteLine();
                outputFile.WriteLine("};");
                outputFile.WriteLine();
                outputFile.WriteLine();


                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {

                        int msgIndex = 0;

                        foreach (String msg in rxMsg)
                        {
                            if (messagesRxSignal.ContainsKey(msg))
                            {
                                List<String> rxSignal = messagesRxSignal[msg];
                                foreach (String rs in rxSignal)
                                {
                                    if (msgIndex == 0)
                                    {
                                        outputFile.Write("       {" + msgIndex+",CANMGR_" + SplitCamelCase(rs).ToUpper() + "_TIMEOUT_CBK}");
                                    }
                                    else
                                    {
                                        outputFile.Write(",");
                                        outputFile.WriteLine();
                                        outputFile.Write("       {" + msgIndex+",CANMGR_" + SplitCamelCase(rs).ToUpper() + "_TIMEOUT_CBK}");
                                    }
                                }
                                msgIndex++;
                            }
                        }
                    }
                }
                outputFile.WriteLine();
                outputFile.WriteLine("};");
                outputFile.WriteLine();
                outputFile.WriteLine();
                outputFile.WriteLine();
                outputFile.WriteLine("CanMgr_TxInfoTable_t CanMgr_TxInfoTable[CANMGR_MAX_NO_OF_TX_MSGS] = {");
                    outputFile.WriteLine("      {");
                    outputFile.WriteLine("          " + txMsg[0] + "_TX_METHOD , ");
                    outputFile.WriteLine("          " + txMsg[0] + "_CLC_TIME,");
                    outputFile.WriteLine("          " + txMsg[0] + "_LENGTH,");
                    outputFile.WriteLine("          " + "0");
                    outputFile.WriteLine("      " + "}");
                    for (int index = 1; index < txMsg.Count; index++)
                    {
                        outputFile.WriteLine("      ,");
                        outputFile.WriteLine("      {");
                        outputFile.WriteLine("          " + txMsg[index] + "_TX_METHOD , ");
                        outputFile.WriteLine("          " + txMsg[index] + "_CLC_TIME,");
                        outputFile.WriteLine("          " + txMsg[index] + "_LENGTH,");
                        outputFile.WriteLine("          0");
                        outputFile.WriteLine("          }");

                    }
                    outputFile.WriteLine("};");




                
                outputFile.WriteLine("");
                outputFile.WriteLine("");


                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];


                    if (rxMsg != null && rxMsg.Count > 0)
                    {
                        outputFile.WriteLine("CanMgr_RxInfoTable_t CanMgr_RxInfoTable[CAM_MGR_MAX_NO_OF_RX_MSGS] = {");
                        outputFile.WriteLine("      {");
                        outputFile.WriteLine("          " + rxMsg[0] + "_RX_METHOD , ");
                        outputFile.WriteLine("          " + rxMsg[0] + "_LENGTH,");
                        outputFile.WriteLine("          " + (rxReceptionTimeout.ContainsKey(rxMsg[0]) ? rxReceptionTimeout[rxMsg[0]] : "0") + ",");
                        outputFile.WriteLine("          0");
                        outputFile.WriteLine("          }");
                        for (int index = 1; index < rxMsg.Count; index++)
                        {
                            outputFile.WriteLine("      ,");
                            outputFile.WriteLine("      {");
                            outputFile.WriteLine("          " + rxMsg[index] + "_RX_METHOD , ");
                            outputFile.WriteLine("          " + rxMsg[index] + "_LENGTH,");
                            outputFile.WriteLine("          " + (rxReceptionTimeout.ContainsKey(rxMsg[index]) ? rxReceptionTimeout[rxMsg[index]] : "0") + ",");
                            outputFile.WriteLine("          0");
                            outputFile.WriteLine("          }");
                        }
                        outputFile.WriteLine("};");

                    }
                }
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                if (txMsg != null && txMsg.Count > 0)
                {
                   
                        foreach (String msg in txMsg)
                        {
                            outputFile.WriteLine("/**");
                            outputFile.WriteLine("* Pack message " + msg + ".");
                            outputFile.WriteLine("*");
                            outputFile.WriteLine("* @param[out] dst_p Buffer to pack the message into.");
                            outputFile.WriteLine("* @param[in] src_p Data to pack.");
                            outputFile.WriteLine("* @param[in] size Size of dst_p.");
                            outputFile.WriteLine("*");
                            outputFile.WriteLine("* @return Size of packed data, or negative error code.");
                            outputFile.WriteLine("*/");
                            outputFile.WriteLine("int " + fname + "_" + msg + "_pack(");
                            outputFile.WriteLine("      uint8_t *dst_p,");
                            outputFile.WriteLine("      const  " + fname + "_" + msg + "_t *src_p,");
                            outputFile.WriteLine("      size_t size);");
                            outputFile.WriteLine("");
                            outputFile.WriteLine("");
                            outputFile.WriteLine("");
                        }

                    
                  
                        foreach (String msg in txMsg)
                        {
                            outputFile.WriteLine("/**");
                            outputFile.WriteLine("* Unpack message " + msg + ".");
                            outputFile.WriteLine("*");
                            outputFile.WriteLine("* @param[out] dst_p Object to unpack the message into.");
                            outputFile.WriteLine("* @param[in] src_p Message to unpack.");
                            outputFile.WriteLine("* @param[in] size Size of src_p.");
                            outputFile.WriteLine("*");
                            outputFile.WriteLine("* @return zero(0) or negative error code.");
                            outputFile.WriteLine("*/");
                            outputFile.WriteLine("int " + fname + "_" + msg + "_unpack(");
                            outputFile.WriteLine("      struct " + fname + "_" + msg + "_t *dst_p,");
                            outputFile.WriteLine("      const uint8_t *src_p,");
                            outputFile.WriteLine("      size_t size);");
                            outputFile.WriteLine("");
                            outputFile.WriteLine("");
                            outputFile.WriteLine("");
                        }
                    
                    
                        outputFile.WriteLine("/**");
                        outputFile.WriteLine("*");
                        outputFile.WriteLine("* @param[in] value Signal to encode.");
                        outputFile.WriteLine("*");
                        outputFile.WriteLine("* @return Encoded signal.");
                        outputFile.WriteLine("*/");
                        foreach (String msg in txMsg)
                        {
                            if (messagesTxSignal.ContainsKey(msg))
                            {
                                List<String> msgSignals = messagesTxSignal[msg];
                                if (msgSignals != null && msgSignals.Count > 0)
                                {
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("uint8_t " + fname + "_" + msg + "_" + sig + "_encode(double value);");

                                    }
                                }
                            }
                        }
                    
                    
                        outputFile.WriteLine("");
                        outputFile.WriteLine("");
                        outputFile.WriteLine("");
                        outputFile.WriteLine("/**");
                        outputFile.WriteLine("* Decode given signal by applying scaling and offset.");
                        outputFile.WriteLine("*");
                        outputFile.WriteLine("* @param[in] value Signal to decode.");
                        outputFile.WriteLine("*");
                        outputFile.WriteLine("* @return Decoded signal.");
                        outputFile.WriteLine("*/");
                        foreach (String msg in txMsg)
                        {
                            if (messagesTxSignal.ContainsKey(msg))
                            {
                                List<String> msgSignals = messagesTxSignal[msg];
                                if (msgSignals != null && msgSignals.Count > 0)
                                {
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("double " + fname + "_" + msg + "_" + sig + "_decode(uint8_t value);");
                                    }
                                }
                            }

                        
                    }
                   
                        outputFile.WriteLine("");
                        outputFile.WriteLine("");
                        outputFile.WriteLine("");
                        outputFile.WriteLine("/**");
                        outputFile.WriteLine("* Check that given signal is in allowed range.");
                        outputFile.WriteLine("*");
                        outputFile.WriteLine("* @param[in] value Signal to check.");
                        outputFile.WriteLine("*");
                        outputFile.WriteLine("@return true if in range, false otherwise.");
                        outputFile.WriteLine("*/");
                        foreach (String msg in txMsg)
                        {
                            if (messagesTxSignal.ContainsKey(msg))
                            {
                                List<String> msgSignals = messagesTxSignal[msg];
                                if (msgSignals != null && msgSignals.Count > 0)
                                {
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("bool " + fname + "_" + msg + "_" + sig + "_is_in_range(uint8_t value);");
                                    }
                                }
                            }

                        }
                    
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("static inline uint8_t pack_left_shift_u8(");
                    outputFile.WriteLine("      uint8_t value,");
                    outputFile.WriteLine("      uint8_t shift,");
                    outputFile.WriteLine("      uint8_t mask)");
                    outputFile.WriteLine("{");
                    outputFile.WriteLine("      return (uint8_t)((uint8_t)(value << shift) & mask);");
                    outputFile.WriteLine("}");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("static inline uint8_t pack_left_shift_u16(");
                    outputFile.WriteLine("      uint16_t value,");
                    outputFile.WriteLine("      uint8_t shift,");
                    outputFile.WriteLine("      uint8_t mask)");
                    outputFile.WriteLine("{");
                    outputFile.WriteLine("      return (uint8_t)((uint8_t)(value << shift) & mask);");
                    outputFile.WriteLine("}");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("static inline uint8_t pack_right_shift_u16(");
                    outputFile.WriteLine("      uint16_t value,");
                    outputFile.WriteLine("      uint8_t shift,");
                    outputFile.WriteLine("      uint8_t mask)");
                    outputFile.WriteLine("{");
                    outputFile.WriteLine("      return (uint8_t)((uint8_t)(value >> shift) & mask);");
                    outputFile.WriteLine("}");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("static inline uint16_t unpack_left_shift_u16(");
                    outputFile.WriteLine("      uint8_t value,");
                    outputFile.WriteLine("      uint8_t shift,");
                    outputFile.WriteLine("      uint8_t mask)");
                    outputFile.WriteLine("{");
                    outputFile.WriteLine("      return (uint16_t)((uint16_t)(value & mask) << shift);");
                    outputFile.WriteLine("}");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("static inline uint8_t unpack_right_shift_u8(");
                    outputFile.WriteLine("      uint8_t value,");
                    outputFile.WriteLine("      uint8_t shift,");
                    outputFile.WriteLine("      uint8_t mask)");
                    outputFile.WriteLine("{");
                    outputFile.WriteLine("      return (uint8_t)((uint8_t)(value & mask) >> shift);");
                    outputFile.WriteLine("}");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("static inline uint16_t unpack_right_shift_u16(");
                    outputFile.WriteLine("      uint8_t value,");
                    outputFile.WriteLine("      uint8_t shift,");
                    outputFile.WriteLine("      uint8_t mask)");
                    outputFile.WriteLine("{");
                    outputFile.WriteLine("      return (uint16_t)((uint16_t)(value & mask) >> shift);");
                    outputFile.WriteLine("}");
                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                   
                        foreach (String msg in txMsg)
                        {
                            outputFile.WriteLine("int " + fname + "_" + msg + "_pack(");
                            outputFile.WriteLine("      uint8_t *dst_p,");
                            outputFile.WriteLine("      const  " + fname + "_" + msg + "_t *src_p,");
                            outputFile.WriteLine("      size_t size)");
                            outputFile.WriteLine("{");
                        String dlc = messagesTxDLC.ContainsKey(msg) ? messagesTxDLC[msg]+"u" :"0u";
                            outputFile.WriteLine("      if (size < "+dlc+") {");
                            outputFile.WriteLine("          return (-EINVAL);");
                            outputFile.WriteLine("      }");
                            outputFile.WriteLine("      memset(&dst_p[0], 0, "+dlc+");");
                            outputFile.WriteLine("");

                            if (messagesTxSignal.ContainsKey(msg))
                            {
                                List<String> msgSignals = messagesTxSignal[msg];
                                if (msgSignals != null && msgSignals.Count > 0)
                                {
                                    int index = 0;
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("dst_p[" + index + "] |= pack_left_shift_u8(src_p->" + sig + ", 6u, 0xc0u);");
                                        index++;
                                    }
                                    outputFile.WriteLine("      return (" + msgSignals.Count + ");");
                                }
                                else
                                {
                                    outputFile.WriteLine("      return (0);");
                                }
                            }
                            else
                            {
                                outputFile.WriteLine("      return (0);");
                            }
                            outputFile.WriteLine("}");
                            outputFile.WriteLine("");
                        }
                    
                   
                        foreach (String msg in txMsg)
                        {
                            outputFile.WriteLine("");
                            outputFile.WriteLine("int " + fname + "_" + msg + "_unpack(");
                            outputFile.WriteLine("       " + fname + "_" + msg + "_t *dst_p,");
                            outputFile.WriteLine("      const uint8_t *src_p,");
                            outputFile.WriteLine("      size_t size)");
                            outputFile.WriteLine("{");
                        String dlc = messagesTxDLC.ContainsKey(msg) ? messagesTxDLC[msg] + "u" : "0u";
                        outputFile.WriteLine("      if (size < "+dlc+") {");
                            outputFile.WriteLine("          return (-EINVAL);");
                            outputFile.WriteLine("      }");
                            outputFile.WriteLine("      memset(dst_p, 0, sizeof(*dst_p));");
                            outputFile.WriteLine("");

                            if (messagesTxSignal.ContainsKey(msg))
                            {
                                List<String> msgSignals = messagesTxSignal[msg];
                                if (msgSignals != null && msgSignals.Count > 0)
                                {
                                    int index = 0;
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("dst_p->" + sig + " |= unpack_right_shift_u8(src_p[" + index + "], 6u, 0xc0u);");
                                        index++;
                                    }
                                    outputFile.WriteLine("      return (0);");
                                }
                                else
                                {
                                    outputFile.WriteLine("      return (0);");
                                }
                            }
                            else
                            {
                                outputFile.WriteLine("      return (0);");
                            }
                            outputFile.WriteLine("}");
                            outputFile.WriteLine("");
                        }
                    
                    outputFile.WriteLine("");
                   
                        foreach (String msg in txMsg)
                        {
                            outputFile.WriteLine("");
                            if (messagesTxSignal.ContainsKey(msg))
                            {
                                List<String> msgSignals = messagesTxSignal[msg];
                                if (msgSignals != null && msgSignals.Count > 0)
                                {

                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("uint8_t " + fname + "_" + msg + "_" + sig + "_encode(double value)");
                                        outputFile.WriteLine("{");
                                        outputFile.WriteLine("  return (uint8_t)(value);");
                                        outputFile.WriteLine("}");
                                        outputFile.WriteLine("");
                                        outputFile.WriteLine("");
                                        outputFile.WriteLine("double " + fname + "_" + msg + "_" + sig + "_decode(uint8_t value)");
                                        outputFile.WriteLine("{");
                                        outputFile.WriteLine("  return ((double)value);");
                                        outputFile.WriteLine("}");

                                        outputFile.WriteLine("");
                                        outputFile.WriteLine("");
                                        outputFile.WriteLine("bool " + fname + "_" + msg + "_" + sig + "_is_in_range(uint8_t value)");
                                        outputFile.WriteLine("{");
                                        outputFile.WriteLine("  return (value <= 3u);");
                                        outputFile.WriteLine("}");
                                        outputFile.WriteLine("");
                                        outputFile.WriteLine("");
                                    }

                                }
                            }
                        }

                    





                    outputFile.WriteLine("");
                    outputFile.WriteLine("");
                    foreach (String msg in txMsg)
                    {
                        if (messagesTxSignal.ContainsKey(msg))
                        {
                            List<String> msgSignals = messagesTxSignal[msg];
                            if (msgSignals != null && msgSignals.Count > 0)
                            {
                              
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("uint8_t CanMgr_Write_" + SplitCamelCase(sig) + "(double data)");
                                        outputFile.WriteLine("{");
                                        outputFile.WriteLine("  uint8_t ret;");
                                        outputFile.WriteLine("  uint8_t f1_encoded_data;");
                                        outputFile.WriteLine("  uint8_t f1_data[8]={0};");
                                        outputFile.WriteLine("  f1_encoded_data = " + fname + "_" + msg + "_" + SplitCamelCase(sig) + "_encode(data);");
                                        outputFile.WriteLine("  if(" + fname + "_" + msg + "_" + SplitCamelCase(sig) + "_is_in_range(f1_encoded_data))");
                                        outputFile.WriteLine("  {");
                                        outputFile.WriteLine("      " + msg + "." + SplitCamelCase(sig) + " = f1_encoded_data;");
                                        outputFile.WriteLine("      (void)" + fname + "_" + msg + "_pack(fl_data,&" + msg + "," + msg + "_LENGTH);");
                                        outputFile.WriteLine("      ret = CanMgr_SendSignal(CANMGR_" + msg + ",fl_data);");
                                        outputFile.WriteLine("  }");
                                        outputFile.WriteLine("  else");
                                        outputFile.WriteLine("  {");
                                        outputFile.WriteLine("      ret = E_NOT_OK;");
                                        outputFile.WriteLine("  }");
                                        outputFile.WriteLine("  return ret;");
                                        outputFile.WriteLine("}");
                                        outputFile.WriteLine("");
                                        outputFile.WriteLine("");
                                    }
                                
                                outputFile.WriteLine("");
                                outputFile.WriteLine("");
                               
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("uint8_t CanMgr_Read_" + sig + "(uint8_t* data)");
                                        outputFile.WriteLine("{");
                                        outputFile.WriteLine("  uint8_t fl_data[" + msg + "_LENGTH];");
                                        outputFile.WriteLine("  uint8_t ret;");
                                        outputFile.WriteLine("  ret = CanMgr_ReceiveSignal(CANMGR_" + msg + ",fl_data);");
                                        outputFile.WriteLine("  " + fname + "_" + msg + "_unpack(&" + msg + ",fl_data," + msg + "_LENGTH);");
                                        outputFile.WriteLine("  *data =(uint8_t)" + msg + "." + sig + ";");
                                        outputFile.WriteLine("  return ret;");
                                        outputFile.WriteLine("}");
                                    }
                                
                                outputFile.WriteLine("");
                                outputFile.WriteLine("");
                                
                                    foreach (String sig in msgSignals)
                                    {
                                        outputFile.WriteLine("uint8_t CanMgr_" + sig + "_cbk(void)");
                                        outputFile.WriteLine("{");
                                        outputFile.WriteLine("  return (CanMgr_GetTransmissionStatus(CANMGR_" + msg + "));");
                                        outputFile.WriteLine("}");
                                        outputFile.WriteLine("");

                                    }
                                
                            }
                        }


                    }



                }



            }
        }
        private  string SplitCamelCase(string inputCamelCaseString)
        {
           
                string sTemp = Regex.Replace(inputCamelCaseString, "([A-Z][a-z])", " $1", RegexOptions.Compiled).Trim();
                return Regex.Replace(sTemp, "([A-Z][A-Z])", " $1", RegexOptions.Compiled).Trim().Replace(" ", "_");
           
            
        }
        private void genHeaderFile()
        {
            using (StreamWriter outputFile = new StreamWriter(Path.Combine(DockingManagerModelHelper.TargetOutputFolderPath, "CanMgr_cfg.h")))
            {
                outputFile.WriteLine("/*");
                outputFile.WriteLine("* CanMgr_cfg.h");
                outputFile.WriteLine("*");
                outputFile.WriteLine("*  Created on:" + DateTime.Now.ToString("d-M-yyyy"));
                outputFile.WriteLine("*      Author: " + Environment.MachineName);
                outputFile.WriteLine("*/");
                outputFile.WriteLine("");
                outputFile.WriteLine("#ifndef CANMGR_CFG_H_");
                outputFile.WriteLine("#define CANMGR_CFG_H_");
                outputFile.WriteLine("");
                outputFile.WriteLine("#include \"..\\src\\CanMgr_Types.h\"");
                outputFile.WriteLine("#include \"sample_cbk.h\"");
                outputFile.WriteLine("#include \"hal_stdtypes.h\"");
                outputFile.WriteLine("#include <Sample_APP.h>");
                 outputFile.WriteLine("");
              
                outputFile.WriteLine("/*Callback function mapping table*/");
                outputFile.WriteLine("");
                List<String> rxMsg = null;
                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {


                        foreach (String msg in rxMsg)
                        {
                            if (messagesRxSignal.ContainsKey(msg))
                            {
                                List<String> rxSignal = messagesRxSignal[msg];
                                foreach (String rs in rxSignal)
                                {
                                    outputFile.WriteLine("#define CANMGR_" + SplitCamelCase(rs).ToUpper() + "_RXCBK     " + (rxReceptionCallBackFunction.ContainsKey(rs)? "&"+rxReceptionCallBackFunction[rs]:"NULL"));

                                }

                            }


                        }


                        outputFile.WriteLine();
                        outputFile.WriteLine();

                        
                        outputFile.WriteLine(/*Callback function mapping table*/);


                        foreach (String msg in rxMsg)
                        {
                            if (messagesRxSignal.ContainsKey(msg))
                            {
                                List<String> rxSignal = messagesRxSignal[msg];
                                foreach (String rs in rxSignal)
                                {
                                    outputFile.WriteLine("#define CANMGR_" + SplitCamelCase(rs).ToUpper() + "_TIMEOUT_CBK       " + (rxReceptionTimeoutCallBack.ContainsKey(rs) ? "&" + rxReceptionTimeoutCallBack[rs] : "NULL"));
                                }

                            }


                        }
                    }

                }

                outputFile.WriteLine();
                outputFile.WriteLine();
                outputFile.WriteLine();
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("#define APPLICATION_WAKEUP_CBK   User_Mode_Indication_Callback()");
                outputFile.WriteLine("#define APPLICATION_SLEEP_CBK_FUNC(Result)");
                outputFile.WriteLine("#define INIT_DATA_VALUE    &Init_data_value");
                outputFile.WriteLine();
                outputFile.WriteLine();
                outputFile.WriteLine("#define CANMGR_MAINFUNCTION_PERIOD        0x0Au");
                outputFile.WriteLine();
                outputFile.WriteLine();


                List<String> txMsg = null;
                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");

                if (txMessage.ContainsKey(selectedNode))
                {
                    txMsg = txMessage[selectedNode];

                    if (txMsg != null && txMsg.Count > 0)
                    {
                      

                        for(int ind= 0;ind< txMsg.Count;ind++)
                        {
                           
                            outputFile.WriteLine("      " + txMsg[ind].ToUpper() + "="+ind+"u,");

                        }
                    }
                    outputFile.WriteLine("       CANMGR_MAX_NO_OF_TX_MSGS " + txMsg.Count+"u");
                }
                outputFile.WriteLine("}Tx_Msg_Id;");
                outputFile.WriteLine();



                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");

                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {
                      

                        for (int ind = 0; ind < rxMsg.Count; ind++)
                        {

                            outputFile.WriteLine("      " + rxMsg[ind].ToUpper() + "=" + ind + "u,");

                        }
                    }
                    outputFile.WriteLine("       CANMGR_MAX_NO_OF_RX_MSGS " + rxMsg.Count + "u");
                }
                outputFile.WriteLine("}Rx_Msg_Id;");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine(/* Tx Frame ids. */);
                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (txMessage.ContainsKey(selectedNode))
                {
                    txMsg = txMessage[selectedNode];

                    if (txMsg != null && txMsg.Count > 0)
                    {
                        outputFile.Write("      " + txMsg[0].ToUpper() + "_FRAME_ID" + " = " + (messagesTxFrameIds.ContainsKey(txMsg[0]) ? "("+ messagesTxFrameIds[txMsg[0]]+")" : "(0x0000)"));

                        for (int ind = 1; ind < txMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + txMsg[ind].ToUpper()+ "_FRAME_ID" + " = " + (messagesTxFrameIds.ContainsKey(txMsg[ind])? "("+messagesTxFrameIds[txMsg[ind]]+")" : "(0x0000)"));
                            
                        }
                    }
                  
                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Tx_Mxg_Frame_Id;");
                outputFile.WriteLine();



                outputFile.WriteLine(/* Rx Frame ids. */);
                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");

                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {
                        outputFile.Write("      " + rxMsg[0].ToUpper() + "_FRAME_ID" + " = " + (messagesRxFrameIds.ContainsKey(txMsg[0]) ? "("+messagesRxFrameIds[rxMsg[0]]+")" : "(0x0000)"));

                        for (int ind = 1; ind < rxMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + rxMsg[ind].ToUpper() + "_FRAME_ID" + " = " + (messagesRxFrameIds.ContainsKey(rxMsg[ind]) ?"("+ messagesRxFrameIds[rxMsg[ind]]+")" : "(0x0000)"));
                            
                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Rx_Mxg_Frame_Id;");
                outputFile.WriteLine();

                outputFile.WriteLine("/* Tx Frame lengths in bytes. */");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (txMessage.ContainsKey(selectedNode))
                {
                    txMsg = txMessage[selectedNode];

                    if (txMsg != null && txMsg.Count > 0)
                    {
                        outputFile.Write("      " + txMsg[0].ToUpper() + "_LENGTH" + " = (" + (mailBoxDLC.ContainsKey(txMsg[0]) ? mailBoxDLC[txMsg[0]]+"u)" : "(0u)"));

                        for (int ind = 1; ind < txMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + txMsg[ind].ToUpper() + "_LENGTH" + " = (" + (mailBoxDLC.ContainsKey(txMsg[ind]) ? mailBoxDLC[txMsg[ind]]+"u)" : "0u)"));
                           
                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Tx_Mxg_Length;");
                outputFile.WriteLine();


                outputFile.WriteLine("/* Rx Frame lengths in bytes. */");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {
                        outputFile.Write("      " + rxMsg[0].ToUpper() + "_LENGTH" + " = (" + (mailBoxDLCRx.ContainsKey(rxMsg[0]) ? mailBoxDLCRx[rxMsg[0]] + "u)" : "(0u)"));

                        for (int ind = 1; ind < rxMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + rxMsg[ind].ToUpper() + "_LENGTH" + " = (" + (mailBoxDLCRx.ContainsKey(rxMsg[ind]) ? mailBoxDLCRx[rxMsg[ind]] + "u)" : "0u)"));

                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Rx_Mxg_Length;");
                outputFile.WriteLine();


                outputFile.WriteLine("/* Tx CLC Time. */");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (txMessage.ContainsKey(selectedNode))
                {
                    txMsg = txMessage[selectedNode];

                    if (txMsg != null && txMsg.Count > 0)
                    {
                        outputFile.Write("      " + txMsg[0].ToUpper() + "_CLC_TIME" + " = (" + (messagesTxCycleTime.ContainsKey(txMsg[0]) ? messagesTxCycleTime[txMsg[0]] + "u)" : "(0u)"));

                        for (int ind = 1; ind < txMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + txMsg[ind].ToUpper() + "_CLC_TIME" + " = (" + (messagesTxCycleTime.ContainsKey(txMsg[ind]) ? messagesTxCycleTime[txMsg[ind]] + "u)"  : "0u)"));

                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Tx_Message_cycle_time;");
                outputFile.WriteLine();




                outputFile.WriteLine("/* Rx CLC Time. */");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {
                        outputFile.Write("      " + rxMsg[0].ToUpper() + "_CLC_TIME" + " = (" + (messagesRxCycleTime.ContainsKey(rxMsg[0]) ? messagesRxCycleTime[rxMsg[0]] + "u)" : "(0u)"));

                        for (int ind = 1; ind < rxMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + rxMsg[ind].ToUpper() + "_CLC_TIME" + " = (" + (messagesRxCycleTime.ContainsKey(rxMsg[ind]) ? messagesRxCycleTime[rxMsg[ind]] + "u)"  : "0u)"));

                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Rx_Message_cycle_time;");
                outputFile.WriteLine();



                outputFile.WriteLine("/* Extended or standard frame types.. */");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (txMessage.ContainsKey(selectedNode))
                {
                    txMsg = txMessage[selectedNode];

                    if (txMsg != null && txMsg.Count > 0)
                    {
                        outputFile.Write("      " + txMsg[0].ToUpper() + "_IS_EXTENDED" + " = " + (messagesExtended.ContainsKey(txMsg[0]) ? (messagesExtended[txMsg[0]].Equals("False")?"(0)":"1"  ): "(0)"));

                        for (int ind = 1; ind < txMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + txMsg[ind].ToUpper() + "_IS_EXTENDED" + " = " + (messagesExtended.ContainsKey(txMsg[ind]) ? (messagesExtended[txMsg[ind]].Equals("False") ? "(0)" : "1" ) : "0)"));

                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Tx_Msg_Identifier_Type;");
                outputFile.WriteLine();




                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {
                        outputFile.Write("      " + rxMsg[0].ToUpper() + "_IS_EXTENDED" + " =  "+ (messagesExtended.ContainsKey(rxMsg[0]) ? (messagesExtended[rxMsg[0]].Equals("False") ? "(0)" : "(1)" ) : "(0)"));

                        for (int ind = 1; ind < rxMsg.Count; ind++)
                        {
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + rxMsg[ind].ToUpper() + "_IS_EXTENDED" + " =" + (messagesExtended.ContainsKey(rxMsg[ind]) ? (messagesExtended[rxMsg[ind]].Equals("False") ? "(0)" : "(1)" ) : "(0)"));

                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Rx_Msg_Identifier_Type;");
                outputFile.WriteLine();



                outputFile.WriteLine("/* Tx Methods. */");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (txMessage.ContainsKey(selectedNode))
                {
                    txMsg = txMessage[selectedNode];

                    if (txMsg != null && txMsg.Count > 0)
                    {
                        string vl = "(0u)";
                        if(messagesTxMethod.ContainsKey(txMsg[0]))
                        {
                            String mt = messagesTxMethod[txMsg[0]];
                            if(mt.Equals("Event"))
                            {
                                vl = "2u";
                            }
                            else if (mt.Equals("Cyclic"))
                            {
                                vl = "0u";
                            }
                            else if (mt.Equals("Combined"))
                            {
                                vl = "1u";
                            }
                        }
                        outputFile.Write("      " + txMsg[0].ToUpper() + "_TX_METHOD" + " = "+vl);

                        for (int ind = 1; ind < txMsg.Count; ind++)
                        {
                            vl = "(0u)";
                            if (messagesTxMethod.ContainsKey(txMsg[ind]))
                            {
                                String mt = messagesTxMethod[txMsg[ind]];
                                if (mt.Equals("Event"))
                                {
                                    vl = "2u";
                                }
                                else if (mt.Equals("Cyclic"))
                                {
                                    vl = "0u";
                                }
                                else if (mt.Equals("Combined"))
                                {
                                    vl = "1u";
                                }
                            }
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + txMsg[ind].ToUpper() + "_TX_METHOD" + " = " + vl);

                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Tx_Msg_Method;");
                outputFile.WriteLine();



                outputFile.WriteLine("/* Rx Methods. */");
                outputFile.WriteLine();
                outputFile.WriteLine();

                outputFile.WriteLine("typedef enum");
                outputFile.WriteLine("{");
                if (rxMessage.ContainsKey(selectedNode))
                {
                    rxMsg = rxMessage[selectedNode];

                    if (rxMsg != null && rxMsg.Count > 0)
                    {
                        string vl = "(0u)";
                        if (messagesRxMethod.ContainsKey(rxMsg[0]))
                        {
                            String mt = messagesRxMethod[rxMsg[0]];
                            if (mt.Equals("Event"))
                            {
                                vl = "2u";
                            }
                            else if (mt.Equals("Cyclic"))
                            {
                                vl = "0u";
                            }
                            else if (mt.Equals("Combined"))
                            {
                                vl = "1u";
                            }
                        }
                        outputFile.Write("      " + rxMsg[0].ToUpper() + "_RX_METHOD" + " = " + vl);

                        for (int ind = 1; ind < rxMsg.Count; ind++)
                        {
                            vl = "(0u)";
                            if (messagesRxMethod.ContainsKey(rxMsg[ind]))
                            {
                                String mt = messagesRxMethod[rxMsg[ind]];
                                if (mt.Equals("Event"))
                                {
                                    vl = "2u";
                                }
                                else if (mt.Equals("Cyclic"))
                                {
                                    vl = "0u";
                                }
                                else if (mt.Equals("Combined"))
                                {
                                    vl = "1u";
                                }
                            }
                            outputFile.Write(",");
                            outputFile.WriteLine();
                            outputFile.Write("      " + rxMsg[ind].ToUpper() + "_RX_METHOD" + " = " + vl);

                        }
                    }

                }
                outputFile.WriteLine();
                outputFile.WriteLine("}Rx_Msg_Method;");
                outputFile.WriteLine();
                outputFile.WriteLine();
                outputFile.WriteLine("extern uint8_t Init_data_value[CANMGR_MAX_NO_OF_TX_MSGS][8];");
                outputFile.WriteLine();

                outputFile.WriteLine("");
                outputFile.WriteLine("typedef struct");
                outputFile.WriteLine("{");
                outputFile.WriteLine("   uint8_t  frame_type;");
                outputFile.WriteLine("  uint16_t period;");
                outputFile.WriteLine("  uint8_t  length;");
                outputFile.WriteLine("  uint16_t counter;");
                outputFile.WriteLine("}CanMgr_TxInfoTable_t;");
                outputFile.WriteLine("");

                outputFile.WriteLine("typedef uint8_t(*CanMgr_Read)(void* data);");
                outputFile.WriteLine("");

                outputFile.WriteLine("");
                outputFile.WriteLine("typedef struct ");
                outputFile.WriteLine("{");
                outputFile.WriteLine("   uint8_t Message_Index;");
                outputFile.WriteLine("  CanMgr_Read Message_funcptr;");
                outputFile.WriteLine("}Rx_Dispatcher_t;");

                outputFile.WriteLine("");
                outputFile.WriteLine("typedef void (*Rx_SignalIndication)(void);");
                outputFile.WriteLine("");
                outputFile.WriteLine("typedef struct");
                outputFile.WriteLine("{");
                outputFile.WriteLine("  Rx_SignalIndication Rx_SignalIndication_cbkFuncPtr; ");
                outputFile.WriteLine("}Rx_SignalIndication_t;");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("typedef struct ");
                outputFile.WriteLine("{");
                outputFile.WriteLine("  uint8_t  Message_Index;");
                outputFile.WriteLine("  Rx_SignalIndication RxSignal_ReceptionTimeout_cbkFuncPtr;");
                outputFile.WriteLine("  }ReceptionTimeout_t;");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("extern ReceptionTimeout_t Rx_ReceptionTimeoutCbk_Table[MAX_RX_SIGNALS];");
                outputFile.WriteLine("extern Rx_SignalIndication_t RxCbk_SignalIndication_Table[MAX_RX_SIGNALS];");
                outputFile.WriteLine("extern Rx_Dispatcher_t Rx_Dispatcher[MAX_RX_SIGNALS];");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("");

                outputFile.WriteLine("typedef struct");
                outputFile.WriteLine("{");
                outputFile.WriteLine("   uint8_t frame_type;");
                outputFile.WriteLine("   uint8_t length;");
                outputFile.WriteLine("  uint16_t timeout;");
                outputFile.WriteLine("  uint16_t timeout_counter;");
                outputFile.WriteLine("}CanMgr_RxInfoTable_t;");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("extern CanMgr_TxInfoTable_t CanMgr_TxInfoTable[CANMGR_MAX_NO_OF_TX_MSGS];");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("extern CanMgr_RxInfoTable_t CanMgr_RxInfoTable[CANMGR_MAX_NO_OF_RX_MSGS];");
                outputFile.WriteLine("");
                outputFile.WriteLine("void CanMgr_cfgInit(void);");
                outputFile.WriteLine("");

                outputFile.WriteLine("");
                outputFile.WriteLine("/*The following functions shall be used by the application to write the signal which are to be transmitted*/");
                if (txMsg != null && txMsg.Count > 0)
                {
                    foreach (String msg in txMsg)
                    {
                        if(messagesTxSignal.ContainsKey(msg))
                        { 
                         List<String> txSignals =  messagesTxSignal[msg];
                        if (txSignals != null && txSignals.Count > 0)
                        {

                            foreach (String sig in txSignals)
                            {
                                outputFile.WriteLine("uint8_t CanMgr_Write_" + SplitCamelCase(sig) + "(double data);");
                            }
                            outputFile.WriteLine("");
                            outputFile.WriteLine("");
                            foreach (String sig in txSignals)
                            {
                                outputFile.WriteLine("uint8_t CanMgr_" + SplitCamelCase(sig) + "_cbk(void);");
                            }

                            outputFile.WriteLine("");
                            outputFile.WriteLine("");
                            outputFile.WriteLine("/*The following functions shall be used by the application to read the received signal*/");
                            foreach (String sig in txSignals)
                            {
                                outputFile.WriteLine("uint8_t CanMgr_Read_" + sig + "(uint8_t* data);");
                            }



                        }
                    }
                }

                }
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("#endif /* CANMGR_CFG_H_ */");







            }

        }
        private void GenerateBtnCanIf_Click(object sender, RoutedEventArgs e)
        {
            String Message = "Output Files Generated and Saved Successfully at following path : " + DockingManagerModelHelper.TargetOutputFolderPath;
            geneRateCanIfC();
            geneRateCanIfHeader();
            
            MessageBox.Show(Message);

        }
        private void geneRateCanIfHeader()
        {
            using (StreamWriter outputFile = new StreamWriter(Path.Combine(DockingManagerModelHelper.TargetOutputFolderPath, "CanIF_cfg.h")))
            {

                outputFile.WriteLine("#ifndef CANIF_CFG_H");
                outputFile.WriteLine("#define CANIF_CFG_H");
                outputFile.WriteLine("/*********************************************************************************************************************** ");
                outputFile.WriteLine("  *    DISCLAIMER                                                                                                        ");
                outputFile.WriteLine("  *   Copyright (C) 2011, 2016 Niyata Infotech Ptv. Ltd. All rights reserved.                                              ");
                outputFile.WriteLine("  ***********************************************************************************************************************/");
                outputFile.WriteLine("");
                outputFile.WriteLine("/***********************************************************************************************************************");
                outputFile.WriteLine("  * @author              Author : Akshay Bavalatti (akshayb@niyatainfotech.com)                                                                         ");
                outputFile.WriteLine("***********************************************************************************************************************/");
                outputFile.WriteLine("/***********************************************************************************************************************");
                outputFile.WriteLine("  *                                                F I L E  D E S C R I P T I O N                                           ");
                outputFile.WriteLine("  *---------------------------------------------------------------------------------------------------------------------");
                outputFile.WriteLine("*  @brief                                                                                                             ");
                outputFile.WriteLine(" * ");
                outputFile.WriteLine("*  File name                       : CanIF_cfg.h                                                                         ");
                outputFile.WriteLine("*  Version                         : V1.0.0      ");
                outputFile.WriteLine("*  Micros supported                : Micro Agnostic (Independant)     ");
                outputFile.WriteLine("*  Compilers supported             : XXXX                                                                           ");
                outputFile.WriteLine("*  Platforms supported             : XXXX                                                                            ");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************/");
                outputFile.WriteLine("#ifdef __cplusplus");
                outputFile.WriteLine("extern \"C\" {");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************/");
                outputFile.WriteLine("/* ====================================================================================================================");
                outputFile.WriteLine("*                          I N C L U D E   F I L E S");
                outputFile.WriteLine("* ===================================================================================================================*/");
                outputFile.WriteLine("");
                outputFile.WriteLine("#include \"CanIF_Types.h\"");
                outputFile.WriteLine("#include \"CanIF_cbk.h\"");
                outputFile.WriteLine("/* ====================================================================================================================");
                outputFile.WriteLine(" *                          C O N F I G U R A T I O N");
                outputFile.WriteLine("* ===================================================================================================================*/");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define NOT_AUTOSAR_IMPLEMENTATION");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_BASIC_CAN");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_TOTAL_TX_BUFFER_MESSAGE    "+ buffertx);
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_TOTAL_NUM_OF_MAILBOX_CONIGURED_TO_STORE_TX_BUFFERS "+mailBoxMessageMore.Count);
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_TOTAL_RX_PDU                    " + messagesRxFrameIdsCanIf.Count); ;
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_TOTAL_TX_MESSAGES          "+messagesTxFrameIdsCanIf.Count);
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_TOTAL_RX_INIDICATION_FUNC   5");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_TOTAL_NUM_OF_MAIL_BOX           "+mailBoxCanif.Count);
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_CFG_RX_MAXVALIDRXDLC       "+ lstMailConfigParentsMailBox.Count);
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_CFG_MAX_MAILBOXES          "+lstMailConfigParentsMailBox.Count);
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_CFG_MAX_TXPDUS  CANIF_TOTAL_TX_MESSAGES");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_CFG_MAX_RXPDUS            CANIF_TOTAL_RX_PDU");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_CFG_MAX_RXINDICATIONS     CANIF_TOTAL_RX_INIDICATION_FUNC");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_CFG_MAX_CONTROLLER          1");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_TOTAL_TX_CONFIRMATION_FUNC_LIST 5");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_STATE_MACHINE_ERROR_COUNTER_LIMIT  5");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_STATE_MACHINE_TIMEOUT_LIMIT        5");
                outputFile.WriteLine("");
                outputFile.WriteLine("#define CANIF_WAIT_FOR_SLEEP_TIMEOUT    3");
                outputFile.WriteLine("");
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("typedef union CanIf_TxQueueUTag");
                outputFile.WriteLine("{  /* PRQA S 0750 */  /* MD_CSL_18.4 */");
                outputFile.WriteLine("  CanIf_TxPrioByCanIdByteQueueType raw[CANIF_TOTAL_TX_BUFFER_MESSAGE];");
                outputFile.WriteLine("} CanIf_TxQueueUType;");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("");
                outputFile.WriteLine("typedef union CanIf_CtrlStatesUTag");
                outputFile.WriteLine("{");
                outputFile.WriteLine("  CanIf_CtrlStatesType raw[CANIF_CFG_MAX_CONTROLLER];");
                outputFile.WriteLine("} CanIf_CtrlStatesUType;");
                outputFile.WriteLine("");
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**   \\brief  type to access CanIf_TxBufferPrioByCanIdBase in an index and symbol based style. */");
                outputFile.WriteLine("typedef union CanIf_TxBufferPrioByCanIdBaseUTag");
                outputFile.WriteLine("{  /* PRQA S 0750 */  /* MD_CSL_18.4 */");
                outputFile.WriteLine("  CanIf_TxBufferPrioByCanIdBaseType raw[CANIF_TOTAL_NUM_OF_MAILBOX_CONIGURED_TO_STORE_TX_BUFFERS];");
                outputFile.WriteLine("} CanIf_TxBufferPrioByCanIdBaseUType;");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_BusOffNotificationFctPtr");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**");
                outputFile.WriteLine(" * ");
                outputFile.WriteLine(" */ ");
                outputFile.WriteLine("extern const CanIf_BusOffNotificationFctType CanIf_BusOffNotificationFctPtr;");
                outputFile.WriteLine(""); 
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_CanIfCtrlId2MappedTxBuffersConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \\var    CanIf_CanIfCtrlId2MappedTxBuffersConfig");
                outputFile.WriteLine(" \\brief  CAN controller configuration - mapped Tx-buffer(s).");
                outputFile.WriteLine(" \\details");
                outputFile.WriteLine("Element                          Description");
                outputFile.WriteLine("MappedTxBuffersConfigEndIdx      the end index of the 1:n relation pointing to CanIf_MappedTxBuffersConfig");
                outputFile.WriteLine("MappedTxBuffersConfigStartIdx    the start index of the 1:n relation pointing to CanIf_MappedTxBuffersConfig");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const CanIf_CanIfCtrlId2MappedTxBuffersConfigType CanIf_CanIfCtrlId2MappedTxBuffersConfig[CANIF_CFG_MAX_CONTROLLER];");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_CtrlModeIndicationFctPtr");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine(""); 
outputFile.WriteLine("extern const CanIf_CtrlModeIndicationFctType CanIf_CtrlModeIndicationFctPtr;");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_MailBoxConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_MailBoxConfig");
                outputFile.WriteLine(" \\brief  Mailbox table.");
                outputFile.WriteLine("\\details");
                outputFile.WriteLine("Element                 Description");
                outputFile.WriteLine("CtrlStatesIdx           the index of the 1:1 relation pointing to CanIf_CtrlStates");
                outputFile.WriteLine("PduIdFirst              \"First\" PDU mapped to mailbox.");
                outputFile.WriteLine("PduIdLast               \"Last\" PDU mapped to mailbox.");
                outputFile.WriteLine("TxBufferCfgIdx          the index of the 0:1 relation pointing to CanIf_TxBufferPrioByCanIdByteQueueConfig");
                outputFile.WriteLine("TxBufferHandlingType");
                outputFile.WriteLine("MailBoxType             Type of mailbox: Rx-/Tx- BasicCAN/FullCAN/unused.");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const CanIf_MailBoxConfigType CanIf_MailBoxConfig[CANIF_TOTAL_NUM_OF_MAIL_BOX];");
                outputFile.WriteLine(""); 
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_MappedTxBuffersConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_MappedTxBuffersConfig");
                outputFile.WriteLine("\\brief  Mapped Tx-buffer(s)");
                outputFile.WriteLine("\\details");
                outputFile.WriteLine("Element             Description");
                outputFile.WriteLine("MailBoxConfigIdx    the index of the 1:1 relation pointing to CanIf_MailBoxConfig");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const CanIf_MappedTxBuffersConfigType CanIf_MappedTxBuffersConfig[CANIF_TOTAL_NUM_OF_MAILBOX_CONIGURED_TO_STORE_TX_BUFFERS];");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_RxIndicationFctList");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_RxIndicationFctList");
                outputFile.WriteLine(" \\brief  Rx indication functions table.");
                outputFile.WriteLine("\\details");
                outputFile.WriteLine("Element               Description");
                outputFile.WriteLine("RxIndicationFct       Rx indication function.");
                outputFile.WriteLine("RxIndicationLayout    Layout of Rx indication function.");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("extern const CanIf_RxIndicationFctListType CanIf_RxIndicationFctList[CANIF_TOTAL_RX_INIDICATION_FUNC];");
                outputFile.WriteLine(""); 
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_RxPduConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \var    CanIf_RxPduConfig");
                outputFile.WriteLine(" \brief  Rx-PDU configuration table.");
                outputFile.WriteLine(" \\details");
                outputFile.WriteLine(" Element                   Description");
                outputFile.WriteLine(" RxPduCanId                Rx-PDU: CAN identifier.");
                outputFile.WriteLine(" RxPduMask                 Rx-PDU: CAN identifier mask.");
                outputFile.WriteLine(" UpperPduId                PDU ID defined by upper layer.");
                outputFile.WriteLine("Dlc                       Data length code.");
                outputFile.WriteLine(" RxIndicationFctListIdx    the index of the 1:1 relation pointing to CanIf_RxIndicationFctList");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const CanIf_RxPduConfigType CanIf_RxPduConfig[CANIF_TOTAL_RX_PDU];");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_TrcvModeIndicationFctPtr");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("#if 0");
                outputFile.WriteLine("extern const CanIf_TrcvModeIndicationFctType CanIf_TrcvModeIndicationFctPtr;");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_TrcvToCtrlMap");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \\var    CanIf_TrcvToCtrlMap");
                outputFile.WriteLine("\\brief  Indirection table: logical transceiver index to CAN controller index.");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const uint8_t CanIf_TrcvToCtrlMap[CANIF_CFG_MAX_CONTROLLER];");
                outputFile.WriteLine(""); 
outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxBufferPrioByCanIdByteQueueConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \var    CanIf_TxBufferPrioByCanIdByteQueueConfig");
                outputFile.WriteLine(" \brief  Tx-buffer: PRIO_BY_CANID as BYTE_QUEUE");
                outputFile.WriteLine(" \\details");
                outputFile.WriteLine(" Element      Description");
                outputFile.WriteLine("TxBufferPrioByCanIdBaseIdx                          the index of the 1:1 relation pointing to CanIf_TxBufferPrioByCanIdBase");
                outputFile.WriteLine("TxBufferPrioByCanIdByteQueueMappedTxPdusEndIdx      the end index of the 1:n relation pointing to CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine(" TxBufferPrioByCanIdByteQueueMappedTxPdusLength      the number of relations pointing to CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("TxBufferPrioByCanIdByteQueueMappedTxPdusStartIdx    the start index of the 1:n relation pointing to CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("");
                outputFile.WriteLine("extern const CanIf_TxBufferPrioByCanIdByteQueueConfigType CanIf_TxBufferPrioByCanIdByteQueueConfig[CANIF_TOTAL_NUM_OF_MAILBOX_CONIGURED_TO_STORE_TX_BUFFERS];");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \\var    CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("\\brief  Tx-buffer: PRIO_BY_CANID as BYTE_QUEUE: Mapped Tx-PDUs");
                outputFile.WriteLine(" \\details");
                outputFile.WriteLine(" Element           Description");
                outputFile.WriteLine("TxPduConfigIdx    the index of the 1:1 relation pointing to CanIf_TxPduConfig");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("");
                outputFile.WriteLine("extern const CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdusType CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus[CANIF_TOTAL_TX_BUFFER_MESSAGE];");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_TxConfirmationFctList");
                outputFile.WriteLine("**********************************************************************************************************************/");
               outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxConfirmationFctList");


                outputFile.WriteLine(" \\brief  Tx confirmation functions table.");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const CanIf_TxConfirmationFctType CanIf_TxConfirmationFctList[CANIF_TOTAL_TX_CONFIRMATION_FUNC_LIST];");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");


                outputFile.WriteLine(" CanIf_TxPduConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");


                outputFile.WriteLine(" \\var    CanIf_TxPduConfig");


                outputFile.WriteLine(" \\brief  Tx-PDUs - configuration.");


                outputFile.WriteLine(" \\details");
               
                outputFile.WriteLine(" Element                     Description");
                outputFile.WriteLine("CanId                       CAN identifier (16bit / 32bit).");
                outputFile.WriteLine("UpperLayerTxPduId           Upper layer handle ID (8bit / 16bit).");
                outputFile.WriteLine("CtrlStatesIdx               the index of the 1:1 relation pointing to CanIf_CtrlStates");
                outputFile.WriteLine("Dlc                         Data length code.");
                outputFile.WriteLine("MailBoxConfigIdx            the index of the 1:1 relation pointing to CanIf_MailBoxConfig");
                outputFile.WriteLine("TxConfirmationFctListIdx    the index of the 1:1 relation pointing to CanIf_TxConfirmationFctList");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const CanIf_TxPduConfigType CanIf_TxPduConfig[CANIF_TOTAL_TX_MESSAGES];");
                outputFile.WriteLine(""); 
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_TxPduQueueIndex");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \\var    CanIf_TxPduQueueIndex");
                outputFile.WriteLine(" \\brief  Indirection table: Tx-PDU handle ID to corresponding Tx buffer handle ID. NOTE: Only BasicCAN Tx-PDUs have a valid indirection into the Tx buffer.");
                outputFile.WriteLine(" \\details");
                outputFile.WriteLine(" Element       Description");
                outputFile.WriteLine("TxQueueIdx    the index of the 0:1 relation pointing to CanIf_TxQueue");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern const CanIf_TxPduQueueIndexType CanIf_TxPduQueueIndex[CANIF_TOTAL_TX_MESSAGES];");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_CtrlStates");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \\var    CanIf_CtrlStates");
                outputFile.WriteLine(" \\details");
                outputFile.WriteLine(" Element     Description");
                outputFile.WriteLine("CtrlMode    Controller mode.");
                outputFile.WriteLine("PduMode     PDU mode state.");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("extern CanIf_CtrlStatesUType CanIf_CtrlStates;");
                outputFile.WriteLine("");
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine(" CanIf_TxBufferPrioByCanIdBase");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxBufferPrioByCanIdBase");
                outputFile.WriteLine(" \\brief  Variable declaration - Tx-buffer: PRIO_BY_CANID as byte/bit-queue. Stores at least the QueueCounter.");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("extern CanIf_TxBufferPrioByCanIdBaseUType CanIf_TxBufferPrioByCanIdBase;");
                outputFile.WriteLine(""); 
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxQueue");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine(" \\var    CanIf_TxQueue");
                outputFile.WriteLine(" \\brief  Variable declaration - Tx byte queue.");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("extern CanIf_TxQueueUType CanIf_TxQueue;");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("");
                outputFile.WriteLine("");

            }
        }

        private void geneRateCanIfC()
        {
            using (StreamWriter outputFile = new StreamWriter(Path.Combine(DockingManagerModelHelper.TargetOutputFolderPath, "CanIF_cfg.c")))
            {

                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("CanIf_MailBoxConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("\\var    CanIf_MailBoxConfig");
                outputFile.WriteLine("\\brief  Mailbox table.");
                outputFile.WriteLine("\\details");
                outputFile.WriteLine(" Element                 Description");
                outputFile.WriteLine(" CtrlStatesIdx           the index of the 1:1 relation pointing to CanIf_CtrlStates");
                outputFile.WriteLine("PduIdFirst              \"First\" PDU mapped to mailbox.");
                outputFile.WriteLine(" PduIdLast               \"Last\" PDU mapped to mailbox.");
                outputFile.WriteLine("TxBufferCfgIdx          the index of the 0:1 relation pointing to CanIf_TxBufferPrioByCanIdByteQueueConfig");
                outputFile.WriteLine("TxBufferHandlingType");
                outputFile.WriteLine("MailBoxType             Type of mailbox: Rx-/Tx- BasicCAN/FullCAN/unused.");
                outputFile.WriteLine("*/ ");
                int canBasicTx = -1;
                outputFile.WriteLine("const CanIf_MailBoxConfigType CanIf_MailBoxConfig[CANIF_TOTAL_NUM_OF_MAIL_BOX] = {");
                outputFile.WriteLine("   /* Index    CtrlStatesIdx            PduIdFirst                           PduIdLast                     TxBufferCfgIdx                             TxBufferHandlingType                     MailBoxType      */         ");
                outputFile.Write("  {      0           0UL  ,         0U  /* Unused, TxPduId 2 */ ,        0U  /* Unused, TxPduId 2 */ , "+(mailBoxCanif.ContainsKey(lstMailConfigParentsMailBox[0])&& mailBoxCanif[lstMailConfigParentsMailBox[0]].Equals("CANIF_TxBasicCANMailbox")?(++canBasicTx+ "U,CANIF_TXBUFFER_HANDLINGTYPE_PRIOBYCANID, CANIF_TxBasicCANMailbox }" ) : "CANIF_NO_TXBUFFERCFGIDXOFMAILBOXCONFIG, CANIF_TXBUFFER_HANDLINGTYPE_NONE, "+ (mailBoxCanif.ContainsKey(lstMailConfigParentsMailBox[0])? mailBoxCanif[lstMailConfigParentsMailBox[0]]: "CANIF_RxBasicCANMailbox"))+"}");
                for(int index=1;index< lstMailConfigParentsMailBox.Count;index++)
                {
                    outputFile.WriteLine(",");
                    outputFile.Write("  {      "+index+"           0UL  ,         0U  /* Unused, TxPduId 2 */ ,        0U  /* Unused, TxPduId 2 */ , " + (mailBoxCanif.ContainsKey(lstMailConfigParentsMailBox[index]) && mailBoxCanif[lstMailConfigParentsMailBox[index]].Equals("CANIF_TxBasicCANMailbox") ? (++canBasicTx+"UL" + ",CANIF_TXBUFFER_HANDLINGTYPE_PRIOBYCANID, CANIF_TxBasicCANMailbox }") : "CANIF_NO_TXBUFFERCFGIDXOFMAILBOXCONFIG, CANIF_TXBUFFER_HANDLINGTYPE_NONE, " + (mailBoxCanif.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxCanif[lstMailConfigParentsMailBox[index]] : "CANIF_UnusedCANMailbox"))+"}");
                }
                outputFile.WriteLine("");
                outputFile.WriteLine("};");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("CanIf_MappedTxBuffersConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_MappedTxBuffersConfig");
                outputFile.WriteLine("  \\brief  Mapped Tx-buffer(s)");
                outputFile.WriteLine("  \\details");
                outputFile.WriteLine("  Element             Description");
                outputFile.WriteLine("  MailBoxConfigIdx    the index of the 1:1 relation pointing to CanIf_MailBoxConfig");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("const CanIf_MappedTxBuffersConfigType CanIf_MappedTxBuffersConfig[CANIF_TOTAL_NUM_OF_MAILBOX_CONIGURED_TO_STORE_TX_BUFFERS] = {");
                outputFile.WriteLine("      /* Index    MailBoxConfigIdx */     ");
                int lindex = 0;
                if (lstMailConfigParentsMailBox != null&&lstMailConfigParentsMailBox.Count>0)
                {
                    if (mailBoxCanif.ContainsKey(lstMailConfigParentsMailBox[0]))
                    {
                        string value = mailBoxCanif[lstMailConfigParentsMailBox[0]];
                        if (value != null && !value.Trim().Equals("") && value.Trim().Equals("CANIF_TxBasicCANMailbox"))
                        {
                           
                                outputFile.Write(" {     " + lindex + "," + (0) + "UL" + "   }");
                           
                        }

                    }
                    for (int index = 1; index < lstMailConfigParentsMailBox.Count; index++)
                    {
                        if (mailBoxCanif.ContainsKey(lstMailConfigParentsMailBox[index]))
                        {
                            string value = mailBoxCanif[lstMailConfigParentsMailBox[index]];
                            if (value != null && !value.Trim().Equals("") && value.Trim().Equals("CANIF_TxBasicCANMailbox"))
                            {
                                lindex++;
                                if (index != lstMailConfigParentsMailBox.Count - 1)
                                {
                                    outputFile.Write(",");
                                    outputFile.WriteLine("");
                                    outputFile.Write("  {    " + lindex + "," + (index) + "UL" + "   }");
                                }
                            }

                        }
                    }
                }
                outputFile.WriteLine("");
                outputFile.WriteLine("};");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_RxIndicationFctList");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_RxIndicationFctList");
                outputFile.WriteLine("  \\brief  Rx indication functions table.");
                outputFile.WriteLine("  \\details");
                outputFile.WriteLine("  Element               Description");
                outputFile.WriteLine("  RxIndicationFct       Rx indication function.");
                outputFile.WriteLine("  RxIndicationLayout    Layout of Rx indication function.");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("const CanIf_RxPduConfigType CanIf_RxPduConfig[CANIF_TOTAL_RX_PDU] = {");
                outputFile.WriteLine("         /* Index    RxPduCanId     RxPduMask     UpperPduId                                                                   Dlc                    RxIndicationFctListIdx     */           ");
                for(int index=0;index< lstMailConfigParentsMailBox.Count;index++)
                {
                    string canid = mailBoxFrameIdRx.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxFrameIdRx[lstMailConfigParentsMailBox[index]] : "0x0000";
                    string maskValue = mailBoxMaskValueRx.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxMaskValueRx[lstMailConfigParentsMailBox[index]] : "0x0000";
                    string dlc = mailBoxDLCRx.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxDLCRx[lstMailConfigParentsMailBox[index]]+"U" : "0U";
                    string mailboxnumber = "" + lstMailConfigParentsMailBox[index];
                    string upperPduId =  mailBoxMessageRx.ContainsKey(lstMailConfigParentsMailBox[index]) ? "CANMGR_" + mailBoxMessageRx[lstMailConfigParentsMailBox[index]] : "CANMGR_0x0000";
                   
                    if (index ==0)
                    {
                        outputFile.WriteLine("{      "+index+",    "+canid+" ,  "+maskValue+"     , "+ upperPduId + "                                                                         ,  "+dlc+",                    "+ mailboxnumber + "UL  /* PduR_CanIfRxIndication */  }, ");
                    }
                    else
                    {
                        outputFile.WriteLine("{      " + index + ",    " + canid + " ,  " + maskValue + "     , " + upperPduId + "                                                                         ,  " + dlc + ",                    " + mailboxnumber + "UL  /* PduR_CanIfRxIndication */  }");
                    }
                }
                outputFile.WriteLine("};");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TrcvModeIndicationFctPtr");
                outputFile.WriteLine("#if 0");
                outputFile.WriteLine("const CanIf_TrcvModeIndicationFctType CanIf_TrcvModeIndicationFctPtr = NULL;");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TrcvToCtrlMap");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TrcvToCtrlMap");
                outputFile.WriteLine("  \\brief  Indirection table: logical transceiver index to CAN controller index.");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("const uint8_t CanIf_TrcvToCtrlMap[CANIF_CFG_MAX_CONTROLLER] = {");
                outputFile.WriteLine("  /* Index     TrcvToCtrlMap ");
                outputFile.WriteLine("  /*     0 */             0U  /* CAN controller handle ID (upper) */");
                outputFile.WriteLine("};");
                outputFile.WriteLine("");
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("   CanIf_TxBufferPrioByCanIdByteQueueConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxBufferPrioByCanIdByteQueueConfig");
                outputFile.WriteLine("  \\brief  Tx-buffer: PRIO_BY_CANID as BYTE_QUEUE");
                outputFile.WriteLine("  \\details");
                outputFile.WriteLine("  Element                                             Description");
                outputFile.WriteLine("  TxBufferPrioByCanIdBaseIdx                          the index of the 1:1 relation pointing to CanIf_TxBufferPrioByCanIdBase");
                outputFile.WriteLine("  TxBufferPrioByCanIdByteQueueMappedTxPdusEndIdx      the end index of the 1:n relation pointing to CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("  TxBufferPrioByCanIdByteQueueMappedTxPdusLength      the number of relations pointing to CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("  TxBufferPrioByCanIdByteQueueMappedTxPdusStartIdx    the start index of the 1:n relation pointing to CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("");
                outputFile.WriteLine("const CanIf_TxBufferPrioByCanIdByteQueueConfigType CanIf_TxBufferPrioByCanIdByteQueueConfig[CANIF_TOTAL_NUM_OF_MAILBOX_CONIGURED_TO_STORE_TX_BUFFERS] = {");
                outputFile.WriteLine("  /* Index    TxBufferPrioByCanIdBaseIdx       TxBufferPrioByCanIdByteQueueMappedTxPdusEndIdx    TxBufferPrioByCanIdByteQueueMappedTxPdusLength    TxBufferPrioByCanIdByteQueueMappedTxPdusStartIdx  */ ");
                int ind = 0;
                int txBsic = -1;
                if (mailBoxCanif != null && mailBoxCanif.Count > 0)
                {
                    int temp = 0;
                    foreach (KeyValuePair<string, string> kvp in mailBoxCanif)
                    {
                        if (kvp.Value.Equals("CANIF_TxBasicCANMailbox"))
                        {
                            int totlMsg = mailBoxMessageMore.ContainsKey(kvp.Key) ? mailBoxMessageMore.Count : 0;
                            if (ind == 0)
                            {
                                outputFile.Write("      {     " + ind + ",                        " + (++txBsic) + "UL,     " + ((temp)+(totlMsg + 1)) + "UL, "+ (totlMsg + 1) + "UL, "+(temp)+"UL   }  ");
                            }
                            else
                            {
                                outputFile.Write(",");
                                outputFile.WriteLine();
                                outputFile.Write("      {     " + ind + ",                        " + (++txBsic) + "UL,     " + ((temp) + (totlMsg + 1)) + "UL, " + (totlMsg + 1) + "UL, " + (temp) + "UL   }  ");
                            }
                                ind++;
                            temp = temp + (totlMsg + 1);
                        }
                    }
                }
                outputFile.WriteLine();
                outputFile.WriteLine("};");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus");
                outputFile.WriteLine("  \\brief  Tx-buffer: PRIO_BY_CANID as BYTE_QUEUE: Mapped Tx-PDUs");
                outputFile.WriteLine("  \\details");
                outputFile.WriteLine("  Element           Description");
                outputFile.WriteLine("  TxPduConfigIdx    the index of the 1:1 relation pointing to CanIf_TxPduConfig");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("");
                outputFile.WriteLine("const CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdusType CanIf_TxBufferPrioByCanIdByteQueueMappedTxPdus[CANIF_TOTAL_TX_BUFFER_MESSAGE] = {");
                outputFile.WriteLine("  /* Index    TxPduConfigIdx */");
               
                if (mailBoxMessageMore != null && mailBoxMessageMore.Count > 0)
                {
                    int ind2 = 0;
                    foreach (KeyValuePair<string, string> kvp in mailBoxCanif)
                    {
                        if (kvp.Value.Equals("CANIF_TxBasicCANMailbox"))
                        {
                            buffertx++;
                            if (ind2==0)
                            {
                                outputFile.Write("      {     " + lstMailConfigParentsMailBox.IndexOf(kvp.Key) + ",                        " + 0 + "UL}  ");
                            }
                            else
                            {
                                outputFile.Write(",");
                                outputFile.WriteLine();
                                outputFile.Write("      {     " + lstMailConfigParentsMailBox.IndexOf(kvp.Key) + ",                        " + 0 + "UL} ");
                            }
                            outputFile.WriteLine();
                            if(mailBoxMessageMore.ContainsKey(kvp.Key))
                            {
                                List<String> lst = mailBoxMessageMore[kvp.Key];
                                if(lst!=null)
                                {
                                    for (int inx = 0; inx < lst.Count;inx++)
                                    {
                                        outputFile.Write(",");
                                        outputFile.WriteLine();
                                        outputFile.Write("      {     " + lstMailConfigParentsMailBox.IndexOf(kvp.Key) + ",                        " + (inx+1) + "UL},  ");
                                    }

                                }

                            }

                                ind2++;
                        }
                    }
                }
                outputFile.WriteLine("");
                outputFile.WriteLine("};");
                outputFile.WriteLine("");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxConfirmationFctList");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxConfirmationFctList");
                outputFile.WriteLine("  \\brief  Tx confirmation functions table.");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("const CanIf_TxConfirmationFctType CanIf_TxConfirmationFctList[CANIF_TOTAL_TX_CONFIRMATION_FUNC_LIST] = {");
                outputFile.WriteLine("  /* Index     TxConfirmationFctList  ");
                outputFile.WriteLine("  /*     0 */ (CanIf_TxConfirmationFctType)NULL_PTR ,  /* [NULL_PTR] */");
                outputFile.WriteLine("  /*     1 */ NULL_PTR             ,  /* [Appl_CanNm_TxConfirmation] */");
                outputFile.WriteLine("  /*     2 */ NULL_PTR                  ,  /* [CanTp_TxConfirmation] */");
                outputFile.WriteLine("  /*     3 */ NULL_PTR              ,  /* [PduR_CanIfTxConfirmation] */");
                outputFile.WriteLine("  /*     4 */ NULL_PTR                  /* [Xcp_CanIfTxConfirmation] */");
                outputFile.WriteLine("};");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxPduConfig");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxPduConfig");
                outputFile.WriteLine("  \\brief  Tx-PDUs - configuration.");
                outputFile.WriteLine("   \\details");
                outputFile.WriteLine("  Element                     Description");
                outputFile.WriteLine("  CanId                       CAN identifier (16bit / 32bit).");
                outputFile.WriteLine("  UpperLayerTxPduId           Upper layer handle ID (8bit / 16bit).");
                outputFile.WriteLine("   CtrlStatesIdx               the index of the 1:1 relation pointing to CanIf_CtrlStates");
                outputFile.WriteLine("  Dlc                         Data length code.");
                outputFile.WriteLine("  MailBoxConfigIdx            the index of the 1:1 relation pointing to CanIf_MailBoxConfig");
                outputFile.WriteLine("  TxConfirmationFctListIdx    the index of the 1:1 relation pointing to CanIf_TxConfirmationFctList");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("const CanIf_TxPduConfigType CanIf_TxPduConfig[CANIF_TOTAL_TX_MESSAGES] = {");
                outputFile.WriteLine("  /* Index    CanId    UpperLayerTxPduId                                                               CtrlStatesIdx     Dlc   MailBoxConfigIdx    TxConfirmationFctListIdx    */");
                for (int index = 0; index < lstMailConfigParentsMailBox.Count; index++)
                {
                    if(mailBoxCanif.ContainsKey(lstMailConfigParentsMailBox[index]))
                    {
                        if (mailBoxCanif[lstMailConfigParentsMailBox[index]].Equals("CANIF_TxBasicCANMailbox"))
                        {
                            string canid = mailBoxFrameId.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxFrameId[lstMailConfigParentsMailBox[index]] : "0x0000";
                            string maskValue = mailBoxMaskValue.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxMaskValue[lstMailConfigParentsMailBox[index]] : "0x0000";
                            string dlc = mailBoxDLC.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxDLC[lstMailConfigParentsMailBox[index]] + "U" : "0U";
                            string upperPduId = mailBoxMessage.ContainsKey(lstMailConfigParentsMailBox[index]) ? "CANMGR_" + mailBoxMessage[lstMailConfigParentsMailBox[index]] : "CANMGR_0x0000"; ;
                            String rxIndicationFctListIdx = "3";
                            if (index == 0)
                            {
                                outputFile.WriteLine("{      " + index + ",    " + canid + " ,  " + maskValue + "     , " + upperPduId + "                                                                         ,  " + dlc + ",                    " + rxIndicationFctListIdx + "UL  /* PduR_CanIfRxIndication */  } ");
                            }
                            else
                            {
                                outputFile.WriteLine(",{      " + index + ",    " + canid + " ,  " + maskValue + "     , " + upperPduId + "                                                                         ,  " + dlc + ",                    " + rxIndicationFctListIdx + "UL  /* PduR_CanIfRxIndication */  } ");
                            }
                            if (mailBoxMessageMore.ContainsKey(lstMailConfigParentsMailBox[index]))
                            {
                                List<String> lmsgs = mailBoxMessageMore[lstMailConfigParentsMailBox[index]];
                                List<String> lfid = mailBoxFrameIdMore.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxFrameIdMore[lstMailConfigParentsMailBox[index]] : null;
                                List<String> lmsvalue = mailBoxMaskValueMore.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxMaskValueMore[lstMailConfigParentsMailBox[index]] : null;
                                List<String> ldlc = mailBoxDLCMore.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxDLCMore[lstMailConfigParentsMailBox[index]] : null;
                                if (lmsgs != null)
                                {
                                    for (int lindx = 0; lindx < lmsgs.Count; lindx++)
                                    {
                                        canid = (lfid != null && lindx < lfid.Count) ? lfid[lindx] : "0x0000";
                                        maskValue = (lmsvalue != null && lindx < lmsvalue.Count) ? lmsvalue[lindx] : "0x0000";
                                        dlc = (ldlc != null && lindx < ldlc.Count) ? ldlc[lindx] : "0x0000";
                                        upperPduId = lmsgs[lindx];
                                        outputFile.WriteLine(",{      " + index + ",    " + canid + " ,  " + maskValue + "     , " + upperPduId + "                                                                         ,  " + dlc + ",                    " + rxIndicationFctListIdx + "UL  /* PduR_CanIfRxIndication */  } ");


                                    }
                                }


                            }
                        }
                    }
                 
                    

                }
                outputFile.WriteLine("");
                outputFile.WriteLine("};");
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxPduQueueIndex");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxPduQueueIndex");
                outputFile.WriteLine("  \\brief  Indirection table: Tx-PDU handle ID to corresponding Tx buffer handle ID. NOTE: Only BasicCAN Tx-PDUs have a valid indirection into the Tx buffer.");
                outputFile.WriteLine("  \\details");
                outputFile.WriteLine("  Element       Description");
                outputFile.WriteLine("  TxQueueIdx    the index of the 0:1 relation pointing to CanIf_TxQueue");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("const CanIf_TxPduQueueIndexType CanIf_TxPduQueueIndex[CANIF_TOTAL_TX_MESSAGES] = {");
                outputFile.WriteLine("  /* Index    TxQueueIdx                              */      ");
                for (int index = 0; index < lstMailConfigParentsMailBox.Count; index++)
                {
                    string canid = mailBoxFrameId.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxFrameId[lstMailConfigParentsMailBox[index]] : "0x0000";
                    string maskValue = mailBoxMaskValue.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxMaskValue[lstMailConfigParentsMailBox[index]] : "0x0000";
                    string dlc = mailBoxDLC.ContainsKey(lstMailConfigParentsMailBox[index]) ? mailBoxDLC[lstMailConfigParentsMailBox[index]] + "U" : "0U";
                    string mailboxnumber = "" + lstMailConfigParentsMailBox[index];
                    string upperPduId = mailBoxMessage.ContainsKey(lstMailConfigParentsMailBox[index]) ? "CANMGR_"+mailBoxMessage[lstMailConfigParentsMailBox[index]] : "CANMGR_0x0000";

                    if (index == 0)
                    {
                        outputFile.WriteLine("{      " + index + ",    " + canid + " ,  " + maskValue + "     , " + upperPduId + "                                                                         ,  " + dlc + ",                    " + mailboxnumber + "UL  /* PduR_CanIfRxIndication */  }, ");
                    }
                    else
                    {
                        outputFile.WriteLine("{      " + index + ",    " + canid + " ,  " + maskValue + "     , " + upperPduId + "                                                                         ,  " + dlc + ",                    " + mailboxnumber + "UL  /* PduR_CanIfRxIndication */  }");
                    }
                }
                outputFile.WriteLine("};");
                outputFile.WriteLine("");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_CtrlStates");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_CtrlStates");
                outputFile.WriteLine("  \\details");
                outputFile.WriteLine("  Element     Description");
                outputFile.WriteLine("  CtrlMode    Controller mode.");
                outputFile.WriteLine("  PduMode     PDU mode state.");
                outputFile.WriteLine("*/ ");
                outputFile.WriteLine("CanIf_CtrlStatesUType CanIf_CtrlStates;  ");
                outputFile.WriteLine("  /* Index        Referable Keys  */");
                outputFile.WriteLine("  /*     0 */  /* [/ActiveEcuC/CanIf/Can/CT_Hyundai_e738e4b7] */");
                outputFile.WriteLine("  /*     1 */  /* [/ActiveEcuC/CanIf/Can/CT_CAN00_e738e4b7] */");
                outputFile.WriteLine("#ifdef CANIF_BASIC_CAN");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxBufferPrioByCanIdBase");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxBufferPrioByCanIdBase");
                outputFile.WriteLine("  \\brief  Variable declaration - Tx-buffer: PRIO_BY_CANID as byte/bit-queue. Stores at least the QueueCounter.");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("");
                outputFile.WriteLine("CanIf_TxBufferPrioByCanIdBaseUType CanIf_TxBufferPrioByCanIdBase;  /* PRQA S 0759 */  /* MD_CSL_18.4 */");
                outputFile.WriteLine("  /* Index        Referable Keys  */");
                outputFile.WriteLine("  /*     0 */  /* [/ActiveEcuC/CanIf/CanIfInitCfg/CanIfBufferCfg_CLU11] */");
                outputFile.WriteLine("  /*     1 */  /* [/ActiveEcuC/CanIf/CanIfInitCfg/CanIfBufferCfg_NM_CLU] */");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("  CanIf_TxQueue");
                outputFile.WriteLine("**********************************************************************************************************************/");
                outputFile.WriteLine("/** ");
                outputFile.WriteLine("  \\var    CanIf_TxQueue");
                outputFile.WriteLine("  \\brief  Variable declaration - Tx byte queue.");
                outputFile.WriteLine("*/");
                outputFile.WriteLine("CanIf_TxQueueUType CanIf_TxQueue;  /* PRQA S 0759 */  /* MD_CSL_18.4 */");
                outputFile.WriteLine("  /* Index        Referable Keys  */");
                outputFile.WriteLine("  /*     0 */  /* [/ActiveEcuC/CanIf/CanIfInitCfg/CLU11_oHyundai_Tx_3abd61be] */");
                outputFile.WriteLine("  /*     1 */  /* [/ActiveEcuC/CanIf/CanIfInitCfg/NM_CLU_oCAN00_Tx_3abd61be] */");
                outputFile.WriteLine("");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("");
                outputFile.WriteLine("#endif");
                outputFile.WriteLine("");
                outputFile.WriteLine("/**********************************************************************************************************************");
                outputFile.WriteLine("                                          R E V I S I O N   H I S T O R Y                                        ");
                outputFile.WriteLine("***********************************************************************************************************************");
                outputFile.WriteLine("***********************************************************************************************************************");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("");
                outputFile.WriteLine("***********************************************************************************************************************/");
                outputFile.WriteLine("");


            }
        }

        private void GenerateBtn_Click(object sender, RoutedEventArgs e)
        {
            bool isCantoolsConfigGenerated = false;
            bool isConfigGenerated = false;
            string Message = string.Empty;
            if (!File.Exists(DockingManagerModelHelper.TargetInputFolderPath + "\\CAN_Driver_cfg.h"))
            {
                isConfigGenerated = false;
                //MessageBox.Show("Please Upload Corresponding Config.h file for the uploaded ARXML file at following location..." + DockingManagerModelHelper.TargetInputFolderPath);
            }
            else
            {
                GetUpdatedValuesForConfigGeneration();
                DockingManagerModelHelper.UpdateARXML();
                DockingManagerModelHelper.GenerateConfigFile();
                isConfigGenerated = true;
            }
            if (File.Exists(DockingManagerModelHelper.TargetInputFolderPath + "\\Sample_DB.dbc"))
            {
                DockingManagerModelHelper.GenerateCantoolsConfigurations();
                isCantoolsConfigGenerated = true;
            }
            else
            {
                isCantoolsConfigGenerated = false;
                //MessageBox.Show("Please Upload .DBC file to Generate Cantools Config Files at following location..." + DockingManagerModelHelper.TargetInputFolderPath);
            }

            if (isCantoolsConfigGenerated && isConfigGenerated)
            {
                Message = "Output Files Generated and Saved Successfully at following path : " + DockingManagerModelHelper.TargetOutputFolderPath;
            }
            else if (isConfigGenerated && !isCantoolsConfigGenerated)
            {
                Message = "1) Config File Generated Successfully at Following Location..." + DockingManagerModelHelper.TargetInputFolderPath + Environment.NewLine + Environment.NewLine
                    + "2) Cantools Confing Could not be Generated, Please Upload .DBC file to Generate Cantools Config Files at following location..." + DockingManagerModelHelper.TargetInputFolderPath;
            }
            else if (!isConfigGenerated && isCantoolsConfigGenerated)
            {
                Message = "1) Config file Could not be generated, Please upload corresponding config.h file for the uploaded ARXML file at following location..." + DockingManagerModelHelper.TargetInputFolderPath + Environment.NewLine + Environment.NewLine
                   + "2) Cantools confing files generated at following location..." + DockingManagerModelHelper.TargetInputFolderPath;
            }
            else if (!isConfigGenerated && !isCantoolsConfigGenerated)
            {
                Message = "Output files not generated... Please check and upload corresponding Config.H and .DBC Files at following location..." + DockingManagerModelHelper.TargetInputFolderPath;
            }
            MessageBox.Show(Message);
        }

        private void ValidateBtn_Click(object sender, RoutedEventArgs e)
        {
            // For now, we are not doing any extra validation
            // All validations are done real time, during the user input itself.
            // Just return success. Everyone is happy :)
            MessageBox.Show("Validation of user entered values successful");
        }

        private List<string> GetValuesFromArxml(AUTOSAR objAutoSAR, string modulename, string node)
        {
            var currentmodule = objAutoSAR.ARPACKAGES.Where(x => x.SHORTNAME.ToString().ToLower().Equals(modulename.ToLower())).FirstOrDefault();

            var objSupportedValues = from Pkgs in currentmodule.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS[0].SUBCONTAINERS
                                     where Pkgs.SHORTNAME.Equals(node, StringComparison.OrdinalIgnoreCase)
                                     select Pkgs.PARAMETERVALUES.SUPPORTEDVALUES.ToList();
            var lst = objSupportedValues.ToList();

            List<string> resultList = new List<string>();
            if (lst.Count > 0)
            {
                foreach (string itm in lst[0])
                {
                    resultList.Add(Convert.ToString(itm));
                }
            }
            return resultList;
        }


        private void wsTreeView_SelectedItemChanged(object sender, RoutedPropertyChangedEventArgs<object> e)
        {
            var sItem = (sender as TreeViewAdv).SelectedItem as TreeViewItemAdv;

            DockingManagerModelHelper.ModuleName = sItem.Header.ToString();

            // Save the changes in the UI elements
            var currentGrid = SpForDynamicGrid.Children.OfType<Grid>().Where(x => x.Name.ToLower() == DockingManagerModelHelper.ModuleName.ToLower()).FirstOrDefault();
            var currPackage = DockingManagerModelHelper.Configuration.ARPACKAGES.Where(x => x.SHORTNAME.ToLower() == DockingManagerModelHelper.ModuleName.ToLower()).FirstOrDefault();

            if ((currentGrid != null) && (currPackage != null))
            {
                // Get the config objects for this module
                foreach (var child in currentGrid.Children)
                {
                    // The below if condition is needed to weed out Labels. They can't be updated
                    if (!(child.GetType().FullName.Equals("System.Windows.Controls.TextBlock")))
                    {
                        string tempName = "";
                        string tempValue = "";

                        switch (child.GetType().Name.ToLower())
                        {
                            case "textbox":
                                var c1 = child as System.Windows.Controls.TextBox;
                                tempName = c1.Name.Remove(c1.Name.Length - 4);
                                tempValue = c1.Text;
                                break;
                            case "checkbox":
                                var c2 = child as System.Windows.Controls.CheckBox;
                                tempName = c2.Name.Remove(c2.Name.Length - 4);
                                tempValue = (bool)c2.IsChecked ? "ENABLE" : "DISABLE";
                                break;
                            case "combobox":
                                var c3 = child as System.Windows.Controls.ComboBox;
                                tempName = c3.Name.Remove(c3.Name.Length - 4);
                                tempValue = c3.SelectedValue.ToString();
                                break;
                        }

                        var currObj = currPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS[0].SUBCONTAINERS
                            .Where(x => ((x.PARAMETERVALUES != null) && (x.PARAMETERVALUES.DEFINITIONREF.Value == tempName))).FirstOrDefault();

                        if (currObj != null)
                            currObj.PARAMETERVALUES.VALUE.Value = tempValue;
                    }
                }
            }

            CreateDynamicWPFGridForModule();
        }

        private void GetUpdatedValuesForConfigGeneration()
        {
            Grid grd = SpForDynamicGrid.Children[0] as Grid;
            string key = string.Empty;
            for (int i = 0; i < grd.Children.Count; i++)
            {
                if (grd.Children[i].GetType() == typeof(TextBlock))
                {
                    key = (grd.Children[i] as TextBlock).Text;
                }
                if (i + 1 < grd.Children.Count && grd.Children[i + 1].GetType() == typeof(ComboBox))
                {
                    
                  try
                    {
                        string value = (grd.Children[i + 1] as ComboBox).SelectedValue.ToString();
                        UpdateObject(key, value);
                    }
                    catch(Exception e) { }
                }
                if (i + 1 < grd.Children.Count && grd.Children[i + 1].GetType() == typeof(TextBox))
                {
                    string value = (grd.Children[i + 1] as TextBox).Text.ToString();
                    UpdateObject(key, value);
                }
                if (i + 1 < grd.Children.Count && grd.Children[i + 1].GetType() == typeof(CheckBox))
                {
                    string value = (bool)(grd.Children[i + 1] as CheckBox).IsChecked ? "ENABLE" : "DISABLE";
                    UpdateObject(key, value);
                }
            }
        }

        public void UpdateObject(string key, string value)
        {
            bool isObjectFound = false;

            var currentPackage = DockingManagerModelHelper.Configuration.ARPACKAGES.Where(x => String.Equals(x.SHORTNAME.ToString().ToLower(), DockingManagerModelHelper.ModuleName.ToLower())).FirstOrDefault();

            for (int j = 0; j < currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS.Length; j++)
            {
                var currentConfigParamGrandParent = currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS[j];
                //TODO: Need to refine below code to accept only filtered object.
                for (int k = 0; k < currentConfigParamGrandParent.SUBCONTAINERS.Length; k++)
                {
                    List<string> lstSupportedValues = new List<string>();
                    string strControlType = string.Empty;
                    var currentConfigParamParent = currentConfigParamGrandParent.SUBCONTAINERS[k];
                    if (currentConfigParamParent.PARAMETERVALUES != null && currentConfigParamParent.PARAMETERVALUES.DEFINITIONREF.Value.Equals(key, StringComparison.OrdinalIgnoreCase))
                    {
                        currentConfigParamParent.PARAMETERVALUES.VALUE.Value = value;
                        break;
                    }


                    // foreach (var currentConfigParamChild in currentConfigParamParent.SUBCONTAINERS)
                    for (int i = 0; i < currentConfigParamParent.SUBCONTAINERS.Length; i++)
                    {
                        if (currentConfigParamParent.SUBCONTAINERS[i].PARAMETERVALUES.DEFINITIONREF.Value.Equals(key, StringComparison.OrdinalIgnoreCase))
                        {
                            currentConfigParamParent.SUBCONTAINERS[i].PARAMETERVALUES.VALUE.Value = value;
                            isObjectFound = true;
                            break;
                        }
                    }
                    // if obj found, break out of all loops
                    if (isObjectFound) break;
                }
                // if obj found, break out of all loops
                if (isObjectFound) break;
            }
        }

        public AUTOSARARPACKAGEELEMENTSECUCMODULECONFIGURATIONVALUESCONTAINERSECUCCONTAINERVALUEECUCCONTAINERVALUEECUCCONTAINERVALUE RetrieveConfigParamObject(string key)
        {

            bool isObjectFound = false;
            AUTOSARARPACKAGEELEMENTSECUCMODULECONFIGURATIONVALUESCONTAINERSECUCCONTAINERVALUEECUCCONTAINERVALUEECUCCONTAINERVALUE obj = null;

            var currentPackage = DockingManagerModelHelper.Configuration.ARPACKAGES.Where(x => String.Equals(x.SHORTNAME.ToString().ToLower(), DockingManagerModelHelper.ModuleName.ToLower())).FirstOrDefault();

            for (int j = 0; j < currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS.Length; j++)
            {
                var currentConfigParamGrandParent = currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS[j];

                //TODO: Need to refine below code to accept only filtered object.
                for (int k = 0; k < currentConfigParamGrandParent.SUBCONTAINERS.Length; k++)
                {
                    List<string> lstSupportedValues = new List<string>();
                    string strControlType = string.Empty;
                    var currentConfigParamParent = currentConfigParamGrandParent.SUBCONTAINERS[k];

                    // foreach (var currentConfigParamChild in currentConfigParamParent.SUBCONTAINERS)
                    for (int i = 0; i < currentConfigParamParent.SUBCONTAINERS.Length; i++)
                    {
                        if (currentConfigParamParent.SUBCONTAINERS[i].PARAMETERVALUES.DEFINITIONREF.name.Equals(key, StringComparison.OrdinalIgnoreCase))
                        {
                            obj = currentConfigParamParent.SUBCONTAINERS[i];
                            isObjectFound = true;
                            break;
                        }
                    }
                    // if obj found, break out of all loops
                    if (isObjectFound) break;
                }
                // if obj found, break out of all loops
                if (isObjectFound) break;
            }

            return obj;
        }

        public AUTOSARARPACKAGEELEMENTSECUCMODULECONFIGURATIONVALUESCONTAINERSECUCCONTAINERVALUEECUCCONTAINERVALUE RetrieveConfigParamObjectParent(string key)
        {

            bool isObjectFound = false;
            AUTOSARARPACKAGEELEMENTSECUCMODULECONFIGURATIONVALUESCONTAINERSECUCCONTAINERVALUEECUCCONTAINERVALUE obj = null;

            var currentPackage = DockingManagerModelHelper.Configuration.ARPACKAGES.Where(x => String.Equals(x.SHORTNAME.ToString().ToLower(), DockingManagerModelHelper.ModuleName.ToLower())).FirstOrDefault();

            for (int j = 0; j < currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS.Length; j++)
            {
                var currentConfigParamGrandParent = currentPackage.ELEMENTS.ECUCMODULECONFIGURATIONVALUES.CONTAINERS.SUBCONTAINERS[j];

                //TODO: Need to refine below code to accept only filtered object.
                for (int k = 0; k < currentConfigParamGrandParent.SUBCONTAINERS.Length; k++)
                {
                    List<string> lstSupportedValues = new List<string>();
                    string strControlType = string.Empty;
                    var currentConfigParamParent = currentConfigParamGrandParent.SUBCONTAINERS[k];

                    // foreach (var currentConfigParamChild in currentConfigParamParent.SUBCONTAINERS)
                    for (int i = 0; i < currentConfigParamParent.SUBCONTAINERS.Length; i++)
                    {
                        if (currentConfigParamParent.SUBCONTAINERS[i].PARAMETERVALUES.DEFINITIONREF.name.Equals(key, StringComparison.OrdinalIgnoreCase))
                        {
                            obj = currentConfigParamParent;
                            isObjectFound = true;
                            break;
                        }
                    }
                    // if obj found, break out of all loops
                    if (isObjectFound) break;
                }
                // if obj found, break out of all loops
                if (isObjectFound) break;
            }

            return obj;
        }

        private void SaveBtn_Click(object sender, RoutedEventArgs e)
        {
            GetUpdatedValuesForConfigGeneration();
            DockingManagerModelHelper.UpdateARXML();
            MessageBox.Show("ARXML Successfully saved at following path : " + DockingManagerModelHelper.TargetOutputFolderPath);
        }

        private void LoadDefaultConfigBtn_Click(object sender, RoutedEventArgs e)
        {
            DockingManagerModelHelper.Configuration = DockingManagerModelHelper.LoadARXML(true);
            PopulateWorkspaceExplorer();
            CreateDynamicWPFGridForModule();
            
        }

        private void LoadDBCBtn_Click(object sender, RoutedEventArgs e)
        {
            OpenFileDialog openFileDialog = new OpenFileDialog();

            string stringFile = string.Empty;
            string FileExt = string.Empty;


            if (openFileDialog.ShowDialog() == true)
            {
                stringFile = File.ReadAllText(openFileDialog.FileName);
                FileExt = Path.GetExtension(openFileDialog.FileName);

            }

            if (FileExt.Equals(".dbc", StringComparison.OrdinalIgnoreCase))
            {
                File.WriteAllText(DockingManagerModelHelper.TargetInputFolderPath + "\\" + Path.GetFileName(openFileDialog.FileName), stringFile);
                CreateDynamicWPFGridForModuleStaticCan(Path.GetFileName(openFileDialog.FileName));
               
                //CreateDynamicWPFGridForModule();
                DoCanIf();
                

                MessageBox.Show(openFileDialog.FileName + " Loaded Successfully.");
            }
            else
            {
                MessageBox.Show("please eneter valid .dbc file.");
            }

        }
    }
}